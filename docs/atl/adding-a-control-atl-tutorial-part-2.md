---
description: '자세히 알아보기: 컨트롤 추가 (ATL 자습서, 2 부)'
title: 컨트롤 추가(ATL 자습서, 2부)
ms.custom: get-started-article
ms.date: 08/19/2019
ms.assetid: c9575a75-1064-41f1-9697-7aada560c669
ms.openlocfilehash: 91e0f6ba4b091b6ca213495fb81727714755c635
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 12/11/2020
ms.locfileid: "97166306"
---
# <a name="adding-a-control-atl-tutorial-part-2"></a>컨트롤 추가(ATL 자습서, 2부)

이 단계에서는 프로젝트에 컨트롤을 추가 하 고 빌드한 다음 웹 페이지에서 테스트 합니다.

## <a name="procedures"></a>프로시저

### <a name="to-add-an-object-to-an-atl-project"></a>ATL 프로젝트에 개체를 추가 하려면

1. **솔루션 탐색기** 에서 프로젝트를 마우스 오른쪽 단추로 클릭 `Polygon` 합니다.

1. 바로 가기 메뉴에서 **추가** 를 가리키고 하위 메뉴에서 **새 항목** 을 클릭 합니다.

    **새 항목 추가** 대화 상자가 나타납니다. 왼쪽의 트리 구조에는 다른 개체 범주가 나열 됩니다.

1. **ATL** 폴더를 클릭 합니다.

1. 오른쪽의 템플릿 목록에서 **ATL 컨트롤** 을 선택 합니다. **추가** 를 클릭합니다. **ATL 컨트롤** 마법사가 열리고 컨트롤을 구성할 수 있습니다.

1. 를 `PolyCtl` 짧은 이름으로 입력 하 고, 다른 필드는 자동으로 완성 됨을 확인 합니다. 더 많은 변경 작업을 수행 해야 하므로 아직 **마침** 을 클릭 하지 마세요.

**ATL 컨트롤** 마법사의 **이름** 페이지에는 다음 필드가 포함 되어 있습니다.

|필드|콘텐츠|
|-----------|--------------|
|**짧은 이름**|컨트롤에 입력 한 이름입니다.|
|**클래스**|컨트롤을 구현 하기 위해 만든 c + + 클래스 이름입니다.|
|**.h 파일**|C + + 클래스의 정의를 포함 하기 위해 생성 된 파일입니다.|
|**.cpp 파일**|C + + 클래스의 구현을 포함 하기 위해 생성 된 파일입니다.|
|**CoClass**|이 컨트롤에 대 한 구성 요소 클래스의 이름입니다.|
|**인터페이스**|컨트롤에서 사용자 지정 메서드 및 속성을 구현 하는 인터페이스의 이름입니다.|
|**유형**|컨트롤에 대 한 설명입니다.|
|**ProgID**|컨트롤의 CLSID를 조회 하는 데 사용할 수 있는 읽을 수 있는 이름입니다.|

**ATL 컨트롤** 마법사에서 몇 가지 추가 설정을 변경 해야 합니다.

### <a name="to-enable-support-for-rich-error-information-and-connection-points"></a>다양 한 오류 정보 및 연결 지점의 지원을 사용 하도록 설정 하려면

1. 옵션 **을 클릭 하** 여 **옵션** 페이지를 엽니다.

1. **연결 지점의** 확인란을 선택 합니다. 이 옵션은 IDL 파일에서 나가는 인터페이스에 대 한 지원을 만듭니다.

인터페이스를 추가 하 여 컨트롤의 기능을 확장할 수도 있습니다.

### <a name="to-extend-the-controls-functionality"></a>컨트롤의 기능을 확장 하려면

1. 인터페이스 **를 클릭 하** 여 **인터페이스** 페이지를 엽니다.

1. `IProvideClassInfo2` **위쪽** 화살표를 선택 하 고 클릭 하 여 **지원 되** 는 목록으로 이동 합니다.

1. `ISpecifyPropertyPages` **위쪽** 화살표를 선택 하 고 클릭 하 여 **지원 되** 는 목록으로 이동 합니다.

컨트롤을 *삽입* 가능 하 게 만들 수도 있습니다 .이는 Excel 또는 Word와 같은 포함 된 개체를 지 원하는 응용 프로그램에 포함 될 수 있음을 의미 합니다.

### <a name="to-make-the-control-insertable"></a>컨트롤을 삽입 가능 하 게 하려면

1. 모양 **을 클릭 하** 여 **모양** 페이지를 엽니다.

1. **삽입** 가능 확인란을 선택 합니다.

개체에 의해 표시 되는 다각형에는 단색 채우기 색이 있으므로 스톡 속성을 추가 해야 `Fill Color` 합니다.

### <a name="to-add-a-fill-color-stock-property-and-create-the-control"></a>채우기 색 스톡 속성을 추가 하 고 컨트롤을 만들려면

1. **스톡 속성** 을 클릭 하 여 **스톡 속성** 페이지를 엽니다.

1. **지원 되지 않음** 에서 가능한 스톡 속성 목록을 아래로 스크롤합니다. `Fill Color` **위쪽** 화살표를 선택 하 고 클릭 하 여 **지원 되** 는 목록으로 이동 합니다.

1. **마침** 을 선택합니다.

마법사에서 컨트롤을 만들 때 몇 가지 코드를 변경 하 고 파일을 추가 합니다. 생성 되는 파일은 다음과 같습니다.

|파일|설명|
|----------|-----------------|
|Polyctl.htm|에는 대부분의 c + + 클래스 구현이 포함 되어 있습니다 `CPolyCtl` .|
|Polyctl.htm|의 나머지 부분을 포함 합니다 `CPolyCtl` .|
|Polyctl.htm|컨트롤을 등록 하는 데 사용 되는 레지스트리 스크립트를 포함 하는 텍스트 파일입니다.|
|PolyCtl.htm|새로 만든 컨트롤에 대 한 참조를 포함 하는 웹 페이지입니다.|

또한 마법사는 다음 코드를 변경 합니다.

- 컨트롤을 `#include` 지 원하는 데 필요한 ATL 파일을 포함 하기 위해 미리 컴파일된 헤더 파일에 문을 추가 합니다.

- 새 컨트롤의 세부 정보를 포함 하도록 Polygon을 변경 합니다.

- 새 컨트롤을 Polygon의 개체 맵에 추가 합니다.

이제 컨트롤을 빌드하여 작업 중인 것을 볼 수 있습니다.

## <a name="building-and-testing-the-control"></a>컨트롤 빌드 및 테스트

### <a name="to-build-and-test-the-control"></a>컨트롤을 빌드하고 테스트하려면

1. **빌드** 메뉴에서 **Polygon 빌드** 를 클릭 합니다.

    컨트롤이 빌드를 완료 하면 **솔루션 탐색기** 에서 PolyCtl.htm를 마우스 오른쪽 단추로 클릭 하 고 **브라우저에서 보기** 를 선택 합니다. 컨트롤이 포함 된 HTML 웹 페이지가 표시 됩니다. "개체 Polyctl.htm 대 한 ATL 8.0 테스트 페이지" 라는 제목의 페이지와 Polyctl.htm 컨트롤이 표시 됩니다.

> [!NOTE]
> 컨트롤이 표시 되지 않는 경우 일부 브라우저에서 ActiveX 컨트롤을 실행 하기 위한 설정 조정이 필요 함을 알 수 있습니다. ActiveX 컨트롤을 사용 하도록 설정 하는 방법에 대 한 브라우저 설명서를 참조 하세요.

> [!NOTE]
> 이 자습서를 완료 하면 DLL 파일을 만들 수 없다는 오류 메시지가 표시 되 면 PolyCtl.htm 파일 및 ActiveX 컨트롤 테스트 컨테이너를 닫고 솔루션을 다시 빌드합니다. 여전히 DLL을 만들 수 없는 경우 컴퓨터를 다시 부팅 하거나 터미널 서비스를 사용 하는 경우 로그 오프 합니다.

다음에는 컨트롤에 사용자 지정 속성을 추가 합니다.

[1 단계로 돌아가서](../atl/creating-the-project-atl-tutorial-part-1.md) [3 단계](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md) 에 &#124;

## <a name="see-also"></a>참고 항목

[자습서](../atl/active-template-library-atl-tutorial.md)
