---
title: 구조체 UNWIND_CODE | Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-tools
ms.topic: conceptual
dev_langs:
- C++
ms.assetid: 104955d8-7e33-4c5a-b0c6-3254648f0af3
author: corob-msft
ms.author: corob
ms.workload:
- cplusplus
ms.openlocfilehash: f5bccddd2ddd5c0f9dfbc828a7da3a66fa13339d
ms.sourcegitcommit: 997e6b7d336cddb388bb6e9e56527725fcaa0624
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/08/2018
ms.locfileid: "48861722"
---
# <a name="struct-unwindcode"></a>구조체 UNWIND_CODE

해제 코드 배열은 비휘발성 레지스터 및 RSP 영향을 주는 프롤로그에 작업 시퀀스를 기록 하는 데 사용 됩니다. 각 코드 항목의 형식은:

|||
|-|-|
|UBYTE|프롤로그의 오프셋된|
|UBYTE: 4|작업 코드를 해제 합니다.|
|UBYTE: 4|작업 정보|

배열은 프롤로그의 오프셋의 내림차순으로 정렬 됩니다.

## <a name="offset-in-prolog"></a>프롤로그의 오프셋된

이 작업의 경우 + 1 (즉, 다음 명령의 시작 오프셋)를 수행 하는 명령의 끝 프롤로그의 시작 부분에서 오프셋입니다.

## <a name="unwind-operation-code"></a>작업 코드를 해제 합니다.

참고: 특정 작업 코드는 로컬 스택 프레임의 값에 대 한 부호 없는 오프셋을 필요합니다. 이 오프셋부터 (가장 낮은 주소)의 고정 된 스택 할당입니다. UNWIND_INFO 프레임 등록 필드 0 인 경우이 오프셋에서 RSP입니다. 프레임 등록 필드가 0이 아닌 경우 이것이 RSP 있었던 FP 레지스터 설정 되었을 때의 오프셋입니다. 이 값은 FP 레지스터 FP reg 오프셋을 뺀 값 (16 \* 확장 된 프레임을 UNWIND_INFO 오프셋 등록). FP 레지스터를 사용 하는 경우 다음 모든 해제 코드 오프셋만 사용 되어야 합니다 FP 레지스터는 프롤로그에 설정 된 후.

제외한 모든 opcode에 대 한 `UWOP_SAVE_XMM128` 고 `UWOP_SAVE_XMM128_FAR`관심 값 8 바이트 경계 (자체 스택은 항상 16 바이트 정렬)에 저장 된 모든 스택 때문에, 오프셋은 항상 8의 배수 여야 합니다. 짧은 오프셋 (512k 미만)을 사용 하는 코드를 작업에 대 한이 코드에 대 한 노드의 마지막 USHORT 8로 나눈 값 오프셋을 포함 합니다. 시간 오프셋을 사용 하는 작업 코드에 대 한 (512k < = < 4GB 오프셋),이 코드의 마지막 두 USHORT 노드 (형태로 little endian) 오프셋을 저장 합니다.

Opcode에 대 한 `UWOP_SAVE_XMM128` 고 `UWOP_SAVE_XMM128_FAR`, 오프셋은 항상 16의 배수 이므로 16 바이트 정렬 된 메모리에서 모든 128 비트 XMM 작업을 수행 해야 합니다. 따라서 16 배율 인수는 `UWOP_SAVE_XMM128`, 보다 작거나 1m의 오프셋을 허용 합니다.

해제 작업 코드를 다음 중 하나입니다.

`UWOP_PUSH_NONVOL` (0) 노드 1 개

정수 비휘발성 레지스터를 8로 감소 RSP 푸시하십시오. 작업 정보에는 레지스터의 수입니다. 에필로그에 대 한 제약 조건을 발생 하므로 `UWOP_PUSH_NONVOL` 해제 코드를 프롤로그에서 첫 번째로 표시 되어야 하며 마지막 해제 코드 배열은에 있습니다. 제외한 기타 모든 해제 코드에 적용이 상대적 순서 `UWOP_PUSH_MACHFRAME`합니다.

`UWOP_ALLOC_LARGE` (1) 2 또는 3 노드

스택에 큰 영역을 할당 합니다. 다음과 같은 두 가지 있습니다. 작업 정보가 0 이면로 나눈 값 할당의 크기 8 K-8 512 최대 할당 다음 슬롯에 기록 됩니다. 작업 정보가 1 이면 할당의 실제 크기 크기 할당을 허용 하 고 little endian 형식으로 다음 두 슬롯에 기록 됩니다 최대 4GB-8입니다.

`UWOP_ALLOC_SMALL` (2) 노드 1 개

스택에 크기가 작은 영역을 할당 합니다. 할당의 크기는 작업 정보 필드 \* 8 + 8, 128 바이트를 8에서 할당을 허용 합니다.

스택 할당에 대 한 해제 코드는 항상 가능한 가장 짧은 인코딩을 사용 해야 합니다.

|**할당 크기**|**해제 코드**|
|-|-|
|8 ~ 128 바이트|`UWOP_ALLOC_SMALL`|
|136에서 512k-8 바이트|`UWOP_ALLOC_LARGE`에서 작업 정보 = 0|
|512k ~ 4 G-8 바이트|`UWOP_ALLOC_LARGE`에서 작업 정보 = 1|

`UWOP_SET_FPREG` (노드 1 개 3)

현재 RSP의 일부 오프셋으로 레지스터를 설정 하 여 프레임 포인터 레지스터를 설정 합니다. 오프셋은 같은 프레임 등록 오프셋된 (확장된) 필드에는 UNWIND_INFO \* 16, 오프셋 0에서 240 허용 합니다. 오프셋을 사용 하는 짧은 명령 폼 사용 하 여 더 많은 액세스를 허용 하 여 코드 밀도 지원 하면 고정된 스택 할당의 중간으로 가리키는 프레임 포인터를 설정할 수 있습니다. Note 작업 정보 필드 예약어 이므로 사용할 수 없습니다.

`UWOP_SAVE_NONVOL` (노드 4) 2 개

MOV 푸시를 대신 사용 하 여 스택에 정수 비휘발성 레지스터를 저장 합니다. 이 주로 래핑에 대 한 이전에 할당 된 위치에 있는 스택에 비휘발성 레지스터를 저장 합니다. 작업 정보에는 레지스터의 수입니다. 크기를 조정 하 여 8 스택에서 오프셋은 다음에 기록 됩니다. 위 참고 사항에 설명 된 대로 작업 코드 슬롯을 해제 합니다.

`UWOP_SAVE_NONVOL_FAR` (5) 3 노드

시간 오프셋을 사용 하 여 스택에 정수 비휘발성 레지스터 저장을 MOV 푸시를 대신 사용합니다. 이 주로 래핑에 대 한 이전에 할당 된 위치에 있는 스택에 비휘발성 레지스터를 저장 합니다. 작업 정보에는 레지스터의 수입니다. 소수 자릿수가 없는 스택 오프셋은 다음에 기록 됩니다. 위 참고 사항에 설명 된 대로 작업 코드 슬롯 두 해제 합니다.

`UWOP_SAVE_XMM128` (노드 8) 2 개

스택에 XMM 등록 비휘발성의 모든 128 비트를 저장 합니다. 작업 정보에는 레지스터의 수입니다. 스택 크기를 조정 하 여 16 오프셋 다음 슬롯에 기록 됩니다.

`UWOP_SAVE_XMM128_FAR` (9) 3 노드

시간 오프셋을 사용 하 여 스택에 XMM 등록 비휘발성의 모든 128 비트를 저장 합니다. 작업 정보에는 레지스터의 수입니다. 소수 자릿수가 없는 스택 오프셋은 다음 두 슬롯에 기록 됩니다.

`UWOP_PUSH_MACHFRAME` (노드 1 개 10)

시스템 프레임을 푸시하십시오.  이 효과 하드웨어 인터럽트 또는 예외를 기록에 사용 됩니다. 다음과 같은 두 가지 있습니다. 작업 정보를 0 이면 다음 푸시되 지 않은 스택:

|||
|-|-|
|RSP + 32|SS|
|RSP + 24|이전 RSP|
|RSP + 16|EFLAGS|
|RSP + 8|CS|
|RSP|RIP|

경우 작업 정보를 1 대신 다음 푸시 되었습니다.

|||
|-|-|
|RSP + 40|SS|
|RSP + 32|이전 RSP|
|RSP + 24|EFLAGS|
|RSP + 16|CS|
|RSP + 8|RIP|
|RSP|오류 코드|

이 해제 코드는 다르지만 대신는 인터럽트 루틴의 실제 진입점 보다 먼저 나타납니다 및 컴퓨터 프레임의 푸시 시뮬레이션 하는 위치를 제공 하기 위해서만 존재 더미 프롤로그에 항상 표시 됩니다. `UWOP_PUSH_MACHFRAME` 컴퓨터에 개념적으로 다음을 수행 여부를 나타내는 해당 시뮬레이션을 기록 합니다.

1. 에 스택 맨 위에서 반환 주소 RIP 팝 *Temp*

1. SS 푸시

1. 이전 RSP 푸시

1. EFLAGS 푸시

1. CS 푸시

1. 푸시 *Temp*

1. (Op 정보에는 1과 같음) 하는 경우 오류 코드를 푸시

Simulated `UWOP_PUSH_MACHFRAME` 40 여 작업 감소 RSP (op 정보가 0) 또는 48 (op 정보가 1).

## <a name="operation-info"></a>작업 정보

이러한 4 비트의 의미는 작업 코드에 따라 달라 집니다. 범용 (정수) 레지스터를 인코딩하려면 다음 매핑이 사용 됩니다.

|||
|-|-|
|0|RAX|
|1|RCX|
|2|RDX|
|3|RBX|
|4|RSP|
|5|RBP|
|6|RSI|
|7|RDI|
|8 ~ 15|R 15 R8|

## <a name="see-also"></a>참고 항목

[디버거 지원, 예외 처리를 위한 해제 데이터](../build/unwind-data-for-exception-handling-debugger-support.md)
