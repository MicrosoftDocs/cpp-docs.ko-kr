---
description: '자세히 알아보기: CFileDialog 클래스'
title: CFileDialog 클래스
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: 229a24188c57bf05529b52f476426c7fdf3c38ae
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 12/11/2020
ms.locfileid: "97184532"
---
# <a name="cfiledialog-class"></a>CFileDialog 클래스

파일 열기 또는 파일 저장 작업에 사용 되는 일반 대화 상자를 캡슐화 합니다.

## <a name="syntax"></a>구문

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>멤버

### <a name="public-constructors"></a>Public 생성자

|이름|설명|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|`CFileDialog` 개체를 생성합니다.|

### <a name="public-methods"></a>Public 메서드

|이름|설명|
|----------|-----------------|
|[CFileDialog:: AddCheckButton](#addcheckbutton)|대화 상자에 확인 단추를 추가 합니다.|
|[CFileDialog:: AddComboBox](#addcombobox)|대화 상자에 콤보 상자를 추가 합니다.|
|[CFileDialog:: AddControlItem](#addcontrolitem)|대화 상자의 컨테이너 컨트롤에 항목을 추가 합니다.|
|[CFileDialog:: AddEditBox](#addeditbox)|대화 상자를 대화 상자에 추가 합니다.|
|[CFileDialog:: AddMenu](#addmenu)|대화 상자에 메뉴를 추가 합니다.|
|[CFileDialog:: AddPlace](#addplace)|오버로드됨. 사용자가 항목을 열거나 저장 하는 데 사용할 수 있는 위치 목록에 폴더를 추가 합니다.|
|[CFileDialog:: AddPushButton](#addpushbutton)|대화 상자에 단추를 추가 합니다.|
|[CFileDialog:: AddRadioButtonList](#addradiobuttonlist)|대화 상자에 옵션 단추 (라디오 단추 라고도 함) 그룹을 추가 합니다.|
|[CFileDialog:: AddSeparator](#addseparator)|대화 상자에 구분 기호를 추가 합니다.|
|[CFileDialog:: AddText](#addtext)|대화 상자에 텍스트 콘텐츠를 추가 합니다.|
|[CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog)|`CFileDialog`멤버 변수에 저장 된 매개 변수와 플래그에 맞게의 상태를 업데이트 합니다 `m_ofn` .|
|[CFileDialog::D oModal](#domodal)|대화 상자를 표시 하 고 사용자가 선택할 수 있도록 설정 합니다.|
|[CFileDialog:: EnableOpenDropDown](#enableopendropdown)|대화 상자의 **열기** 또는 **저장** 단추에 드롭다운 목록을 사용 하도록 설정 합니다.|
|[CFileDialog:: EndVisualGroup](#endvisualgroup)|대화 상자에서 시각적 그룹에 요소를 추가 하는 것을 중지 합니다.|
|[CFileDialog:: GetCheckButtonState](#getcheckbuttonstate)|대화 상자에서 확인 단추 (확인란)의 현재 상태를 가져옵니다.|
|[CFileDialog:: GetControlItemState](#getcontrolitemstate)|대화 상자에서 찾은 컨테이너 컨트롤에 있는 항목의 현재 상태를 가져옵니다.|
|[CFileDialog:: GetControlState](#getcontrolstate)|지정 된 컨트롤의 현재 표시 유형 및 활성화 상태를 가져옵니다.|
|[CFileDialog:: GetEditBoxText](#geteditboxtext)|편집 상자 컨트롤의 현재 텍스트를 가져옵니다.|
|[CFileDialog:: GetFileExt](#getfileext)|선택한 파일의 확장명을 반환 합니다.|
|[CFileDialog:: GetFileName](#getfilename)|선택한 파일의 파일 이름을 반환 합니다.|
|[CFileDialog:: GetFileTitle](#getfiletitle)|선택한 파일의 제목을 반환 합니다.|
|[CFileDialog:: GetFolderPath](#getfolderpath)|탐색기 스타일 **열기** 또는 다른 **이름으로 저장** 대화 상자에 대해 현재 열려 있는 폴더 또는 디렉터리의 경로를 검색 합니다.|
|[CFileDialog:: GetIFileDialogCustomize](#getifiledialogcustomize)|사용자 지정 된 개체에 대 한 내부 COM 개체를 검색 `CFileDialog` 합니다.|
|[CFileDialog:: GetIFileOpenDialog](#getifileopendialog)|`CFileDialog`파일 **열기** 대화 상자로 사용 되는에 대 한 내부 COM 개체를 검색 합니다.|
|[CFileDialog:: GetIFileSaveDialog](#getifilesavedialog)|`CFileDialog`파일 **저장** 대화 상자로 사용 되는에 대 한 내부 COM 개체를 검색 합니다.|
|[CFileDialog:: GetNextPathName](#getnextpathname)|다음 선택 된 파일의 전체 경로를 반환 합니다.|
|[CFileDialog:: GetOFN](#getofn)|`OPENFILENAME`개체의 구조를 검색 `CFileDialog` 합니다.|
|[CFileDialog:: GetPathName](#getpathname)|선택한 파일의 전체 경로를 반환 합니다.|
|[CFileDialog:: GetReadOnlyPref](#getreadonlypref)|선택한 파일의 읽기 전용 상태를 반환 합니다.|
|[CFileDialog:: GetResult](#getresult)|사용자가 대화 상자에서 선택한 항목을 가져옵니다.|
|[CFileDialog:: GetResults](#getresults)|여러 항목을 선택할 수 있는 대화 상자에서 사용자가 선택한 항목을 가져옵니다.|
|[CFileDialog:: GetSelectedControlItem](#getselectedcontrolitem)|대화 상자의 지정 된 컨테이너 컨트롤에서 특정 항목을 가져옵니다.|
|[CFileDialog:: GetStartPosition](#getstartposition)|파일 이름 목록에서 첫 번째 요소의 위치를 반환 합니다.|
|[CFileDialog:: HideControl](#hidecontrol)|탐색기 스타일 **열기** 또는 일반 **파일로 저장** 대화 상자에서 지정 된 컨트롤을 숨깁니다.|
|[CFileDialog:: IsPickFoldersMode](#ispickfoldersmode)|폴더 선택 모드에서 현재 대화 상자를 확인 합니다.|
|[CFileDialog:: MakeProminent](#makeprominent)|추가 된 다른 컨트롤과 비교 하 여 컨트롤을 대화 상자에 배치 합니다.|
|[CFileDialog:: RemoveControlItem](#removecontrolitem)|대화 상자의 컨테이너 컨트롤에서 항목을 제거 합니다.|
|[CFileDialog:: SetCheckButtonState](#setcheckbuttonstate)|대화 상자에서 확인 단추 (확인란)의 현재 상태를 설정 합니다.|
|[CFileDialog:: SetControlItemState](#setcontrolitemstate)|대화 상자에 있는 컨테이너 컨트롤의 항목에 대 한 현재 상태를 설정 합니다.|
|[CFileDialog:: SetControlItemText](#setcontrolitemtext)|컨트롤 항목의 텍스트를 설정 합니다. 예를 들어 라디오 단추 또는 메뉴의 항목을 함께 제공 하는 텍스트가 있습니다.|
|[CFileDialog:: SetControlLabel](#setcontrollabel)|컨트롤에 연결 된 텍스트 (예: 단추 텍스트 또는 편집 상자 레이블)를 설정 합니다.|
|[CFileDialog:: SetControlState](#setcontrolstate)|지정 된 컨트롤의 현재 표시 유형 및 활성화 상태를 설정 합니다.|
|[CFileDialog:: SetControlText](#setcontroltext)|탐색기 스타일 **열기** 또는 일반 **파일로 저장** 대화 상자에서 지정 된 컨트롤에 대 한 텍스트를 설정 합니다.|
|[CFileDialog:: SetDefExt](#setdefext)|탐색기 스타일 **열기** 또는 일반 **파일로 저장** 대화 상자에 대 한 기본 파일 이름 확장명을 설정 합니다.|
|[CFileDialog:: SetEditBoxText](#seteditboxtext)|편집 상자 컨트롤의 현재 텍스트를 설정 합니다.|
|[CFileDialog:: SetProperties](#setproperties)|저장 중인 항목에 사용할 기본값을 정의하는 속성 저장소를 제공합니다.|
|[CFileDialog:: SetSelectedControlItem](#setselectedcontrolitem)|옵션 단추 그룹 또는 대화 상자에 있는 콤보 상자에서 특정 항목의 선택 된 상태를 설정 합니다.|
|[CFileDialog:: SetTemplate](#settemplate)|개체에 대 한 대화 상자 템플릿을 설정 합니다 `CFileDialog` .|
|[CFileDialog:: StartVisualGroup](#startvisualgroup)|대화 상자에서 시각적 그룹을 선언 합니다. 모든 "add" 메서드에 대 한 후속 호출에서는 이러한 요소를이 그룹에 추가 합니다.|
|[CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog)|멤버 변수에 저장 된 데이터를 `m_ofn` 파일 대화 상자의 현재 상태와 일치 하도록 업데이트 합니다.|

### <a name="protected-methods"></a>Protected 메서드

|Name|설명|
|----------|-----------------|
|[CFileDialog:: OnButtonClicked](#onbuttonclicked)|단추를 클릭 하면 호출 됩니다.|
|[CFileDialog:: OnCheckButtonToggled](#oncheckbuttontoggled)|확인란을 선택/선택 취소 하면 호출 됩니다.|
|[CFileDialog:: OnControlActivating](#oncontrolactivating)|컨트롤이 활성화 될 때 호출 됩니다.|
|[CFileDialog:: OnFileNameChange](#onfilenamechange)|WM_NOTIFY CDN_SELCHANGE 메시지를 처리 합니다.|
|[CFileDialog:: OnFileNameOK](#onfilenameok)|대화 상자에 입력 한 파일 이름의 유효성을 검사 합니다.|
|[CFileDialog:: OnFolderChange](#onfolderchange)|WM_NOTIFY CDN_FOLDERCHANGE 메시지를 처리 합니다.|
|[CFileDialog:: OnInitDone](#oninitdone)|WM_NOTIFY CDN_INITDONE 메시지를 처리 합니다.|
|[CFileDialog:: OnItemSelected](#onitemselected)|컨테이너 항목이 선택 될 때 호출 됩니다.|
|[CFileDialog:: OnLBSelChangedNotify](#onlbselchangednotify)|파일 선택이 변경 될 때 사용자 지정 작업을 수행할 수 있습니다.|
|[CFileDialog:: OnShareViolation](#onshareviolation)|공유 위반을 처리 합니다.|
|[CFileDialog:: OnTypeChange](#ontypechange)|WM_NOTIFY CDN_TYPECHANGE 메시지를 처리 합니다.|

### <a name="public-data-members"></a>공용 데이터 멤버

|Name|설명|
|----------|-----------------|
|[CFileDialog:: m_ofn](#m_ofn)|Windows `OPENFILENAME` 구조체입니다. 기본 파일 대화 상자 매개 변수에 대 한 액세스를 제공 합니다.|

## <a name="remarks"></a>설명

공용 파일 대화 상자를 사용 하 여 파일 선택 대화 상자를 구현할 수 있습니다. 예를 들어 **파일 열기** 및 다른 **이름으로 저장** 을 Windows 표준과 일치 하는 방식으로 구현할 수 있습니다.

제공 된 생성자를 사용 하 여 `CFileDialog` 를 그대로 사용 하거나에서 고유한 대화 상자 클래스를 파생 시키고 `CFileDialog` 필요에 맞게 생성자를 작성할 수 있습니다. 두 경우 모두 이러한 대화 상자는 [CCommonDialog 클래스](../../mfc/reference/ccommondialog-class.md)에서 파생 되므로 표준 MFC 대화 상자 처럼 동작 합니다. `CFileDialog` 는 Windows에 포함 된 COMMDLG.DLL 파일을 기반으로 합니다.

`CFileDialog`Windows Vista 이상 버전에서의 모양과 기능은 이전 버전의 windows와 다릅니다. `CFileDialog`프로그램이 컴파일되고 Windows vista 이상에서 실행 되는 경우 기본적으로 코드를 변경 하지 않고 새 Windows vista 또는 이후 스타일을 자동으로 사용 합니다. 생성자에서 *bVistaStyle* 매개 변수를 사용 하 여 수동으로이 자동 업데이트를 재정의 합니다. 자동 업데이트에 대 한 예외는 사용자 지정 대화 상자입니다. 새 스타일로 변환 되지 않습니다. 생성자에 대 한 자세한 내용은 [CFileDialog:: CFileDialog](#cfiledialog)를 참조 하세요.

> [!NOTE]
> 컨트롤 ID 시스템은 이전 버전의 Windows에서를 사용 하는 경우 Windows Vista 이상에서 다릅니다 `CFileDialog` . `CFileDialog`이전 버전의 Windows에서 프로젝트를 이식 하려면 먼저 코드의 컨트롤에 대 한 모든 참조를 업데이트 해야 합니다.

일부 `CFileDialog` 메서드는 Windows Vista 이상에서 지원 되지 않습니다. 메서드가 지원 되는지 여부에 대 한 자세한 내용은 개별 메서드 항목을 참조 하십시오. 또한 다음과 같은 상속 된 함수는 Windows Vista 이상에서 지원 되지 않습니다.

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog:: OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

클래스에 대 한 windows 메시지는 `CFileDialog` 사용 중인 운영 체제에 따라 달라 집니다. 예를 들어 Windows XP에서는 클래스의 [cdialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel) 및 [Cdialog:: OnOK](../../mfc/reference/cdialog-class.md#onok) 를 지원 하지 않습니다 `CFileDialog` . 그러나 Windows Vista 이상 운영 체제에서는 이러한 기능을 지원 하지 않습니다. 생성 되는 여러 메시지와 이러한 메시지가 수신 되는 순서에 대 한 자세한 내용은 [CFileDialog 샘플: 로깅 이벤트 순서](../../overview/visual-cpp-samples.md)를 참조 하세요.

개체를 사용 하려면 `CFileDialog` 먼저 생성자를 사용 하 여 개체를 `CFileDialog` 만듭니다. 대화 상자를 생성 한 후에는 [CFileDialog:: m_ofn](#m_ofn) 구조체의 값을 설정 하거나 수정 하 여 대화 상자 컨트롤의 값 또는 상태를 초기화할 수 있습니다. `m_ofn`구조체는 형식입니다 `OPENFILENAME` . 자세한 내용은 Windows SDK [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) 구조체를 참조 하세요.

대화 상자 컨트롤을 초기화 한 후 [CFileDialog::D oModal](#domodal) 메서드를 호출 하 여 사용자가 경로와 파일 이름을 입력할 수 있도록 대화 상자를 표시 합니다. `DoModal` 사용자가 확인 (IDOK) 또는 취소 (IDCANCEL) 단추를 클릭 했는지 여부를 반환 합니다. `DoModal`에서 IDOK를 반환 하는 경우 `CFileDialog` public 멤버 함수 중 하나를 사용 하 여 사용자가 입력 한 정보를 검색할 수 있습니다.

> [!NOTE]
> Windows Vista 이상에서는 [Ifiledialog:: SetFileTypes](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) 를 여러 번 호출 하면 오류가 발생 합니다. `SetFileTypes`의 모든 인스턴스에 대 한 두 번째 호출은 `CFileDialog` Windows Vista 이상에서 E_UNEXPECTED을 반환 합니다. 일부 `CFileDialog` 메서드 함수는 `SetFileTypes` 를 호출 합니다. 예를 들어 `CFileDialog::DoModal` 의 동일한 인스턴스에 대 한 두 번의 호출은 `CFileDialog` [ASSERT](diagnostic-services.md#assert)를 생성 합니다.

`CFileDialog` 에는 공유 위반, 파일 이름 유효성 검사 및 목록 상자 변경 알림에 대 한 사용자 지정 처리를 수행할 수 있는 몇 가지 보호 된 멤버가 포함 되어 있습니다. 이러한 보호 된 멤버는 기본 처리가 자동으로 수행 되기 때문에 대부분의 응용 프로그램에서 사용 하지 않아도 되는 콜백 함수입니다. 이러한 함수에 대 한 메시지 맵 항목은 표준 가상 함수 이기 때문에 필요 하지 않습니다.

Windows [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) 함수를 사용 하 여 대화 상자를 초기화 하는 동안 오류가 발생 했는지 확인 하 고 오류에 대해 자세히 알아볼 수 있습니다.

개체의 소멸은 `CFileDialog` 자동으로 처리 됩니다. [CDialog:: EndDialog](../../mfc/reference/cdialog-class.md#enddialog)를 호출할 필요가 없습니다.

사용자가 여러 파일을 선택할 수 있게 하려면를 호출 하기 전에 OFN_ALLOWMULTISELECT 플래그를 설정 `DoModal` 합니다. 반환 된 여러 파일 이름 목록을 수용 하려면 고유한 파일 이름 버퍼를 제공 해야 합니다. 를 `m_ofn.lpstrFile` 구성한 후를 호출 하기 전에 할당 한 버퍼에 대 한 포인터로 대체 하 여이 작업을 수행 `CFileDialog` `DoModal` 합니다.

또한 `m_ofn.nMaxFile` 에서 가리키는 버퍼의 문자 수를 사용 하 여를 설정 해야 합니다 `m_ofn.lpstrFile` . 선택할 수 있는 최대 파일 수를로 설정 하는 경우 `n` 필요한 버퍼 크기는 `n * (_MAX_PATH + 1) + 1` 입니다. 버퍼에서 반환 되는 첫 번째 항목은 파일이 선택 된 폴더의 경로입니다. Windows Vista 또는 이후 스타일 대화 상자의 경우 디렉터리 및 파일 이름 문자열은 null로 종결 되며, 마지막 파일 이름 뒤에는 null 문자가 추가 됩니다. 이 형식을 사용 하면 탐색기 스타일 대화 상자에서 공백을 포함 하는 긴 파일 이름을 반환할 수 있습니다. 이전 스타일 대화 상자의 경우 디렉터리 및 파일 이름 문자열은 공백으로 구분 되 고 함수는 공백이 있는 파일 이름에 짧은 파일 이름을 사용 합니다.

다음 예제에서는 버퍼를 사용 하 여 여러 파일 이름을 검색 하 고 나열 하는 방법을 보여 줍니다.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

여러 파일 이름을 선택 하는 사용자에 대 한 응답으로 버퍼 크기를 변경 하려면에서 새 클래스를 파생 하 `CFileDialog` 고 [CFileDialog:: OnFileNameChange](#onfilenamechange) 메서드를 재정의 해야 합니다.

에서 새 클래스를 파생 하는 경우 `CFileDialog` 메시지 맵을 사용 하 여 메시지를 처리할 수 있습니다. 기본 메시지 처리를 확장 하려면에서 클래스를 파생 시키고 `CFileDialog` , 메시지 맵을 새 클래스에 추가 하 고, 새 메시지에 대 한 멤버 함수를 제공 합니다. 대화 상자를 사용자 지정 하기 위해 후크 함수를 제공할 필요는 없습니다.

대화 상자를 사용자 지정 하려면에서 클래스를 파생 시키고 `CFileDialog` , 사용자 지정 대화 상자 템플릿을 제공 하 고, 확장 된 컨트롤에서 알림 메시지를 처리 하는 메시지 맵을 추가 합니다. 처리 되지 않은 메시지를 기본 클래스에 전달 합니다. 후크 함수를 사용자 지정할 필요가 없습니다.

의 Windows Vista 이상 스타일을 사용 하는 경우 `CFileDialog` 메시지 맵과 대화 상자 템플릿을 사용할 수 없습니다. 대신, 유사한 기능을 위해 COM 인터페이스를 사용 해야 합니다.

를 사용 하는 방법에 대 한 자세한 내용은 `CFileDialog` [일반 대화 상자 클래스](../../mfc/common-dialog-classes.md)를 참조 하세요.

## <a name="inheritance-hierarchy"></a>상속 계층 구조

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>요구 사항

**헤더:** afxdlgs

## <a name="cfiledialogaddcheckbutton"></a><a name="addcheckbutton"></a> CFileDialog:: AddCheckButton

대화 상자에 확인 단추를 추가 합니다.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
추가할 확인 단추의 ID입니다.

*strLabel*<br/>
확인 단추 이름입니다.

*bChecked*<br/>
확인 단추의 현재 상태를 나타내는 부울입니다. 선택 된 경우 TRUE입니다. 그렇지 않으면 FALSE입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogaddcombobox"></a><a name="addcombobox"></a> CFileDialog:: AddComboBox

대화 상자에 콤보 상자를 추가 합니다.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
추가할 콤보 상자의 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogaddcontrolitem"></a><a name="addcontrolitem"></a> CFileDialog:: AddControlItem

대화 상자의 컨테이너 컨트롤에 항목을 추가 합니다.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
항목을 추가할 컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목 ID입니다.

*strLabel*<br/>
항목의 텍스트입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogaddeditbox"></a><a name="addeditbox"></a> CFileDialog:: AddEditBox

대화 상자를 대화 상자에 추가 합니다.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
추가할 편집 상자의 ID입니다.

*strText*<br/>
편집 상자 이름입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogaddmenu"></a><a name="addmenu"></a> CFileDialog:: AddMenu

대화 상자에 메뉴를 추가 합니다.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
추가할 메뉴의 ID입니다.

*strLabel*<br/>
메뉴 이름입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogaddplace"></a><a name="addplace"></a> CFileDialog:: AddPlace

사용자가 항목을 열거나 저장 하는 데 사용할 수 있는 위치 목록에 폴더를 추가 합니다.

```cpp
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>매개 변수

*lpszFolder*<br/>
사용자가 사용할 수 있도록 설정할 폴더의 경로입니다. 이 폴더는 폴더 일 수만 있습니다.

*fdap*<br/>
목록 내에서 폴더를 배치할 위치를 지정 합니다.

*psi*<br/>
사용자가 사용할 수 있도록 만들 폴더를 나타내는 IShellItem에 대 한 포인터입니다. 이 폴더는 폴더 일 수만 있습니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogaddpushbutton"></a><a name="addpushbutton"></a> CFileDialog:: AddPushButton

대화 상자에 단추를 추가 합니다.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
추가할 단추의 ID입니다.

*strLabel*<br/>
단추 이름입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogaddradiobuttonlist"></a><a name="addradiobuttonlist"></a> CFileDialog:: AddRadioButtonList

대화 상자에 옵션 단추 (라디오 단추 라고도 함) 그룹을 추가 합니다.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
추가할 옵션 단추 그룹의 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogaddseparator"></a><a name="addseparator"></a> CFileDialog:: AddSeparator

대화 상자에 구분 기호를 추가 합니다.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
구분 기호 추가의 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogaddtext"></a><a name="addtext"></a> CFileDialog:: AddText

대화 상자에 텍스트를 추가 합니다.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
추가할 텍스트의 ID입니다.

*strText*<br/>
텍스트 이름입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogapplyofntoshelldialog"></a><a name="applyofntoshelldialog"></a> CFileDialog:: ApplyOFNToShellDialog

데이터 구조체에 저장 된 값을 기준으로 [CFileDialog](../../mfc/reference/cfiledialog-class.md) 의 현재 상태를 업데이트 합니다 `m_ofn` .

```cpp
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>설명

Windows Vista 이전 버전에서는 멤버 [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) 데이터 구조가의 상태와 지속적으로 동기화 되었습니다 `CFileDialog` . [M_ofn](#m_ofn) 멤버 변수에 대 한 모든 변경 내용은 대화 상자의 상태에 즉시 반영 됩니다. 또한 대화 상자의 상태를 변경 하면 `m_ofn` 멤버 변수가 즉시 업데이트 됩니다.

Windows Vista 이상에서는 `m_ofn` 멤버 변수의 값과의 상태가 동기화 되지 않을 수 있습니다 `CFileDialog` . 이 함수는의 상태를 `CFileDialog` 구조와 일치 하도록 강제로 업데이트 합니다 `m_ofn` . Windows에서는 [CFileDialog를:D](#domodal)하는 동안이 함수를 자동으로 호출 합니다.

Windows Vista 이상에서 클래스를 사용 하는 방법에 대 한 자세한 내용은 `CFileDialog` [CFileDialog 클래스](../../mfc/reference/cfiledialog-class.md)를 참조 하세요.

### <a name="example"></a>예제

  [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog)의 예제를 참조 하세요.

## <a name="cfiledialogcfiledialog"></a><a name="cfiledialog"></a> CFileDialog:: CFileDialog

표준 Windows 파일 대화 상자를 생성 하려면이 함수를 호출 합니다.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>매개 변수

*bOpenFileDialog*<br/>
진행 만들 대화 상자의 유형을 지정 하는 매개 변수입니다. **파일 열기** 대화 상자를 생성 하려면 TRUE로 설정 합니다. FALSE로 설정 하 여 파일 다른 **이름으로 저장** 대화 상자를 생성 합니다.

*lpszDefExt*<br/>
진행 기본 파일 이름 확장명입니다. 사용자가 파일 이름 상자에 알려진 확장 (사용자의 컴퓨터에 연결 되어 있는)을 포함 하지 않으면 *lpszDefExt* 에 지정 된 확장명이 자동으로 파일 이름에 추가 됩니다. 이 매개 변수가 NULL 이면 확장이 추가 되지 않습니다.

*lpszFileName*<br/>
진행 파일 이름 상자에 표시 되는 초기 파일 이름입니다. NULL 인 경우 초기 파일 이름이 표시 되지 않습니다.

*dwFlags*<br/>
진행 대화 상자를 사용자 지정 하는 데 사용할 수 있는 하나 이상의 플래그 조합입니다. 이러한 플래그에 대 한 설명은 Windows SDK의 [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) 구조를 참조 하세요. 구조체 멤버를 수정 하는 경우 `m_ofn.Flags` 변경 내용에 비트 or 연산자를 사용 하 여 기본 동작을 그대로 유지 합니다.

*lpszFilter*<br/>
진행 파일에 적용할 수 있는 필터를 지정 하는 일련의 문자열 쌍입니다. 파일 필터를 지정 하면 필터 조건과 일치 하는 파일만 파일 목록에 표시 됩니다. 파일 필터로 작업 하는 방법에 대 한 자세한 내용은 설명 부분을 참조 하세요.

*pParentWnd*<br/>
진행 파일 대화 상자의 부모 또는 소유자 창에 대 한 포인터입니다.

*dwSize*<br/>
진행 구조체의 크기 `OPENFILENAME` 입니다. 이 값은 운영 체제 버전에 따라 다릅니다. MFC는이 매개 변수를 사용 하 여 만들 적절 한 종류의 대화 상자를 결정 합니다. 기본 크기 0은 MFC 코드에서 프로그램이 실행 되는 운영 체제 버전에 따라 사용할 올바른 대화 상자 크기를 결정 함을 의미 합니다.

*bVistaStyle*<br/>
진행 **참고** 이 매개 변수는 Visual Studio 2008 이상에서 사용할 수 있으며, Windows Vista 이상 버전에서 실행 중인 경우에만 새 스타일 대화 상자를 사용할 수 있습니다.

파일 대화 상자의 스타일을 지정 하는 매개 변수입니다. 새 Vista 스타일 파일 대화 상자를 사용 하려면 TRUE로 설정 합니다. 그렇지 않으면 대화 상자의 이전 스타일이 사용 됩니다. Vista에서 실행 하는 방법에 대 한 자세한 내용은 설명 섹션을 참조 하세요.

### <a name="remarks"></a>설명

*BOpenFileDialog* 의 값에 따라 **파일 열기** 또는 **파일 다른 이름으로 저장** 대화 상자가 생성 됩니다.

*LpszDefExt* 를 사용 하 여 기본 확장을 지정 하면 사용자 컴퓨터에 파일을 연결 하는 확장명은 거의 예측할 수 없기 때문에 예상 되는 동작이 생성 되지 않을 수 있습니다. 기본 확장을 추가 하는 것 보다 더 많은 제어가 필요한 경우에서 고유한 클래스를 파생 시키고 `CFileDialog` 메서드를 재정의 하 여 `CFileDialog::OnFileNameOK` 사용자 고유의 확장 처리를 수행할 수 있습니다.

사용자가 여러 파일을 선택할 수 있게 하려면 [DoModal](#domodal)을 호출 하기 전에 OFN_ALLOWMULTISELECT 플래그를 설정 합니다. 반환 된 여러 파일 이름 목록을 저장 하려면 고유한 파일 이름 버퍼를 제공 해야 합니다. `m_ofn.lpstrFile` [CFileDialog](../../mfc/reference/cfiledialog-class.md)을 구성한 후를 호출 하기 전에 할당 한 버퍼에 대 한 포인터로 대체 하 여이 작업을 수행 `DoModal` 합니다. 또한 `m_ofn.nMaxFile` 가 가리키는 버퍼의 문자 수로를 설정 해야 합니다 `m_ofn.lpstrFile` . 선택할 수 있는 최대 파일 수를 *n* 으로 설정 하면 필요한 버퍼 크기는 `n` * (_MAX_PATH + 1) + 1입니다. 예를 들어:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

사용자가 마우스나 키보드를 사용 하 여 탐색기 스타일 대화 상자의 크기를 조정할 수 있게 하려면 OFN_ENABLESIZING 플래그를 설정 합니다. 후크 프로시저나 사용자 지정 템플릿을 제공 하는 경우에만이 플래그를 설정 해야 합니다. 플래그는 탐색기 스타일 대화 상자 에서만 작동 합니다. 이전 스타일의 대화 상자는 크기를 조정할 수 없습니다.

*LpszFilter* 매개 변수는 파일 목록에 표시 되어야 하는 파일 이름 유형을 결정 하는 데 사용 됩니다. 문자열 쌍의 첫 번째 문자열은 필터를 설명 합니다. 두 번째 문자열은 사용할 파일 이름 확장명을 나타냅니다. 세미콜론 ('; ' 문자)을 구분 기호로 사용 하 여 여러 확장을 지정할 수 있습니다. 문자열이 두 개의 ' &#124; ' 문자로 끝나고 그 뒤에 NULL 문자가 옵니다. 이 매개 변수에 대해 [CString](../../atl-mfc-shared/using-cstring.md) 개체를 사용할 수도 있습니다.

예를 들어 Microsoft Excel에서는 사용자가 확장명이 xlc (차트) 또는 .xls (워크시트) 인 파일을 열 수 있습니다. Excel 용 필터는 다음과 같이 작성할 수 있습니다.

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

그러나이 문자열을 사용 하 여 구조를 직접 업데이트 하려는 경우에는 `OPENFILENAME` 세로 막대 (' &#124; ') 대신 null 문자 ' \ 0 '을 사용 하 여 문자열을 구분 해야 합니다.

*BVistaStyle* 매개 변수는 Windows Vista 이상에서 실행 되는 경우에만 적용할 수 있습니다. 이전 버전의 Windows에서는이 매개 변수가 무시 됩니다. *BVistaStyle* 가 TRUE로 설정 된 경우 Visual Studio 2008 이상으로 프로그램을 컴파일하면 새 Vista 스타일 **파일 대화 상자가** 사용 됩니다. 그렇지 않으면 이전 MFC 스타일 **파일 대화 상자가** 사용 됩니다.

대화 상자 템플릿은 *bVistaStyle* 기반 대화 상자에서 지원 되지 않습니다.

### <a name="example"></a>예제

  [CFileDialog::D oModal](#domodal)의 예제를 참조 하세요.

## <a name="cfiledialogdomodal"></a><a name="domodal"></a> CFileDialog::D oModal

이 함수를 호출 하 여 Windows 공용 파일 대화 상자를 표시 하 고 사용자가 파일 및 디렉터리를 찾아보고 파일 이름을 입력할 수 있습니다.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>반환 값

IDOK 또는 IDCANCEL. IDCANCEL이 반환 되는 경우 Windows [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) 함수를 호출 하 여 오류가 발생 했는지 여부를 확인 합니다.

IDOK 및 IDCANCEL는 사용자가 확인 또는 취소 단추를 선택 했는지 여부를 나타내는 상수입니다.

### <a name="remarks"></a>설명

구조체의 멤버를 설정 하 여 다양 한 파일 대화 상자 옵션을 초기화 하려면 `m_ofn` 를 호출 하기 전에이 작업을 수행 해야 합니다 `DoModal` . 단, 대화 상자 개체가 생성 된 후에는이 작업을 수행 해야 합니다.

예를 들어 사용자가 여러 파일을 선택할 수 있게 하려면 `DoModal` 이 항목의 코드 예제에 나와 있는 것 처럼를 호출 하기 전에 OFN_ALLOWMULTISELECT 플래그를 설정 합니다.

사용자가 대화 상자의 [확인] 또는 [취소] 단추를 클릭 하거나 대화 상자의 컨트롤 메뉴에서 닫기 옵션을 선택 하면 컨트롤이 응용 프로그램으로 반환 됩니다. 그런 다음 다른 멤버 함수를 호출 하 여 사용자가 대화 상자에 입력 한 설정이 나 정보를 검색할 수 있습니다.

`DoModal` 는 클래스에서 재정의 된 가상 함수입니다 `CDialog` .

### <a name="example"></a>예제

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

## <a name="cfiledialogenableopendropdown"></a><a name="enableopendropdown"></a> CFileDialog:: EnableOpenDropDown

대화 상자의 열기 또는 저장 단추에 드롭다운 목록을 사용 하도록 설정 합니다.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
드롭다운 목록의 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogendvisualgroup"></a><a name="endvisualgroup"></a> CFileDialog:: EndVisualGroup

대화 상자에서 시각적 그룹에 요소를 추가 하는 것을 중지 합니다.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>반환 값

성공 하면 S_OK 반환 합니다. 그렇지 않으면 오류 값입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialoggetcheckbuttonstate"></a><a name="getcheckbuttonstate"></a> CFileDialog:: GetCheckButtonState

대화 상자에서 확인 단추 (확인란)의 현재 상태를 검색 합니다.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
확인란의 ID입니다.

*bChecked*<br/>
확인란의 상태입니다. TRUE는 checked를 나타냅니다. FALSE는 선택 되지 않았음을 나타냅니다.

### <a name="remarks"></a>설명

## <a name="cfiledialoggetcontrolitemstate"></a><a name="getcontrolitemstate"></a> CFileDialog:: GetControlItemState

대화 상자에서 찾은 컨테이너 컨트롤의 항목에 대 한 현재 상태를 검색 합니다.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목 ID입니다.

*dwState*<br/>
컨트롤의 현재 상태를 나타내는 CDCONTROLSTATE 열거형의 값 중 하나를 받는 변수에 대 한 참조입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialoggetcontrolstate"></a><a name="getcontrolstate"></a> CFileDialog:: GetControlState

지정 된 컨트롤의 현재 표시 유형 및 활성화 상태를 검색 합니다.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨트롤의 ID입니다.

*dwState*<br/>
컨트롤의 현재 상태를 나타내는 CDCONTROLSTATE 열거형에서 하나 이상의 값을 받는 변수에 대 한 참조입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialoggeteditboxtext"></a><a name="geteditboxtext"></a> CFileDialog:: GetEditBoxText

편집 상자 컨트롤에서 현재 텍스트를 검색 합니다.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
편집 상자의 ID입니다.

*strText*<br/>
텍스트 값입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialoggetfileext"></a><a name="getfileext"></a> CFileDialog:: GetFileExt

대화 상자에 입력 한 파일 이름 확장명을 검색 하려면이 함수를 호출 합니다.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>반환 값

파일 이름의 확장명입니다.

### <a name="remarks"></a>설명

예를 들어 입력 한 파일의 이름이 DATA.TXT 이면는 `GetFileExt` "TXT"를 반환 합니다.

`m_ofn.Flags`에 OFN_ALLOWMULTISELECT 플래그가 설정 되어 있는 경우이 문자열에는 null로 끝나는 문자열의 시퀀스가 포함 됩니다. 여기서 첫 번째 문자열은 선택한 파일 그룹의 디렉터리 경로이 고 다음에는 사용자가 선택한 모든 파일의 이름이 옵니다. 파일 경로 경로를 검색 하려면 [Getstartposition](#getstartposition) 및 [GetNextPathName](#getnextpathname) 멤버 함수를 사용 합니다.

## <a name="cfiledialoggetfilename"></a><a name="getfilename"></a> CFileDialog:: GetFileName

이 함수를 호출 하 여 대화 상자에 입력 한 파일 이름 이름을 검색 합니다.

```
CString GetFileName() const;
```

### <a name="return-value"></a>반환 값

파일 이름입니다.

### <a name="remarks"></a>설명

파일 이름에는 접두사와 확장이 모두 포함 됩니다. 예를 들어 `GetFileName` 는 "TEXT"를 반환 합니다. DAT "파일 C:\FILES\TEXT.DAT.

`m_ofn.Flags`에 `OFN_ALLOWMULTISELECT` 플래그가 설정 되어 있으면 [Getstartposition](#getstartposition) 및 [GetNextPathName](#getnextpathname) 를 호출 하 여 파일 경로 이름을 검색 해야 합니다.

## <a name="cfiledialoggetfiletitle"></a><a name="getfiletitle"></a> CFileDialog:: GetFileTitle

이 함수를 호출 하 여 대화 상자에 입력 한 파일의 제목을 검색 합니다.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>반환 값

파일의 제목입니다.

### <a name="remarks"></a>설명

파일의 제목에는 경로 또는 확장명이 없는 접두사만 포함 됩니다. 예를 들어는 `GetFileTitle` C:\FILES\TEXT.DAT. 파일의 "TEXT"를 반환 합니다.

`m_ofn.Flags`에 OFN_ALLOWMULTISELECT 플래그가 설정 되어 있는 경우이 문자열에는 null로 끝나는 문자열의 시퀀스가 포함 됩니다. 여기서 첫 번째 문자열은 선택한 파일 그룹의 디렉터리 경로이 고 다음에는 사용자가 선택한 모든 파일의 이름이 옵니다. 이러한 이유로 [Getstartposition](#getstartposition) 및 [GetNextPathName](#getnextpathname) 멤버 함수를 사용 하 여 목록에서 다음 파일 이름을 검색 합니다.

### <a name="example"></a>예제

  [CFileDialog::D oModal](#domodal)의 예제를 참조 하세요.

## <a name="cfiledialoggetfolderpath"></a><a name="getfolderpath"></a> CFileDialog:: GetFolderPath

이 멤버 함수를 호출 하 여 탐색기 스타일 열기 또는 일반 저장 대화 상자에 대해 현재 열려 있는 폴더 또는 디렉터리의 경로를 검색 합니다.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>반환 값

현재 열려 있는 폴더 또는 디렉터리를 포함 하는 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 개체입니다.

### <a name="remarks"></a>설명

이 대화 상자는 OFN_EXPLORER 스타일로 만들어야 합니다. 그렇지 않으면 어설션이 포함 된 메서드가 실패 합니다.

대화 상자가 표시 되는 동안에만이 메서드를 호출할 수 있습니다. 대화 상자를 닫은 후에는이 함수가 더 이상 작동 하지 않으며,이 메서드는 어설션이 실패 합니다.

## <a name="cfiledialoggetifiledialogcustomize"></a><a name="getifiledialogcustomize"></a> CFileDialog:: GetIFileDialogCustomize

지정 된 [CFileDialog](../../mfc/reference/cfiledialog-class.md)에 대 한 내부 COM 개체에 대 한 포인터를 검색 합니다.

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>반환 값

에 대 한 내부 COM 개체에 대 한 포인터 `CFileDialog` 입니다. 이 포인터를 적절 하 게 해제 하는 것은 사용자의 책임입니다.

### <a name="remarks"></a>설명

*BVistaStyle* 가 TRUE로 설정 된 개체를 사용 하 여 Windows Vista 이상 에서만이 함수를 사용 합니다. *BVistaStyle* 가 FALSE 인 경우이 함수를 사용 하면 릴리스 모드에서 NULL이 반환 되 고 디버그 모드에서 어설션이 throw 됩니다.

인터페이스에 대 한 자세한 내용은 `IFileDialogCustomize` [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)를 참조 하세요.

### <a name="example"></a>예제

이 예제에서는 내부 COM 개체를 검색 합니다. 이 코드 예제를 실행 하려면 Windows Vista 이상에서 컴파일해야 합니다.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

## <a name="cfiledialoggetifileopendialog"></a><a name="getifileopendialog"></a> CFileDialog:: GetIFileOpenDialog

지정 된에 대 한 내부 COM 개체에 대 한 포인터를 검색 `CFileDialog` 합니다.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>반환 값

에 대 한 내부 COM 개체에 대 한 포인터 `CFileDialog` 입니다. 이 포인터를 적절 하 게 해제 하는 것은 사용자의 책임입니다.

### <a name="remarks"></a>설명

*BVistaStyle* 가 TRUE로 설정 된 개체를 사용 하 여 Windows Vista 이상 에서만이 함수를 사용 합니다. 이 함수는 `CFileDialog` 가 **열기** 대화 상자가 아니거나 *bVistaStyle* 이 FALSE로 설정 된 경우 NULL을 반환 합니다. 이 마지막 사례에서 함수는 릴리스 모드의 경우에만 NULL을 반환 합니다. 디버그 모드에서는 어설션이 throw 됩니다.

인터페이스에 대 한 자세한 내용은 `IFileOpenDialog` [IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)를 참조 하세요.

### <a name="example"></a>예제

이 예제에서는 내부 COM 개체를 검색 합니다. 이 코드를 실행 하려면 Windows Vista 이상에서 컴파일해야 합니다.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

## <a name="cfiledialoggetifilesavedialog"></a><a name="getifilesavedialog"></a> CFileDialog:: GetIFileSaveDialog

지정 된에 대 한 내부 COM 개체에 대 한 포인터를 검색 `CFileDialog` 합니다.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>반환 값

에 대 한 내부 COM 개체에 대 한 포인터 `CFileDialog` 입니다. 이 포인터를 적절 하 게 해제 하는 것은 사용자의 책임입니다.

### <a name="remarks"></a>설명

*BVistaStyle* 가 TRUE로 설정 된 개체를 사용 하 여 Windows Vista 이상 에서만이 함수를 사용 합니다. `CFileDialog` **저장** 대화 상자가 아니거나 *bVistaStyle* 이 FALSE로 설정 된 경우이 함수는 NULL을 반환 합니다. 이 마지막 사례에서 함수는 릴리스 모드의 경우에만 NULL을 반환 합니다. 디버그 모드에서는 어설션이 throw 됩니다.

인터페이스에 대 한 자세한 내용은 `IFileSaveDialog` [IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog)를 참조 하세요.

### <a name="example"></a>예제

이 예제에서는 내부 COM 개체를 검색 합니다. 이 코드 예제를 실행 하려면 Windows Vista 이상에서 컴파일해야 합니다.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

## <a name="cfiledialoggetnextpathname"></a><a name="getnextpathname"></a> CFileDialog:: GetNextPathName

대화 상자에서 선택한 그룹에서 다음 파일 이름을 검색 하려면이 함수를 호출 합니다.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>매개 변수

*pos*<br/>
이전 또는 함수 호출에서 반환 된 위치 값에 대 한 참조 `GetNextPathName` `GetStartPosition` 입니다. 목록의 끝에 도달한 경우 NULL입니다.

### <a name="return-value"></a>반환 값

파일의 전체 경로입니다.

### <a name="remarks"></a>설명

파일 이름 경로에는 파일의 제목과 전체 디렉터리 경로가 포함 됩니다. 예를 들어 `GetNextPathName` 은 "C:\FILES\TEXT."를 반환 합니다. DAT "파일 C:\FILES\TEXT.DAT. `GetNextPathName`를 호출 하 여 초기 위치를 설정 하는 경우 전방 반복 루프에서을 사용할 수 있습니다 `GetStartPosition` .

선택 항목이 하나의 파일로만 구성 된 경우 해당 파일 이름이 반환 됩니다.

## <a name="cfiledialoggetofn"></a><a name="getofn"></a> CFileDialog:: GetOFN

연결 된 구조체를 검색 `OPENFILENAME` 합니다.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>반환 값

[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) 구조체입니다.

### <a name="remarks"></a>설명

이 함수의 두 번째 버전을 사용 하 여 **파일 열기** 또는 파일 다른 이름 **으로 저장** 대화 상자가 생성 된 후 멤버 함수를 사용 하 여 표시 되기 전에 해당 모양을 초기화할 수 `DoModal` 있습니다. 예를 들어 `lpstrTitle` 의 멤버를 `m_ofn` 대화 상자에 표시할 캡션으로 설정할 수 있습니다.

## <a name="cfiledialoggetpathname"></a><a name="getpathname"></a> CFileDialog:: GetPathName

대화 상자에 입력 한 파일의 전체 경로를 검색 하려면이 함수를 호출 합니다.

```
CString GetPathName() const;
```

### <a name="return-value"></a>반환 값

파일의 전체 경로입니다.

### <a name="remarks"></a>설명

파일 이름 경로에는 파일의 제목과 전체 디렉터리 경로가 포함 됩니다. 예를 들어 `GetPathName` 은 "C:\FILES\TEXT."를 반환 합니다. DAT "파일 C:\FILES\TEXT.DAT.

`m_ofn.Flags`에 OFN_ALLOWMULTISELECT 플래그가 설정 되어 있는 경우이 문자열에는 첫 번째 문자열이 선택한 파일 그룹의 디렉터리 경로이 고 그 뒤에 사용자가 선택한 모든 파일의 이름이 있는 null teminated 문자열의 시퀀스가 포함 됩니다. 이러한 이유로 [Getstartposition](#getstartposition) 및 [GetNextPathName](#getnextpathname) 멤버 함수를 사용 하 여 목록에서 다음 파일 이름을 검색 합니다.

### <a name="example"></a>예제

  [CFileDialog::D oModal](#domodal)의 예제를 참조 하세요.

## <a name="cfiledialoggetreadonlypref"></a><a name="getreadonlypref"></a> CFileDialog:: GetReadOnlyPref

Windows 표준 파일 열기 및 파일 다른 이름으로 저장 대화 상자에서 읽기 전용 확인란이 선택 되었는지 여부를 확인 하려면이 함수를 호출 합니다.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>반환 값

대화 상자의 읽기 전용 확인란이 선택 되어 있으면 0이 아닙니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

생성자에서 OFN_HIDEREADONLY 스타일을 설정 하 여 읽기 전용 확인란을 숨길 수 있습니다 `CFileDialog` .

> [!NOTE]
> Windows Vista 또는 이후 스타일 `CFileDialog` 개체는이 기능을 지원 하지 않습니다. Windows Vista 이상 스타일에서이 함수를 사용 하려고 `CFileDialog` 하면 [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)이 throw 됩니다.

## <a name="cfiledialoggetresult"></a><a name="getresult"></a> CFileDialog:: GetResult

사용자가 대화 상자에서 만든 선택을 검색 합니다.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>반환 값

사용자가 선택한 항목을 나타내는 IShellItem에 대 한 포인터입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialoggetresults"></a><a name="getresults"></a> CFileDialog:: GetResults

여러 항목을 선택할 수 있는 대화 상자에서 사용자의 선택 항목을 검색 합니다.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>반환 값

대화 상자에서 선택한 항목에 액세스할 수 있는 IShellItemArray에 대 한 포인터입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialoggetselectedcontrolitem"></a><a name="getselectedcontrolitem"></a> CFileDialog:: GetSelectedControlItem

대화 상자의 지정 된 컨테이너 컨트롤에서 특정 항목을 검색 합니다.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
사용자가 컨트롤에서 선택한 항목의 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialoggetstartposition"></a><a name="getstartposition"></a> CFileDialog:: GetStartPosition

에 OFN_ALLOWMULTISELECT 플래그가 설정 되어 있으면 목록에서 첫 번째 파일 경로 이름의 위치를 검색 하려면이 멤버 함수를 호출 `m_ofn.Flags` 합니다.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>반환 값

반복에 사용할 수 있는 위치 값입니다. 목록이 비어 있으면 NULL입니다.

## <a name="cfiledialoghidecontrol"></a><a name="hidecontrol"></a> CFileDialog:: HideControl

이 멤버 함수를 호출 하 여 탐색기 스타일 열기 또는 일반 파일로 저장 대화 상자에서 지정 된 컨트롤을 숨깁니다.

```cpp
void HideControl(int nID);
```

### <a name="parameters"></a>매개 변수

*nID*<br/>
숨길 컨트롤의 ID입니다.

### <a name="remarks"></a>설명

이 대화 상자는 OFN_EXPLORER 스타일로 만들어야 합니다. 그렇지 않으면 함수는 어설션이 실패 합니다.

## <a name="cfiledialogispickfoldersmode"></a><a name="ispickfoldersmode"></a> CFileDialog:: IsPickFoldersMode

현재 대화 상자가 폴더 선택 모드에 있는지 여부를 확인 합니다.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>반환 값

대화 상자가 폴더 선택 모드에 있으면 TRUE이 고, 그렇지 않으면 FALSE입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogm_ofn"></a><a name="m_ofn"></a> CFileDialog:: m_ofn

`m_ofn` 는 형식의 구조입니다 `OPENFILENAME` . 이 구조체의 데이터는의 현재 상태를 나타냅니다 `CFileDialog` .

### <a name="remarks"></a>설명

이 구조를 사용 하 여 파일을 만든 후 [DoModal](#domodal) 메서드로 표시 하기 전에 **파일 열기** 또는 파일 다른 이름 **으로 저장** 대화 상자의 모양을 초기화할 수 있습니다. 예를 들어 대화 상자에서 사용할 캡션으로의 *Lpstrtitle* 멤버를 설정할 수 있습니다 `m_ofn` .

Windows Vista 또는 그 이후 버전의 [CFileDialog](../../mfc/reference/cfiledialog-class.md)에서는 `m_ofn` 가 항상 대화 상자의 상태와 일치 하는 것을 보장 하지는 않습니다. 이전 버전의 Windows에서는 대화 상자와 동기화 됩니다. Windows Vista 이상에서 구조와 상태를 동기화 하는 방법에 대 한 자세한 내용은 [CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog) 및 [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog) 를 참조 하세요 `m_ofn` `CFileDialog` .

Windows Vista 또는 이후 스타일 파일 대화 상자는의 특정 멤버와 플래그를 지원 하지 않습니다 `CFileDialog` . 따라서 이러한 결과는 영향을 주지 않습니다.

다음은 Windows Vista 이상에서 지원 되지 않는 구성원 목록입니다.

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

다음 플래그는 지원 되지 않으므로 Windows Vista 이상 스타일을 사용 하는 경우에는 영향을 주지 않습니다 `CFileDialog` .

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- Windows Vista 이상에서 OFN_LONGNAMES 효율적으로 항상 켜기

- Windows Vista 이상에서 항상 OFN_NOLONGNAMES-효과적으로 꺼짐

- Windows Vista 이상에서 OFN_NONETWORKBUTTON 효율적으로 항상 켜기

- OFN_READONLY

- OFN_SHOWHELP

이 구조에 대 한 자세한 내용은 Windows SDK의 [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) 구조를 참조 하세요.

## <a name="cfiledialogmakeprominent"></a><a name="makeprominent"></a> CFileDialog:: MakeProminent

다른 컨트롤과 비교 하 여 컨트롤을 대화 상자에 배치 합니다.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨트롤의 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogonbuttonclicked"></a><a name="onbuttonclicked"></a> CFileDialog:: OnButtonClicked

단추를 클릭 하면 호출 됩니다.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
단추의 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogoncheckbuttontoggled"></a><a name="oncheckbuttontoggled"></a> CFileDialog:: OnCheckButtonToggled

확인란을 선택 하거나 선택 취소 하면 호출 됩니다.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
확인란의 ID입니다.

*bChecked*<br/>
확인란을 선택 취소 합니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogoncontrolactivating"></a><a name="oncontrolactivating"></a> CFileDialog:: OnControlActivating

컨트롤이 활성화 될 때 호출 됩니다.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨트롤의 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogonfilenamechange"></a><a name="onfilenamechange"></a> CFileDialog:: OnFileNameChange

WM_NOTIFY CDN_SELCHANGE 메시지를 처리 하려면이 메서드를 재정의 합니다.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>설명

사용자가 **열기** 또는 다른 **이름으로 저장** 대화 상자의 파일 목록에서 새 파일이 나 폴더를 선택 하면 시스템에서 CDN_SELCHANGE 메시지를 보냅니다. 이 메시지에 대 한 응답으로 작업을 수행 하려면이 메서드를 재정의 합니다.

OFN_EXPLORER 플래그를 설정 하 여 대화 상자를 만든 경우에만 시스템에서이 메시지를 보냅니다. 알림에 대 한 자세한 내용은 [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange)를 참조 하세요. OFN_EXPLORER 플래그에 대 한 자세한 내용은 [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) 구조 및 [열기 및 다른 이름으로 저장 대화 상자](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)를 참조 하세요.

## <a name="cfiledialogonfilenameok"></a><a name="onfilenameok"></a> CFileDialog:: OnFileNameOK

공용 파일 대화 상자에 입력 한 파일 이름에 대 한 사용자 지정 유효성 검사를 제공 하려는 경우에만이 함수를 재정의 합니다.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>반환 값

파일 이름이 잘못 된 경우 1이 고, 그렇지 않으면입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

이 함수를 사용 하면 응용 프로그램별 이유로 파일 이름을 거부할 수 있습니다. 일반적으로 프레임 워크는 파일 이름에 대 한 기본 유효성 검사를 제공 하 고 잘못 된 파일 이름을 입력 한 경우 메시지 상자를 표시 하기 때문에이 함수를 사용할 필요가 없습니다.

1이 반환 되 면 사용자가 다른 파일 이름을 입력할 수 있는 대화 상자가 계속 표시 됩니다. 대화 상자 프로시저는 반환이 0 인 경우 대화 상자를 해제 합니다. 0이 아닌 다른 반환 값은 현재 예약 되어 있으므로 사용 하면 안 됩니다.

## <a name="cfiledialogonfolderchange"></a><a name="onfolderchange"></a> CFileDialog:: OnFolderChange

WM_NOTIFYCDN_FOLDERCHANGE 메시지를 처리 하려면이 함수를 재정의 합니다.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>설명

알림 메시지는 열기 또는 다른 이름으로 저장 대화 상자에서 새 폴더를 열 때 전송 됩니다.

OFN_EXPLORER 스타일을 사용 하 여 대화 상자를 만든 경우에만 알림이 전송 됩니다. 알림에 대 한 자세한 내용은 [CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange)를 참조 하세요. OFN_EXPLORER 스타일에 대 한 자세한 내용은 [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) 구조 및 [열기 및 다른 이름으로 저장 대화 상자](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)를 참조 하세요.

## <a name="cfiledialogoninitdone"></a><a name="oninitdone"></a> CFileDialog:: OnInitDone

WM_NOTIFY CDN_INITDONE 메시지를 처리 하려면이 함수를 재정의 합니다.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>설명

시스템은 시스템에서 **열기** 또는 다른 **이름으로 저장** 대화 상자에서 컨트롤을 정렬 하 여 자식 대화 상자의 컨트롤을 위한 공간을 만들 때이 알림 메시지를 보냅니다.

OFN_EXPLORER 스타일을 사용 하 여 대화 상자를 만든 경우에만 시스템에서이를 보냅니다. 알림에 대 한 자세한 내용은 [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone)를 참조 하세요. OFN_EXPLORER 스타일에 대 한 자세한 내용은 [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) 구조 및 [열기 및 다른 이름으로 저장 대화 상자](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)를 참조 하세요.

> [!NOTE]
> Windows Vista 이상 스타일 파일 대화 상자는이 기능을 지원 하지 않습니다. Windows Vista 또는 이후 스타일 파일 대화 상자에서이 함수를 사용 하려고 하면 [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)이 throw 됩니다.

## <a name="cfiledialogonitemselected"></a><a name="onitemselected"></a> CFileDialog:: OnItemSelected

컨테이너 항목이 선택 될 때 호출 됩니다.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogonlbselchangednotify"></a><a name="onlbselchangednotify"></a> CFileDialog:: OnLBSelChangedNotify

이 함수는 목록 상자의 현재 선택 영역이 변경 되려고 할 때마다 호출 됩니다.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>매개 변수

*nIDBox*<br/>
선택이 발생 한 목록 상자 또는 콤보 상자의 ID입니다.

*iCurSel*<br/>
현재 선택 항목의 인덱스입니다.

*nCode*<br/>
컨트롤 알림 코드입니다. 이 매개 변수는 다음 값 중 하나 여야 합니다.

- CD_LBSELCHANGE는 단일 선택 목록 상자에서 선택한 항목으로 *Icursel* 을 지정 합니다.

- CD_LBSELSUB 다중 선택 목록 상자에서 *Icursel* 이 더 이상 선택 되지 않도록 지정 합니다.

- CD_LBSELADD 다중 선택 목록 상자에서 *Icursel* 이 선택 되도록 지정 합니다.

- CD_LBSELNOITEMS 다중 선택 목록 상자에 선택 항목이 없도록 지정 합니다.

### <a name="remarks"></a>설명

목록 상자에서 선택 변경 내용에 대 한 사용자 지정 처리를 제공 하려면이 함수를 재정의 합니다. 예를 들어이 함수를 사용 하 여 사용자가 선택 하는 각 파일에 대 한 액세스 권한이 나 마지막으로 수정 된 날짜를 표시할 수 있습니다.

## <a name="cfiledialogonshareviolation"></a><a name="onshareviolation"></a> CFileDialog:: OnShareViolation

공유 위반의 사용자 지정 처리를 제공 하려면이 함수를 재정의 합니다.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>매개 변수

*lpszPathName*<br/>
공유 위반이 발생 한 파일의 경로입니다.

### <a name="return-value"></a>반환 값

다음 값 중 하나입니다.

- 파일 이름이 대화 상자에서 반환 OFN_SHAREFALLTHROUGH.

- OFN_SHARENOWARN 추가 작업을 수행할 필요가 없습니다.

- 사용자 OFN_SHAREWARN이 오류에 대 한 표준 경고 메시지를 받습니다.

### <a name="remarks"></a>설명

일반적으로 프레임 워크는 공유 위반의 기본 확인을 제공 하 고 공유 위반이 발생 하는 경우 메시지 상자를 표시 하므로이 함수를 사용할 필요가 없습니다.

공유 위반 검사를 사용 하지 않도록 설정 하려는 경우 비트 or 연산자를 사용 하 여 플래그 OFN_SHAREAWARE와 결합 `m_ofn.Flags` 합니다.

## <a name="cfiledialogontypechange"></a><a name="ontypechange"></a> CFileDialog:: OnTypeChange

WM_NOTIFYCDN_TYPECHANGE 메시지를 처리 하려면이 함수를 재정의 합니다.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>설명

사용자가 열기 또는 다른 이름으로 저장 대화 상자의 파일 형식 목록에서 새 파일 형식을 선택 하면 알림 메시지가 전송 됩니다.

OFN_EXPLORER 스타일을 사용 하 여 대화 상자를 만든 경우에만 알림이 전송 됩니다. 알림에 대 한 자세한 내용은 [CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange)를 참조 하세요. OFN_EXPLORER 스타일에 대 한 자세한 내용은 [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) 구조 및 [열기 및 다른 이름으로 저장 대화 상자](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)를 참조 하세요.

## <a name="cfiledialogremovecontrolitem"></a><a name="removecontrolitem"></a> CFileDialog:: RemoveControlItem

대화 상자의 컨테이너 컨트롤에서 항목을 제거 합니다.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
항목을 제거할 컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogsetcheckbuttonstate"></a><a name="setcheckbuttonstate"></a> CFileDialog:: SetCheckButtonState

대화 상자에서 확인 단추 (확인란)의 현재 상태를 설정 합니다.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
확인란의 ID입니다.

*bChecked*<br/>
확인란의 상태입니다. TRUE는 checked를 나타냅니다. FALSE는 선택 되지 않았음을 나타냅니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogsetcontrolitemstate"></a><a name="setcontrolitemstate"></a> CFileDialog:: SetControlItemState

대화 상자에 있는 컨테이너 컨트롤의 항목에 대 한 현재 상태를 설정 합니다.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목 ID입니다.

*dwState*<br/>
컨트롤의 새 상태를 나타내는 CDCONTROLSTATE 열거형의 하나 이상의 값입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogsetcontrolitemtext"></a><a name="setcontrolitemtext"></a> CFileDialog:: SetControlItemText

컨트롤 항목의 텍스트를 설정 합니다. 예를 들어 라디오 단추 또는 메뉴의 항목을 함께 제공 하는 텍스트가 있습니다.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목 ID입니다.

*strLabel*<br/>
항목의 텍스트입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogsetcontrollabel"></a><a name="setcontrollabel"></a> CFileDialog:: SetControlLabel

컨트롤에 연결 된 텍스트 (예: 단추 텍스트 또는 편집 상자 레이블)를 설정 합니다.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨트롤의 ID입니다.

*strLabel*<br/>
컨트롤 이름입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogsetcontrolstate"></a><a name="setcontrolstate"></a> CFileDialog:: SetControlState

지정 된 컨트롤의 현재 표시 유형 및 활성화 상태를 설정 합니다.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨트롤의 ID입니다.

*dwState*<br/>
컨트롤의 현재 상태를 나타내는 CDCONTROLSTATE 열거형의 하나 이상의 값입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogsetcontroltext"></a><a name="setcontroltext"></a> CFileDialog:: SetControlText

탐색기 스타일 **열기** 또는 다른 **이름으로 저장** 대화 상자에서 지정 된 컨트롤에 대 한 텍스트를 설정 하려면이 메서드를 호출 합니다.

```cpp
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>매개 변수

*nID*<br/>
진행 텍스트를 설정할 컨트롤의 ID입니다.

*lpsz*<br/>
진행 컨트롤에 대해 설정할 텍스트를 포함 하는 문자열에 대 한 포인터입니다.

### <a name="remarks"></a>설명

이 함수의 두 버전은 유니코드를 사용 하는 응용 프로그램에 유효 합니다. 그러나 ANSI를 사용 하는 응용 프로그램에는 LPCSTR 형식의 버전만 사용할 수 있습니다.

이 메서드를 사용 하려면 OFN_EXPLORER 스타일을 사용 하 여 대화 상자를 만들어야 합니다. 그렇지 않으면 함수는 어설션이 실패 합니다.

## <a name="cfiledialogsetdefext"></a><a name="setdefext"></a> CFileDialog:: SetDefExt

이 함수를 호출 하 여 탐색기 스타일 열기 또는 일반 파일로 저장 대화 상자에 대 한 기본 파일 이름 확장명을 설정 합니다.

```cpp
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>매개 변수

*lpsz*<br/>
대화 상자 개체에 사용할 기본 확장명을 포함 하는 문자열에 대 한 포인터입니다. 이 문자열은 마침표 (.)를 포함할 수 없습니다.

### <a name="remarks"></a>설명

이 대화 상자는 OFN_EXPLORER 스타일로 만들어야 합니다. 그렇지 않으면 함수는 어설션이 실패 합니다.

## <a name="cfiledialogseteditboxtext"></a><a name="seteditboxtext"></a> CFileDialog:: SetEditBoxText

편집 상자 컨트롤의 현재 텍스트를 설정 합니다.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
편집 상자의 ID입니다.

*strText*<br/>
텍스트 값입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogsetproperties"></a><a name="setproperties"></a> CFileDialog:: SetProperties

저장 중인 항목에 사용할 기본값을 정의하는 속성 저장소를 제공합니다.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>매개 변수

*lpszPropList*<br/>
";"으로 구분되는 미리 정의된 속성의 목록입니다. 플래그 목록은 [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)의 **flags** 섹션을 참조 하십시오.

### <a name="remarks"></a>설명

## <a name="cfiledialogsetselectedcontrolitem"></a><a name="setselectedcontrolitem"></a> CFileDialog:: SetSelectedControlItem

옵션 단추 그룹 또는 대화 상자에 있는 콤보 상자에서 특정 항목의 선택 된 상태를 설정 합니다.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
사용자가 컨트롤에서 선택한 항목의 ID입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogsettemplate"></a><a name="settemplate"></a> CFileDialog:: SetTemplate

[CFileDialog](../../mfc/reference/cfiledialog-class.md) 개체에 대 한 대화 상자 템플릿을 설정 합니다.

```cpp
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>매개 변수

*nWin3ID*<br/>
진행 비 탐색기 개체에 대 한 템플릿 리소스의 ID 번호를 포함 `CFileDialog` 합니다. 이 템플릿은 Windows NT 3.51 또는 OFN_EXPLORER 스타일이 없는 경우에만 사용 됩니다.

*nWin4ID*<br/>
진행 탐색기 개체에 대 한 템플릿 리소스의 ID 번호를 포함 `CFileDialog` 합니다. 이 템플릿은 Windows NT 4.0 이상 버전, Windows 95 이상 버전 또는 OFN_EXPLORER 스타일이 있는 경우에만 사용 됩니다.

*lpWin3ID*<br/>
진행 비 탐색기 개체에 대 한 템플릿 리소스의 이름을 포함 `CFileDialog` 합니다. 이 템플릿은 Windows NT 3.51 또는 OFN_EXPLORER 스타일이 없는 경우에만 사용 됩니다.

*lpWin4ID*<br/>
진행 탐색기 개체의 템플릿 리소스 이름을 포함 `CFileDialog` 합니다. 이 템플릿은 Windows NT 4.0 이상 버전, Windows 95 이상 버전 또는 OFN_EXPLORER 스타일이 있는 경우에만 사용 됩니다.

### <a name="remarks"></a>설명

시스템은 지정 된 템플릿 중 하나만 사용 합니다. 시스템은 응용 프로그램이 실행 되 고 있는 운영 체제 및 OFN_EXPLORER 스타일의 유무에 따라 사용할 템플릿을 결정 합니다. 비 탐색기 및 탐색기 스타일 템플릿을 지정 하 여 Windows NT 3.51, Windows NT 4.0 이상 버전 및 Windows 95 이상 버전을 쉽게 지원할 수 있습니다.

> [!NOTE]
> Windows Vista 이상 스타일 파일 대화 상자는이 기능을 지원 하지 않습니다. Windows Vista 또는 이후 스타일 파일 대화 상자에서이 함수를 사용 하려고 하면 [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)이 throw 됩니다. 다른 방법은 사용자 지정 된 대화 상자를 사용 하는 것입니다. 사용자 지정을 사용 하는 방법에 대 한 자세한 내용은 `CFileDialog` [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)를 참조 하세요.

## <a name="cfiledialogstartvisualgroup"></a><a name="startvisualgroup"></a> CFileDialog:: StartVisualGroup

대화 상자에서 시각적 그룹을 선언 합니다. 모든 "add" 메서드에 대 한 후속 호출에서는 이러한 요소를이 그룹에 추가 합니다.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*(i) Ctl*<br/>
시각적 그룹의 ID입니다.

*strLabel*<br/>
그룹 이름입니다.

### <a name="remarks"></a>설명

## <a name="cfiledialogupdateofnfromshelldialog"></a><a name="updateofnfromshelldialog"></a> CFileDialog:: UpdateOFNFromShellDialog

`m_ofn`내부 개체의 현재 상태를 기반으로 [CFileDialog](../../mfc/reference/cfiledialog-class.md) 의 데이터 구조를 업데이트 합니다.

```cpp
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>설명

Windows Vista 이전 버전에서는 멤버 [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) 데이터 구조가의 상태와 지속적으로 동기화 되었습니다 `CFileDialog` . [M_ofn](#m_ofn) 멤버 변수에 대 한 모든 변경 내용은 대화 상자의 상태에 직접적으로 영향을 줍니다. 또한 대화의 상태를 변경 하면 m_ofn 멤버 변수가 즉시 업데이트 됩니다.

Windows Vista 이상에서는 `m_ofn` 데이터 구조가 자동으로 업데이트 되지 않습니다. 멤버 변수에 있는 데이터의 정확도를 보장 하려면 `m_ofn` `UpdateOFNFromShellDialog` 데이터에 액세스 하기 전에 함수를 호출 해야 합니다. Windows에서는 [Ifiledialog:: OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)를 처리 하는 동안이 함수를 자동으로 호출 합니다.

Windows Vista 이상에서 클래스를 사용 하는 방법에 대 한 자세한 내용은 `CFileDialog` [CFileDialog 클래스](../../mfc/reference/cfiledialog-class.md)를 참조 하세요.

### <a name="example"></a>예제

이 예제에서는를 `CFileDialog` 표시 하기 전에를 업데이트 합니다. 멤버 변수를 업데이트 하기 전에 `m_ofn` 대화 상자의 현재 상태와 동기화 해야 합니다.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>참고 항목

[CCommonDialog 클래스](../../mfc/reference/ccommondialog-class.md)<br/>
[계층 구조 차트](../../mfc/hierarchy-chart.md)
