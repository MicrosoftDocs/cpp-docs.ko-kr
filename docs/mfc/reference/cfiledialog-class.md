---
title: CFileDialog 클래스
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: fe4994b91813e2965972b47c838ddaf5333cc5f0
ms.sourcegitcommit: ecf274bcfe3a977c48745aaa243e5e731f1fdc5f
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/04/2019
ms.locfileid: "66503763"
---
# <a name="cfiledialog-class"></a>CFileDialog 클래스

파일 열기 또는 저장 작업 파일에 사용 되는 일반 대화 상자를 캡슐화 합니다.

## <a name="syntax"></a>구문

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>멤버

### <a name="public-constructors"></a>Public 생성자

|이름|설명|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|`CFileDialog` 개체를 생성합니다.|

### <a name="public-methods"></a>Public 메서드

|이름|설명|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|대화 상자에 확인 단추를 추가합니다.|
|[CFileDialog::AddComboBox](#addcombobox)|대화 상자에 콤보 상자를 추가합니다.|
|[CFileDialog::AddControlItem](#addcontrolitem)|대화 상자에서 컨테이너 컨트롤에 항목을 추가 합니다.|
|[CFileDialog::AddEditBox](#addeditbox)|대화 상자에는 입력란을 추가합니다.|
|[CFileDialog::AddMenu](#addmenu)|대화 상자에 메뉴를 추가합니다.|
|[CFileDialog::AddPlace](#addplace)|오버로드됨. 목록에 폴더를 열거나 항목을 저장 하는 사용자에 대 한 사용 가능한 배치를 추가 합니다.|
|[CFileDialog::AddPushButton](#addpushbutton)|대화 상자에 단추를 추가합니다.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|대화 상자에 옵션 단추 (라디오 단추 라고도 함) 그룹을 추가합니다.|
|[CFileDialog::AddSeparator](#addseparator)|대화 상자에 구분 기호를 추가합니다.|
|[CFileDialog::AddText](#addtext)|대화 상자에 텍스트 콘텐츠를 추가합니다.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|상태를 업데이트 합니다 `CFileDialog` 매개 변수 및 저장 하는 플래그와 일치 하는 `m_ofn` 멤버 변수입니다.|
|[CFileDialog::DoModal](#domodal)|대화 상자를 표시 및 선택할 수 있습니다.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|드롭다운 목록에서 사용 하도록 설정 합니다 **엽니다** 또는 **저장** 대화 상자에서 단추입니다.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Visual의 그룹 대화 상자에 요소가 추가 중지합니다.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|대화 상자에서 확인 단추 (확인란)의 현재 상태를 가져옵니다.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|대화 상자에 있는 컨테이너 컨트롤에 있는 항목의 현재 상태를 가져옵니다.|
|[CFileDialog::GetControlState](#getcontrolstate)|현재 표시 여부를 가져오고 지정된 된 컨트롤의 상태를 사용 하도록 설정 합니다.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|편집 상자 컨트롤에서 현재 텍스트를 가져옵니다.|
|[CFileDialog::GetFileExt](#getfileext)|선택한 파일의 확장명을 반환 합니다.|
|[CFileDialog::GetFileName](#getfilename)|선택한 파일의 파일 이름을 반환합니다.|
|[CFileDialog::GetFileTitle](#getfiletitle)|선택한 파일의 제목을 반환합니다.|
|[CFileDialog::GetFolderPath](#getfolderpath)|탐색기 스타일에 대 한 현재 열려 있는 폴더 또는 디렉터리의 경로 검색 **엽니다** 하거나 **다른 이름으로 저장** 일반 대화 상자.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|사용자 지정에 대 한 내부 COM 개체를 검색 `CFileDialog` 개체입니다.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|에 대 한 내부 COM 개체를 검색 하는 `CFileDialog` 으로 사용 되는 **오픈** 파일 대화 상자.|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|에 대 한 내부 COM 개체를 검색 하는 `CFileDialog` 으로 사용 되는 **저장** 파일 대화 상자.|
|[CFileDialog::GetNextPathName](#getnextpathname)|다음 선택한 파일의 전체 경로 반환합니다.|
|[CFileDialog::GetOFN](#getofn)|검색 된 `OPENFILENAME` 의 구조는 `CFileDialog` 개체입니다.|
|[CFileDialog::GetPathName](#getpathname)|선택한 파일의 전체 경로 반환합니다.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|선택한 파일의 읽기 전용 상태를 반환합니다.|
|[CFileDialog::GetResult](#getresult)|사용자 대화 상자에서 수행 하는 항목을 가져옵니다.|
|[CFileDialog::GetResults](#getresults)|다중 선택을 허용 하는 대화 상자에서 사용자의 선택 항목을 가져옵니다.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|대화 상자에서 지정 된 컨테이너 컨트롤에서 특정 항목을 가져옵니다.|
|[CFileDialog::GetStartPosition](#getstartposition)|파일 이름 목록의 첫 번째 요소의 위치를 반환합니다.|
|[CFileDialog::HideControl](#hidecontrol)|탐색기 스타일의 지정 된 컨트롤을 숨깁니다 **엽니다** 또는 **다른 이름으로 저장** 일반 대화 상자.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|확인 폴더 선택 모드에서 현재 대화 상자.|
|[CFileDialog::MakeProminent](#makeprominent)|위치 대화 상자에서 컨트롤을 구별 되도록 비교할 다른 추가 컨트롤입니다.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|대화 상자에서 컨테이너 컨트롤에서 항목을 제거합니다.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|대화 상자에서 확인 단추 (확인란)의 현재 상태를 설정합니다.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|대화 상자에 있는 컨테이너 컨트롤의 항목의 현재 상태를 설정 합니다.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|컨트롤 항목의 텍스트를 설정합니다. 예를 들어, 라디오 단추 또는 메뉴의 항목을 함께 제공 되는 텍스트입니다.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|단추 텍스트는 편집 상자 레이블 등 컨트롤과 관련 된 텍스트를 설정 합니다.|
|[CFileDialog::SetControlState](#setcontrolstate)|현재 표시 여부를 설정 하 고 지정된 된 컨트롤의 상태를 사용 하도록 설정 합니다.|
|[CFileDialog::SetControlText](#setcontroltext)|탐색기 스타일의 지정된 된 컨트롤에 대 한 텍스트를 설정 **엽니다** 또는 **다른 이름으로 저장** 일반 대화 상자.|
|[CFileDialog::SetDefExt](#setdefext)|탐색기 스타일에 대 한 기본 파일 이름 확장명 집합 **엽니다** 또는 **다른 이름으로 저장** 일반 대화 상자.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|편집 상자 컨트롤에서 현재 텍스트를 설정합니다.|
|[CFileDialog::SetProperties](#setproperties)|저장 중인 항목에 사용할 기본값을 정의하는 속성 저장소를 제공합니다.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|옵션 단추 그룹 또는 대화 상자에 있는 콤보 상자에서 특정 항목의 선택된 상태를 설정 합니다.|
|[CFileDialog::SetTemplate](#settemplate)|설정에 대 한 대화 상자 템플릿에 `CFileDialog` 개체입니다.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|대화 상자에서 visual 그룹을 선언합니다. 이 그룹에 해당 요소를 추가 하는 모든 "add" 메서드를 다시 호출 합니다.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|저장 된 데이터를 업데이트 합니다 `m_ofn` 파일 대화 상자의 현재 상태와 일치 하는 멤버 변수입니다.|

### <a name="protected-methods"></a>Protected 메서드

|이름|설명|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|단추를 클릭할 때 호출 됩니다.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|확인란이 선택/선택 취소 하는 경우 호출 됩니다.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|컨트롤이 활성화 될 때 호출 됩니다.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|WM_NOTIFY CDN_SELCHANGE 메시지를 처리 합니다.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|대화 상자에 입력 된 파일 이름을 확인 합니다.|
|[CFileDialog::OnFolderChange](#onfolderchange)|WM_NOTIFY CDN_FOLDERCHANGE 메시지를 처리 합니다.|
|[CFileDialog::OnInitDone](#oninitdone)|WM_NOTIFY CDN_INITDONE 메시지를 처리 합니다.|
|[CFileDialog::OnItemSelected](#onitemselected)|컨테이너 항목을 선택 하면 호출 됩니다.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|파일 선택을 변경 하면 사용자 지정 작업을 수행할 수 있습니다.|
|[CFileDialog::OnShareViolation](#onshareviolation)|핸들 공유 위반입니다.|
|[CFileDialog::OnTypeChange](#ontypechange)|WM_NOTIFY CDN_TYPECHANGE 메시지를 처리 합니다.|

### <a name="public-data-members"></a>공용 데이터 멤버

|이름|설명|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|Windows `OPENFILENAME` 구조입니다. 기본 파일 대화 상자 매개 변수에 대 한 액세스를 제공합니다.|

## <a name="remarks"></a>설명

공용 파일 대화 상자를 사용 하면 파일 선택 대화 상자, 예를 들어를 구현할 수 **열려 있는 파일** 하 고 **다른 이름으로 저장**, Windows 표준과 일치 하는 방식입니다.

사용할 수 있습니다 `CFileDialog` 생성자를 제공 하는 있는 그대로 또는 고유한 대화 상자 클래스에서 파생 될 수 있습니다 `CFileDialog` 및 필요에 맞게 생성자 작성 합니다. 두 경우 모두 이러한 대화 상자는 처럼 표준 MFC 대화 상자에서 파생 되므로 합니다 [CCommonDialog 클래스](../../mfc/reference/ccommondialog-class.md)합니다. `CFileDialog` COMMDLG 의존합니다. Windows에 포함 된 DLL 파일입니다.

모양과 기능을 모두는 `CFileDialog` 이전 버전의 Windows에서 Windows Vista 이상 다릅니다. 기본 `CFileDialog` 프로그램은 컴파일된 및 Windows vista 이상을 실행할 경우 새 Windows Vista 또는 코드 변경 없이 이후 스타일을 자동으로 사용 합니다. 사용 된 *bVistaStyle* 이 자동 업데이트를 수동으로 재정의 하는 생성자의 매개 변수입니다. 사용자 지정된 대화 상자는 자동 업데이트 예외가입니다. 또한 새 스타일으로 변환 되지 않습니다. 생성자에 대 한 자세한 내용은 참조 하세요. [CFileDialog::CFileDialog](#cfiledialog)합니다.

> [!NOTE]
>  컨트롤 ID 시스템 다른 Windows Vista 또는 Windows의 이전 버전에서 나중에 사용 하는 경우는 `CFileDialog`합니다. 에 대 한 모든 참조를 업데이트 해야 `CFileDialog` 컨트롤 코드 전에 이전 버전의 Windows에서 프로젝트를 이식할 수 있습니다.

일부 `CFileDialog` Windows vista 이상 메서드가 지원 되지 않습니다. 메서드는 지원 여부에 대 한 정보에 대 한 개별 메서드 항목을 확인 합니다. 또한 상속된 된 다음 함수는 Windows vista 이상 지원 되지 않습니다.

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

에 대 한 windows 메시지를 `CFileDialog` 클래스를 사용 하는 운영 체제에 따라 달라 집니다. 예를 들어, Windows XP 지원 하지 않습니다 [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) 하 고 [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) 에 대 한는 `CFileDialog` 클래스입니다. 그러나 Windows Vista 및 이후 운영 체제 지원지 않습니다. 생성 되는 다양 한 메시지와 수신 된 순서에 대 한 자세한 내용은 참조 하세요. [CFileDialog 샘플: 이벤트 순서 로깅](../../overview/visual-cpp-samples.md)합니다.

사용 하는 `CFileDialog` 개체를 처음 사용 하 여 개체를 만들기는 `CFileDialog` 생성자입니다. 대화 상자를 생성 한 후이 설정 하거나 모든 값을 수정할 수 있습니다 합니다 [CFileDialog::m_ofn](#m_ofn) 구조 값 또는 대화 상자 컨트롤의 상태를 초기화 합니다. 합니다 `m_ofn` 구조체가 형식의 `OPENFILENAME`합니다. 자세한 내용은 참조는 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) Windows SDK에는 구조입니다.

대화 상자 컨트롤을 초기화 한 후 호출 된 [CFileDialog::DoModal](#domodal) 대화 상자를 표시 하는 방법 상자는 사용자의 경로 파일 이름을 입력할 수 있도록 합니다. `DoModal` 사용자 (IDOK) 확인 또는 취소 (IDCANCEL) 단추를 클릭 여부를 반환 합니다. 경우 `DoModal` IDOK 반환 중 하나를 사용할 수 있습니다는 `CFileDialog` 정보를 검색 하는 공용 멤버 함수에 사용자가 저장 합니다.

> [!NOTE]
> Windows Vista 이상에 대 한 여러 호출은 [IFileDialog::SetFileTypes](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) 오류가 발생 합니다. 두 번째 호출은 `SetFileTypes` 의 모든 인스턴스에 대해는 `CFileDialog` Windows Vista 이상에서 E_UNEXPECTED를 반환 합니다. 일부 `CFileDialog` 메서드 호출을 함수 `SetFileTypes`합니다. 예를 들어 두 호출 `CFileDialog::DoModal` 의 동일한 인스턴스를 `CFileDialog` 생성 [ASSERT](diagnostic-services.md#assert)합니다.

`CFileDialog` 공유 위반, 파일 이름 유효성 검사 및 목록 상자 변경 알림을 사용자 지정 처리 작업을 수행할 수 있는 몇 가지 보호 된 멤버를 포함 합니다. 이러한 보호 된 멤버는 대부분의 응용 프로그램 기본 처리를 자동으로 수행 되기 때문에 사용 하지 않아도 콜백 함수입니다. 표준 가상 함수가 이기 때문에 이러한 함수에 대 한 메시지 맵 항목 필요 하지 않습니다.

Windows를 사용할 수 있습니다 [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) 함수 대화 상자를 초기화 하는 동안 오류가 발생 했는지 여부를 확인 하 고 오류에 자세히 알아보기.

소멸 `CFileDialog` 개체는 자동으로 처리 됩니다. 호출할 필요가 없습니다 [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog)합니다.

여러 파일 선택를 호출 하기 전에 OFN_ALLOWMULTISELECT 플래그를 설정, 사용자에 게 `DoModal`합니다. 파일 이름 여러 개 반환된 된 목록에 맞게 사용자 고유의 파일 이름 버퍼를 제공 해야 합니다. 대체 하 여이 작업을 수행할 `m_ofn.lpstrFile` 버퍼에 대 한 포인터를 사용 하 여 할당을 생성 한 후 합니다 `CFileDialog`를 호출 하기 전에 `DoModal`입니다.

또한 설정 해야 합니다 `m_ofn.nMaxFile` 에서 가리키는 버퍼의 문자 수를 사용 하 여 `m_ofn.lpstrFile`입니다. 선택 하려면 파일의 최대 수를 설정 하면 `n`, 필요한 버퍼 크기는 `n * (_MAX_PATH + 1) + 1`합니다. 버퍼에 반환 되는 첫 번째 항목에는 파일이 선택한 위치 폴더 경로입니다. Windows Vista 또는 이후 스타일 대화 상자에 대 한 디렉터리 및 파일 이름 문자열은 null로 끝납니다 마지막 파일 이름 뒤에 오는 추가 null 문자를 사용 하 여 합니다. 이 형식의 공백을 포함 하는 긴 파일 이름을 반환할 탐색기 스타일 대화 상자를 사용 합니다. 이전 스타일 대화 상자에 대 한 공백으로 구분 된 디렉터리 및 파일 이름 문자열 및 함수는 공백을 사용 하 여 파일 이름에 대 한 약식 파일 이름을 사용 합니다.

다음 예에서는 버퍼를 사용 하 여 검색 하 고 여러 파일 이름을 나열 하는 방법에 설명 합니다.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

여러 파일 이름을 선택 하 여 사용자에 대 한 응답 버퍼 크기를 변경 하려면 새 클래스에서 파생 시켜야 `CFileDialog` 시키고 합니다 [CFileDialog::OnFileNameChange](#onfilenamechange) 메서드.

새 클래스를 파생 하는 경우 `CFileDialog`, 모든 메시지를 처리 하는 메시지 맵을 사용할 수 있습니다. 기본 메시지 처리를 확장 하려면에서 클래스를 파생 `CFileDialog`메시지 맵에서 새로운 클래스를 추가 하 고 새 메시지에 대 한 멤버 함수를 제공 합니다. 사용자 지정 대화 상자에 후크 함수를 제공할 필요가 없습니다.

대화 상자를 사용자 지정 하려면 클래스를 파생 `CFileDialog`사용자 지정 대화 상자 템플릿을 제공 하 고 확장 된 컨트롤에서 알림 메시지를 처리 하는 메시지 맵을 추가 합니다. 기본 클래스에 처리 되지 않은 메시지를 전달 합니다. 후크 함수를 사용자 지정할 필요가 없습니다.

Windows Vista 또는 이후 스타일을 사용 하는 경우는 `CFileDialog`, 메시지 맵 및 대화 상자 템플릿을 사용할 수 없습니다. 대신, 유사한 기능을 위해 COM 인터페이스를 사용 해야 합니다.

사용 하는 방법에 대 한 자세한 내용은 `CFileDialog`를 참조 하세요 [일반 대화 상자 클래스](../../mfc/common-dialog-classes.md)합니다.

## <a name="inheritance-hierarchy"></a>상속 계층 구조

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>요구 사항

**헤더:** afxdlgs.h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

대화 상자에 확인 단추를 추가합니다.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
추가할 ID 확인 단추입니다.

*strLabel*<br/>
확인 단추 이름입니다.

*bChecked*<br/>
확인 단추의 현재 상태를 나타내는 부울입니다. 선택 하는 경우 TRUE입니다. FALSE이 고, 그렇지

### <a name="remarks"></a>설명

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

대화 상자에 콤보 상자를 추가합니다.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
추가할 ID 콤보 상자입니다.

### <a name="remarks"></a>설명

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

대화 상자에서 컨테이너 컨트롤에 항목을 추가 합니다.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
항목을 추가할 컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목의 ID입니다.

*strLabel*<br/>
항목의 텍스트입니다.

### <a name="remarks"></a>설명

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

대화 상자에는 입력란을 추가합니다.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
추가할 입력란의 ID입니다.

*strText*<br/>
편집 상자 이름입니다.

### <a name="remarks"></a>설명

##  <a name="addmenu"></a>  CFileDialog::AddMenu

대화 상자에 메뉴를 추가합니다.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
추가할 메뉴의 ID입니다.

*strLabel*<br/>
메뉴 이름입니다.

### <a name="remarks"></a>설명

##  <a name="addplace"></a>  CFileDialog::AddPlace

목록에 폴더를 열거나 항목을 저장 하는 사용자에 대 한 사용 가능한 배치를 추가 합니다.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>매개 변수

*lpszFolder*<br/>
사용자에 게 사용할 수 있게 하려면 폴더 경로입니다. 이 폴더 수만 있습니다.

*fdap*<br/>
목록 내에서 폴더 위치를 지정 합니다.

*psi*<br/>
사용자에 게 사용할 수 있게 하려면 폴더를 나타내는 IShellItem 포인터입니다. 이 폴더 수만 있습니다.

### <a name="remarks"></a>설명

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

대화 상자에 단추를 추가합니다.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
추가 단추 ID입니다.

*strLabel*<br/>
단추 이름입니다.

### <a name="remarks"></a>설명

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

대화 상자에 옵션 단추 (라디오 단추 라고도 함) 그룹을 추가합니다.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
추가 옵션 단추 그룹의 ID입니다.

### <a name="remarks"></a>설명

##  <a name="addseparator"></a>  CFileDialog::AddSeparator

대화 상자에 구분 기호를 추가합니다.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
ID는 구분 기호를 추가 합니다.

### <a name="remarks"></a>설명

##  <a name="addtext"></a>  CFileDialog::AddText

대화 상자에 텍스트를 추가합니다.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
추가 된 텍스트의 ID입니다.

*strText*<br/>
텍스트 이름입니다.

### <a name="remarks"></a>설명

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

현재 상태를 업데이트 합니다 [CFileDialog](../../mfc/reference/cfiledialog-class.md) 에 저장 된 값을 기반으로 합니다 `m_ofn` 데이터 구조입니다.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>설명

Windows Vista을 멤버 이전 Windows 버전에서 [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) 데이터 구조체의 상태를 사용 하 여 지속적으로 동기화 된는 `CFileDialog`합니다. 변경 된 [m_ofn](#m_ofn) 멤버 변수 대화 상자 상태의에 즉시 반영 되었습니다. 또한 대화 상자 상태의 변경 내용을 업데이트 즉시는 `m_ofn` 멤버 변수입니다.

Windows Vista 이상 버전에서는 값을 `m_ofn` 멤버 변수와의 상태를 `CFileDialog` 동기화 되도록 보장 되지 않습니다. 이 함수는 상태를 강제로 합니다 `CFileDialog` 일치 하도록 업데이트 되어야 합니다 `m_ofn` 구조입니다. Windows는 동안 자동으로이 함수를 호출 [CFileDialog::DoModal](#domodal)합니다.

사용 하는 방법에 대 한 자세한 내용은 합니다 `CFileDialog` Windows Vista에서 클래스 또는 나중에 참조 [CFileDialog 클래스](../../mfc/reference/cfiledialog-class.md)합니다.

### <a name="example"></a>예제

  예를 참조 하세요 [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)합니다.

##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog

표준 Windows 파일 대화 상자를 생성 하려면이 함수를 호출 합니다.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>매개 변수

*bOpenFileDialog*<br/>
[in] 대화 상자를 만들의 형식을 지정 하는 매개 변수입니다. 생성 하려면 TRUE로 설정 된 **파일 열기** 대화 상자. 생성 하려면 FALSE로 설정 된 **다른 이름으로 저장** 대화 상자.

*lpszDefExt*<br/>
[in] 기본 파일 이름 확장명입니다. 확장에서 지정한 파일 이름 상자에 사용자 (사용자의 컴퓨터에는 연결이 하나) 알려진된 확장명이 포함 되어 있지 않으면, *lpszDefExt* 파일 이름에 자동으로 추가 됩니다. 이 매개 변수가 NULL 인 경우에 확장명이 추가 됩니다.

*lpszFileName*<br/>
[in] 파일 이름 상자에 표시 되는 초기 파일 이름입니다. NULL 인 경우에 초기 파일 이름 없이 표시 됩니다.

*dwFlags*<br/>
[in] 사용자 지정 대화 상자를 사용할 수 있는 하나 이상의 플래그의 조합입니다. 이러한 플래그에 대 한 참조를 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) Windows SDK에는 구조입니다. 수정 하는 경우는 `m_ofn.Flags` 멤버 구조에 변경 내용을 비트 OR 연산자를 사용 하 여 기본 동작을 그대로 유지 합니다.

*lpszFilter*<br/>
[in] 일련의 필터를 지정 하는 문자열 쌍 파일에 적용할 수 있습니다. 파일 필터를 지정 하는 경우 필터 조건과 일치 하는 파일만 파일 목록에 표시 됩니다. 파일 필터를 사용 하는 방법에 대 한 자세한 내용은 설명 섹션을 참조 하세요.

*pParentWnd*<br/>
[in] 파일 대화 상자의 부모 또는 소유자 창에 대 한 포인터입니다.

*dwSize*<br/>
[in] 크기는 `OPENFILENAME` 구조입니다. 이 값은 운영 체제 버전에 따라 달라 집니다. MFC 대화 상자를 만들 적합 한 유형의 확인 하려면이 매개 변수를 사용 합니다. MFC 코드를 사용 하 여 해당 대화 상자 크기를 결정 하는 0으로의 기본 크기는 프로그램이 실행 되는 운영 체제 버전을 기반으로 합니다.

*bVistaStyle*<br/>
[in] **참고** 이 매개 변수는 Visual Studio 2008에서 제공 되며 이후 이며는 Windows Vista 이상에서 실행 하는 경우에 사용 하는 새 스타일 대화 상자의 발생 합니다.

파일 대화 상자의 스타일을 지정 하는 매개 변수입니다. true로 설정 된 새 Vista 스타일을 사용 하 여 파일 대화 상자. 그렇지 않은 경우 이전 스타일 대화 상자 사용 됩니다. Vista에서 실행에 대 한 자세한 내용은 설명 섹션을 참조 합니다.

### <a name="remarks"></a>설명

중 하나를 **파일 열기** 또는 **다른 이름으로 저장** 대화 상자 생성 되 면 값에 따라 *bOpenFileDialog*합니다.

사용 하 여 기본 확장을 지정 *lpszDefExt* 이기 때문에 거의 예측할 수 있는 확장 사용자의 컴퓨터에 대 한 파일 연결에는 동작을 생성할 수 있습니다. 기본 확장 프로그램의 추가 통해 더 많은 제어를 해야 하는 경우에서 고유한 클래스를 파생할 수 있습니다 `CFileDialog`를 재정의 하 고는 `CFileDialog::OnFileNameOK` 고유한 확장 처리를 수행 하는 방법입니다.

호출 하기 전에 사용자가 여러 파일을 선택할 수 있도록, OFN_ALLOWMULTISELECT 플래그를 설정 [DoModal](#domodal)합니다. 저장할 파일 이름 여러 개 반환된 된 목록에 고유한 파일 이름 버퍼를 제공 해야 합니다. 대체 하 여이 작업을 수행할 `m_ofn.lpstrFile` 버퍼에 대 한 포인터를 사용 하 여 할당을 생성 한 후 합니다 [CFileDialog](../../mfc/reference/cfiledialog-class.md)를 호출 하기 전에 `DoModal`입니다. 또한 설정 해야 합니다 `m_ofn.nMaxFile` 에서 가리키는 버퍼의 문자 수가 `m_ofn.lpstrFile`합니다. 선택 하려면 파일의 최대 수를 설정 하면 *n*, 필요한 버퍼 크기는 `n`*(_MAX_PATH + 1) + 1입니다. 예를 들어:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

사용자를 탐색기 스타일 대화 상자를 마우스 또는 키보드를 사용 하 여 조정할 수 있도록, OFN_ENABLESIZING 플래그를 설정 합니다. 이 플래그를 설정 하는 것은 후크 프로시저 또는 사용자 지정 서식 파일을 제공 하는 경우에 필요 합니다. 플래그는 탐색기 스타일 대화 상자 에서만 작동 이전 스타일 대화 상자 크기를 조정할 수 없습니다.

합니다 *lpszFilter* 파일로 파일 목록에 표시할 수 있어야 하는 파일 이름의 형식을 확인할 매개 변수를 사용 합니다. 문자열 쌍의 첫 번째 문자열; 필터를 설명합니다. 두 번째 문자열을 사용 하 여 파일 이름 확장명을 나타냅니다. 구분 기호로 세미콜론 (';' 문자)를 사용 하 여 여러 확장을 지정할 수 있습니다. 두 개의 문자열 종료 '&#124;' 문자를 NULL 문자 뒤에 있습니다. 사용할 수도 있습니다는 [CString](../../atl-mfc-shared/using-cstring.md) 이 매개 변수에 대 한 개체입니다.

예를 들어 Microsoft Excel에서는 확장.xlc (차트) 또는 특히.xls (워크시트)에 있는 파일을 열 수가 있습니다. Excel에 대 한 필터는 다음과 같이 작성할 수 있습니다.

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

그러나이 문자열을 직접 사용 하려는 경우 업데이트 합니다 `OPENFILENAME` 구조를 대신 세로 막대에는 ' \0', null 문자로 문자열을 구분 해야 합니다 ('&#124;').

합니다 *bVistaStyle* 매개 변수는 Windows vista 이상을 실행 하는 경우에 해당 합니다. Windows의 이전 버전에서이 매개 변수가 무시 됩니다. 하는 경우 *bVistaStyle* 가 TRUE로 설정, Visual Studio 2008 이상, 프로그램을 컴파일할 때 새 Vista 스타일 **파일 대화 상자** 사용 됩니다. 그렇지 않으면 이전 MFC 스타일 **파일 대화 상자** 사용 됩니다.

대화 상자 템플릿을 기반으로 하는 대화 상자에서 지원 되지 않습니다 *bVistaStyle*

### <a name="example"></a>예제

  예를 참조 하세요 [CFileDialog::DoModal](#domodal)합니다.

##  <a name="domodal"></a>  CFileDialog::DoModal

Windows 공용 파일 대화 상자를 표시 하 고 사용자가 파일 및 디렉터리를 검색 하 고 파일 이름을 입력 하도록 허용 하려면이 함수를 호출 합니다.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>반환 값

IDOK 또는 idcancel이 반환 됩니다. IDCANCEL이 반환 되는 Windows를 호출 [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) 오류가 발생 했는지 여부를 결정 하는 함수입니다.

IDOK 및 IDCANCEL는 사용자 확인 또는 취소 단추를 선택 하는지 여부를 나타내는 상수입니다.

### <a name="remarks"></a>설명

멤버를 설정 하 여 다양 한 파일 대화 상자 옵션을 초기화 하려는 경우는 `m_ofn` 구조를 호출 하기 전에이 작업을 수행 해야 `DoModal`, 대화 상자 개체에서 생성 된 후 있지만.

예를 들어 사용자가 여러 파일을 선택 하도록 허용 하려는 플래그를 설정 OFN_ALLOWMULTISELECT 호출 하기 전에 `DoModal`이 항목의 코드 예제에 나와 있는 것 처럼 합니다.

대화 상자의 확인 또는 취소 단추 또는 종료 선택 옵션 대화 상자에서 사용자가 컨트롤 메뉴 컨트롤 응용 프로그램에 반환 됩니다. 호출할 수 있습니다 설정 또는 정보를 검색 하는 다른 멤버 함수는 사용자 입력 대화 상자에 있습니다.

`DoModal` 클래스에서 재정의 되는 가상 함수는 `CDialog`합니다.

### <a name="example"></a>예제

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

드롭다운 목록 열기 또는 저장 대화 상자에서 단추를 사용 하도록 설정 합니다.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
드롭다운 목록의 ID입니다.

### <a name="remarks"></a>설명

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

Visual의 그룹 대화 상자에 요소가 추가 중지합니다.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>반환 값

성공 하면 s_ok이 고, 반환 그렇지 않으면 오류 값입니다.

### <a name="remarks"></a>설명

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

대화 상자에서 확인 단추 (확인란)의 현재 상태를 검색합니다.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
확인란의 ID입니다.

*bChecked*<br/>
확인란의 상태입니다. TRUE 이면 확인 된; FALSE 이면 선택 취소 합니다.

### <a name="remarks"></a>설명

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

대화 상자에 있는 컨테이너 컨트롤에 있는 항목의 현재 상태를 검색 합니다.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목의 ID입니다.

*dwState*<br/>
컨트롤의 현재 상태를 나타내는 CDCONTROLSTATE 열거형에서 더 많은 값 중 하나를 수신 하는 변수에 대 한 참조입니다.

### <a name="remarks"></a>설명

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

현재 표시 여부를 검색 하 고 지정된 된 컨트롤의 상태를 사용 하도록 설정 합니다.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨트롤의 ID입니다.

*dwState*<br/>
컨트롤의 현재 상태를 나타내는 CDCONTROLSTATE 열거형에서 하나 이상의 값을 수신 하는 변수에 대 한 참조입니다.

### <a name="remarks"></a>설명

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

편집 상자 컨트롤에서 현재 텍스트를 검색합니다.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
입력란의 ID입니다.

*strText*<br/>
텍스트 값입니다.

### <a name="remarks"></a>설명

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

대화 상자에 입력 파일의 확장명을 검색 하려면이 함수를 호출 합니다.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>반환 값

파일 이름 확장명입니다.

### <a name="remarks"></a>설명

예를 들어 파일의 이름을 입력 하는 경우에 데이터입니다. TXT `GetFileExt` "TXT"를 반환 합니다.

경우 `m_ofn.Flags` OFN_ALLOWMULTISELECT 플래그가 설정 하 고,이 문자열 포함 디렉터리 경로의 파일 그룹을 선택 하 되는 첫 번째 문자열을 사용 하 여 null로 끝나는 문자열의 시퀀스 뒤에 사용자가 선택한 모든 파일의 이름입니다. 파일 경로 검색 하려면 사용 합니다 [GetStartPosition](#getstartposition) 하 고 [GetNextPathName](#getnextpathname) 멤버 함수입니다.

##  <a name="getfilename"></a>  CFileDialog::GetFileName

대화 상자에서 입력 파일의 이름을 검색 하려면이 함수를 호출 합니다.

```
CString GetFileName() const;
```

### <a name="return-value"></a>반환 값

파일의 이름입니다.

### <a name="remarks"></a>설명

파일의 이름에는 접두사 및 확장을 모두 포함 됩니다. 예를 들어 `GetFileName` "텍스트가 반환 됩니다. DAT "C:\FILES\TEXT.DAT 파일에 대 한 합니다.

경우 `m_ofn.Flags` 에 `OFN_ALLOWMULTISELECT` 플래그가 설정 호출 해야 [GetStartPosition](#getstartposition) 하 고 [GetNextPathName](#getnextpathname) 파일 경로 검색할 합니다.

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

대화 상자에서 입력 파일의 제목을 검색 하려면이 함수를 호출 합니다.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>반환 값

파일의 제목입니다.

### <a name="remarks"></a>설명

파일의 제목에만 해당 접두사를 경로 또는 확장 없이 포함 됩니다. 예를 들어 `GetFileTitle` C:\FILES\TEXT.DAT 파일에 대 한 "TEXT"를 반환 합니다.

경우 `m_ofn.Flags` OFN_ALLOWMULTISELECT 플래그가 설정 하 고,이 문자열 포함 디렉터리 경로의 파일 그룹을 선택 하 되는 첫 번째 문자열을 사용 하 여 null로 끝나는 문자열의 시퀀스 뒤에 사용자가 선택한 모든 파일의 이름입니다. 이러한 이유로 사용 합니다 [GetStartPosition](#getstartposition) 및 [GetNextPathName](#getnextpathname) 목록에서 다음 파일 이름을 검색 하는 멤버 함수입니다.

### <a name="example"></a>예제

  예를 참조 하세요 [CFileDialog::DoModal](#domodal)합니다.

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

현재 열려 있는 폴더 또는 explorer-style Open 또는 다른 이름으로 저장 일반 대화 상자에 대 한 디렉터리의 경로 검색 하려면이 멤버 함수를 호출 합니다.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>반환 값

A [CString](../../atl-mfc-shared/reference/cstringt-class.md) 현재 열려 있는 폴더 또는 디렉터리를 포함 하는 개체입니다.

### <a name="remarks"></a>설명

대화 상자는 OFN_EXPLORER 스타일을 사용 하 여 만들어야 합니다. 이 고, 그렇지 메서드는 어설션을 사용 하 여 실패 합니다.

대화 상자를 표시 하는 동안에이 메서드를 호출할 수 있습니다. 대화 상자를 닫으면이 함수를 더 이상 작동 하 고 메서드는 어설션을 사용 하 여 실패 합니다.

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

검색에 대 한 내부 COM 개체에 대 한 포인터를 지정 [CFileDialog](../../mfc/reference/cfiledialog-class.md)합니다.

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>반환 값

에 대 한 내부 COM 개체에 대 한 포인터를 `CFileDialog`입니다. 것이 포인터를 적절 하 게 해제 해야 합니다.

### <a name="remarks"></a>설명

Windows Vista에만 또는 있는 개체를 사용 하 여 나중에이 함수를 사용 하 여 *bVistaStyle* TRUE로 설정 합니다. 이 함수를 사용 하는 경우 때 *bVistaStyle* FALSE는 릴리스 모드에서 NULL을 반환 하 고 디버그 모드에서 어설션을 throw 합니다.

에 대 한 자세한 내용은 합니다 `IFileDialogCustomize` 인터페이스를 참조 하십시오 [해 주는 IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)합니다.

### <a name="example"></a>예제

이 예제에서는 내부 COM 개체를 검색 합니다. 이 코드 예제를 실행 하려면 Windows vista 이상 컴파일합니다 해야 있습니다.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

검색에 대 한 내부 COM 개체에 대 한 포인터를 지정 된 `CFileDialog`합니다.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>반환 값

에 대 한 내부 COM 개체에 대 한 포인터를 `CFileDialog`입니다. 것이 포인터를 적절 하 게 해제 해야 합니다.

### <a name="remarks"></a>설명

Windows Vista에만 또는 있는 개체를 사용 하 여 나중에이 함수를 사용 하 여 *bVistaStyle* TRUE로 설정 합니다. 경우이 함수는 NULL을 반환 합니다 `CFileDialog` 아닙니다를 **열기** 대화 상자 이거나 *bVistaStyle* 가 FALSE로 설정 합니다. 이 마지막 경우에만 반환 NULL-릴리스 모드에서 디버그 모드에서 throw 됩니다 어설션 합니다.

에 대 한 자세한 내용은 합니다 `IFileOpenDialog` 인터페이스를 참조 하십시오 [IFileOpenDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)합니다.

### <a name="example"></a>예제

이 예제에서는 내부 COM 개체를 검색 합니다. 이 코드를 실행 하려면 Windows vista 이상 컴파일합니다 해야 있습니다.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

검색에 대 한 내부 COM 개체에 대 한 포인터를 지정 된 `CFileDialog`합니다.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>반환 값

에 대 한 내부 COM 개체에 대 한 포인터를 `CFileDialog`입니다. 것이 포인터를 적절 하 게 해제 해야 합니다.

### <a name="remarks"></a>설명

Windows Vista에만 또는 있는 개체를 사용 하 여 나중에이 함수를 사용 하 여 *bVistaStyle* TRUE로 설정 합니다. 이 함수는 NULL이 반환 하는 경우는 `CFileDialog` 아닙니다를 **저장** 대화 상자 이거나 *bVistaStyle* 가 FALSE로 설정 합니다. 이 마지막 경우에만 반환 NULL-릴리스 모드에서 디버그 모드에서 throw 됩니다 어설션 합니다.

에 대 한 자세한 내용은 합니다 `IFileSaveDialog` 인터페이스를 참조 하십시오 [IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog)합니다.

### <a name="example"></a>예제

이 예제에서는 내부 COM 개체를 검색 합니다. 이 코드 예제를 실행 하려면 Windows vista 이상 컴파일합니다 해야 있습니다.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName

대화 상자에서 선택한 그룹에서 다음 파일 이름을 검색 하려면이 함수를 호출 합니다.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>매개 변수

*pos*<br/>
이전 반환한 위치 값에 대 한 참조가 `GetNextPathName` 또는 `GetStartPosition` 함수 호출 합니다. 목록의 끝에 도달 하는 경우 NULL입니다.

### <a name="return-value"></a>반환 값

파일의 전체 경로입니다.

### <a name="remarks"></a>설명

파일의 경로 파일의 제목 및 전체 디렉터리 경로 포함합니다. 예를 들어 `GetNextPathName` "C:\FILES\TEXT를 반환 합니다. DAT "C:\FILES\TEXT.DAT 파일에 대 한 합니다. 사용할 수 있습니다 `GetNextPathName` 정방향 반복 루프에 대 한 호출의 초기 위치를 설정한 경우에서 `GetStartPosition`합니다.

선택 파일 하나만으로 구성 된 경우 파일 이름을 반환 됩니다.

##  <a name="getofn"></a>  CFileDialog::GetOFN

연결 된 검색 `OPENFILENAME` 구조입니다.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>반환 값

[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) 구조입니다.

### <a name="remarks"></a>설명

이 함수의 두 번째 버전의 모양을 초기화 하는 데는 **파일 열기** 또는 **다른 이름으로 저장** 으로 표시 되기 전에 하지만 생성 된 후 대화 상자를 `DoModal` 멤버 함수입니다. 예를 들어, 설정할 수 있습니다 합니다 `lpstrTitle` 소속 `m_ofn` 캡션을 하려는 대화 상자.

##  <a name="getpathname"></a>  CFileDialog::GetPathName

대화 상자에서 입력 파일의 전체 경로 검색 하려면이 함수를 호출 합니다.

```
CString GetPathName() const;
```

### <a name="return-value"></a>반환 값

파일의 전체 경로입니다.

### <a name="remarks"></a>설명

파일의 경로 파일의 제목 및 전체 디렉터리 경로 포함합니다. 예를 들어 `GetPathName` "C:\FILES\TEXT를 반환 합니다. DAT "C:\FILES\TEXT.DAT 파일에 대 한 합니다.

경우 `m_ofn.Flags` OFN_ALLOWMULTISELECT 플래그가 설정 하 고,이 문자열 시퀀스를 포함 null teminated의 선택한 파일 그룹의 디렉터리 경로 되는 첫 번째 문자열을 사용 하 여 문자열 뒤에 사용자가 선택한 모든 파일의 이름입니다. 이러한 이유로 사용 합니다 [GetStartPosition](#getstartposition) 및 [GetNextPathName](#getnextpathname) 목록에서 다음 파일 이름을 검색 하는 멤버 함수입니다.

### <a name="example"></a>예제

  예를 참조 하세요 [CFileDialog::DoModal](#domodal)합니다.

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

Windows 표준 파일 열기 및 파일 이름으로 저장 대화 상자에서 읽기 전용 확인란이 선택 되어 있는지 여부를 결정 하는이 함수를 호출 합니다.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>반환 값

0이 아닌 대화 상자에서 읽기 전용 확인란을 선택 하는 경우 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

OFN_HIDEREADONLY 스타일을 설정 하 여 읽기 전용 확인란을 숨길 수 있습니다는 `CFileDialog` 생성자입니다.

> [!NOTE]
> Windows Vista 또는 이후 스타일 `CFileDialog` 개체는이 함수를 지원 하지 않습니다. 이 함수를 사용 하 여 Windows Vista 또는 이후 스타일 하려고 `CFileDialog` 시킵니다 [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)합니다.

##  <a name="getresult"></a>  CFileDialog::GetResult

선택 대화 상자에서 만든 사용자를 검색 합니다.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>반환 값

사용자가 선택한 항목을 나타내는 IShellItem 포인터입니다.

### <a name="remarks"></a>설명

##  <a name="getresults"></a>  CFileDialog::GetResults

다중 선택을 허용 하는 대화 상자에서 사용자의 선택 항목을 검색 합니다.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>반환 값

대화 상자에서 선택한 항목에 액세스할 수 있는 IShellItemArray 포인터입니다.

### <a name="remarks"></a>설명

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

대화 상자에서 지정 된 컨테이너 컨트롤에서 특정 항목을 검색합니다.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
사용자가 컨트롤에서 선택한 항목의 ID입니다.

### <a name="remarks"></a>설명

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

목록에서 첫 번째 파일 경로 위치를 검색 하려면이 멤버 함수를 호출 하 여 경우 `m_ofn.Flags` OFN_ALLOWMULTISELECT 플래그가 설정 합니다.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>반환 값

반복에 사용할 수 있는 위치 값 목록이 비어 있는 경우 NULL입니다.

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

Explorer-style Open 또는 다른 이름으로 저장 공용 대화 상자에서 지정된 된 컨트롤을 숨기려면이 멤버 함수를 호출 합니다.

```
void HideControl(int nID);
```

### <a name="parameters"></a>매개 변수

*nID*<br/>
숨기기 컨트롤의 ID입니다.

### <a name="remarks"></a>설명

대화 상자는 OFN_EXPLORER 스타일을 사용 하 여 만들어야 합니다. 그렇지 않으면 함수 어설션에서 실패 합니다.

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

현재 대화 상자에서 폴더 선택 모드 인지 확인 합니다.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>반환 값

대화 상자에서 폴더 선택 모드 이면 TRUE 그렇지 않으면 FALSE입니다.

### <a name="remarks"></a>설명

##  <a name="m_ofn"></a>  CFileDialog::m_ofn

`m_ofn` 형식의 구조가 `OPENFILENAME`합니다. 이 구조에서 데이터의 현재 상태를 나타내는 `CFileDialog`합니다.

### <a name="remarks"></a>설명

이 구조를 사용 하 여 모양의 초기화를 **파일 열기** 또는 **다른 이름으로 저장** 대화 상자를 표시 하기 전에 있지만를 생성 한 후는 [DoModal](#domodal) 메서드. 예를 들어, 설정할 수 있습니다 합니다 *lpstrTitle* 소속 `m_ofn` 캡션을 하려는 대화 상자.

Windows Vista 또는 이후 스타일을 사용 하 여 [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` 항상 대화 상자의 상태와 일치 하도록 보장 되지 않습니다. 이전 버전 Windows의 대화 상자를 사용 하 여 동기화 합니다. 참조 [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) 하 고 [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) 동기화 하는 방법에 대 한 자세한 내용은 합니다 `m_ofn` 구조 및 `CFileDialog` 상태 Windows Vista 이상에서.

Windows Vista 또는 이후 스타일 파일 대화 상자 및 지원 하지 특정 멤버의 플래그는 `CFileDialog`합니다. 결과적으로, 이러한 아무런 효과가 없습니다.

다음은 Windows vista 이상 지원 되지 않는 멤버의 목록입니다.

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

다음 플래그는 지원 되지 않습니다 및 Windows Vista 또는 이후 스타일을 사용 하는 경우 영향을 주지 않습니다 했으므로 `CFileDialog`:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES-효과적으로 항상에서 Windows Vista 이상에서

- OFN_NOLONGNAMES-Windows Vista 이상에서 효과적으로 항상 해제

- OFN_NONETWORKBUTTON-효과적으로 항상에서 Windows Vista 이상에서

- OFN_READONLY

- OFN_SHOWHELP

이 구조에 대 한 자세한 내용은 참조는 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) Windows SDK에는 구조입니다.

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

위치 대화 상자에서 컨트롤을 구별 되도록 비교할 다른 컨트롤입니다.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨트롤의 ID입니다.

### <a name="remarks"></a>설명

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

단추를 클릭할 때 호출 됩니다.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
단추의 ID입니다.

### <a name="remarks"></a>설명

##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled

확인란을 선택 하거나 선택을 취소할 때 호출 됩니다.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
확인란의 ID입니다.

*bChecked*<br/>
Checked 또는 unchecked 합니다.

### <a name="remarks"></a>설명

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

컨트롤이 활성화 될 때 호출 됩니다.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨트롤의 ID입니다.

### <a name="remarks"></a>설명

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

WM_NOTIFY CDN_SELCHANGE 메시지를 처리 하려는 경우이 메서드를 재정의 합니다.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>설명

시스템은 사용자가 파일 목록에서 새 파일 또는 폴더를 선택할 때 CDN_SELCHANGE 메시지를 보냅니다 합니다 **엽니다** 또는 **다른 이름으로 저장** 대화 상자. 이 메시지에 대 한 응답에서 모든 작업을 수행 하려는 경우이 메서드를 재정의 합니다.

시스템이 켜져 OFN_EXPLORER 플래그를 사용 하 여 대화 상자를 만든 경우에이 메시지를 보냅니다. 알림에 대 한 자세한 내용은 참조 하세요. [CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange)합니다. OFN_EXPLORER 플래그에 대 한 자세한 내용은 참조는 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) 구조 및 [열기 및 저장으로 대화 상자](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)합니다.

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

공용 파일 대화 상자에 입력 되는 파일 이름의 사용자 지정 유효성 검사를 제공 하려는 경우에이 함수를 재정의 합니다.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>반환 값

파일 이름이 유효한 파일 이름이; 없으면 1 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

이 함수를 사용 하면 응용 프로그램별 이유로 파일 이름을 거부 수 있습니다. 일반적으로 프레임 워크 파일의 기본 유효성 검사를 제공 하 고 잘못 된 파일 이름을 입력 한 경우 메시지 상자를 표시 하기 때문에이 함수를 사용할 필요가 없습니다.

1이 반환 되 면 대화 상자를 다른 파일 이름을 입력 하 여 사용자에 대해 표시 된 상태로 유지 됩니다. 반환이 0 이면 대화 상자를 해제 하는 대화 상자 프로시저입니다. 다른 0이 아닌 반환 값 현재 예약 되어 있으므로 사용 하지 않아야 합니다.

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

WM_NOTIFYCDN_FOLDERCHANGE 메시지를 처리 하려면이 함수를 재정의 합니다.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>설명

Open 또는 다른 이름으로 저장 대화 상자에서 새 폴더를 열 때 알림 메시지가 전송 됩니다.

OFN_EXPLORER 스타일을 사용 하 여 대화 상자를 만든 경우에 알림이 전송 됩니다. 알림에 대 한 자세한 내용은 참조 하세요. [CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange)합니다. OFN_EXPLORER 스타일에 대 한 내용은 참조는 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) 구조 및 [열기 및 저장으로 대화 상자](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)합니다.

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

WM_NOTIFY CDN_INITDONE 메시지를 처리 하려면이 함수를 재정의 합니다.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>설명

시스템은 시스템에서 컨트롤 정렬 끝나면이 알림 메시지를 보냅니다 합니다 **엽니다** 또는 **다른 이름으로 저장** 자식 대화 상자의 컨트롤에 대 한 공간을 만들기 위해 대화 상자.

시스템은 OFN_EXPLORER 스타일을 사용 하 여 대화 상자를 만든 경우에이 보냅니다. 알림에 대 한 자세한 내용은 참조 하세요. [CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone)합니다. OFN_EXPLORER 스타일에 대 한 내용은 참조는 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) 구조 및 [열기 및 저장으로 대화 상자](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)합니다.

> [!NOTE]
> Windows Vista 또는 이후 스타일 파일 대화 상자에는이 함수를 지원 하지 않습니다. Windows Vista 또는 이후 스타일 파일 대화 상자에서이 함수를 사용 하는 동안 시킵니다 [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)합니다.

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

컨테이너 항목을 선택할 때 호출 됩니다.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목의 ID입니다.

### <a name="remarks"></a>설명

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

이 함수는 목록 상자에서 현재 선택 영역이 변경 될 때마다 호출 됩니다.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>매개 변수

*nIDBox*<br/>
목록 상자 또는 콤보 상자의 선택이 발생 한의 ID입니다.

*iCurSel*<br/>
현재 선택 항목의 인덱스입니다.

*nCode*<br/>
컨트롤 알림 코드입니다. 이 매개 변수는 다음 값 중 하나가 있어야 합니다.

- CD_LBSELCHANGE 지정 *iCurSel* 는 단일 선택 목록 상자에서 선택한 항목입니다.

- CD_LBSELSUB 지정 *iCurSel* 에서 다중 선택 목록 상자의 선택을 취소 합니다.

- CD_LBSELADD 형식임 *iCurSel* 에서 다중 선택 목록 상자에서를 선택 합니다.

- CD_LBSELNOITEMS에서 다중 선택 목록 상자에서 선택 영역이 없는 있는지를 지정 합니다.

### <a name="remarks"></a>설명

목록 상자에서 선택 항목이 변경의 사용자 지정 처리를 제공 하려면이 함수를 재정의 합니다. 예를 들어이 함수를 사용 하 여 액세스 권한을 표시 하려면 또는 날짜-마지막으로 수정한 각 파일의 사용자가 선택 합니다.

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

공유 위반의 사용자 지정 처리를 제공 하려면이 함수를 재정의 합니다.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>매개 변수

*lpszPathName*<br/>
공유 위반이 발생 한 파일의 경로입니다.

### <a name="return-value"></a>반환 값

다음 값 중 하나입니다.

- OFN_SHAREFALLTHROUGH 파일 대화 상자에서 반환 됩니다.

- OFN_SHARENOWARN 아니요 추가 작업을 수행 해야 합니다.

- OFN_SHAREWARN 사용자는이 오류에 대 한 표준 경고 메시지를 받습니다.

### <a name="remarks"></a>설명

일반적으로 공유 위반을 확인 하는 기본 제공 되는 프레임 워크 이므로 공유 위반이 발생 하는 경우 메시지 상자를 표시 합니다.이 함수를 사용할 필요가 없습니다.

공유 위반 검사가 사용 하지 않도록 설정 하려면 비트 OR 연산자를 사용 하 여 OFN_SHAREAWARE 플래그를 결합 된 `m_ofn.Flags`합니다.

##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange

WM_NOTIFYCDN_TYPECHANGE 메시지를 처리 하려면이 함수를 재정의 합니다.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>설명

알림 메시지의에서 파일 형식 목록에서 새 파일 형식 또는 이름으로 저장 대화 상자를 선택 하면 전송 됩니다.

OFN_EXPLORER 스타일을 사용 하 여 대화 상자를 만든 경우에 알림이 전송 됩니다. 알림에 대 한 자세한 내용은 참조 하세요. [CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange)합니다. OFN_EXPLORER 스타일에 대 한 내용은 참조는 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) 구조 및 [열기 및 저장으로 대화 상자](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)합니다.

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

대화 상자에서 컨테이너 컨트롤에서 항목을 제거합니다.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
항목을 제거 하려면 컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목의 ID입니다.

### <a name="remarks"></a>설명

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

대화 상자에서 확인 단추 (확인란)의 현재 상태를 설정합니다.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
확인란의 ID입니다.

*bChecked*<br/>
확인란의 상태입니다. TRUE 이면 확인 된; FALSE 선택 하지 않은 상태를 나타냅니다.

### <a name="remarks"></a>설명

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

대화 상자에 있는 컨테이너 컨트롤의 항목의 현재 상태를 설정 합니다.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목의 ID입니다.

*dwState*<br/>
하나 이상의 값 CDCONTROLSTATE 열거형에서 컨트롤의 새 상태를 나타내는입니다.

### <a name="remarks"></a>설명

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

컨트롤 항목의 텍스트를 설정합니다. 예를 들어, 라디오 단추 또는 메뉴의 항목을 함께 제공 되는 텍스트입니다.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
항목의 ID입니다.

*strLabel*<br/>
항목의 텍스트입니다.

### <a name="remarks"></a>설명

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

단추 텍스트는 편집 상자 레이블 등 컨트롤과 관련 된 텍스트를 설정 합니다.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨트롤의 ID입니다.

*strLabel*<br/>
컨트롤 이름입니다.

### <a name="remarks"></a>설명

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

현재 표시 여부를 설정 하 고 지정된 된 컨트롤의 상태를 사용 하도록 설정 합니다.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨트롤의 ID입니다.

*dwState*<br/>
하나 이상의 값 CDCONTROLSTATE 열거형에서 컨트롤의 현재 상태를 나타내는입니다.

### <a name="remarks"></a>설명

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

탐색기 스타일의 지정된 된 컨트롤에 대 한 텍스트를 설정 하려면이 메서드를 호출 **엽니다** 또는 **다른 이름으로 저장** 대화 상자.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>매개 변수

*nID*<br/>
[in] 텍스트를 설정 하는 컨트롤의 ID입니다.

*lpsz*<br/>
[in] 컨트롤에 대해 설정할 텍스트를 포함 하는 문자열에 대 한 포인터입니다.

### <a name="remarks"></a>설명

이 함수의 두 버전 모두 유니코드를 사용 하는 응용 프로그램에 적합 합니다. 그러나 LPCSTR 유형 사용 하 여 버전만 ANSI를 사용 하는 응용 프로그램에 유효 합니다.

이 메서드를 사용 하려면 OFN_EXPLORER 스타일으로 대화 상자를 만들어야 합니다. 그렇지 않으면 함수 어설션에서 실패 합니다.

##  <a name="setdefext"></a>  CFileDialog::SetDefExt

explorer-style Open 또는 다른 이름으로 저장 일반 대화 상자에 대 한 기본 파일 이름 확장명을 설정 하려면이 함수를 호출 합니다.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>매개 변수

*lpsz*<br/>
대화 상자 개체에 사용할 기본 확장명을 포함 하는 문자열에 대 한 포인터입니다. 이 문자열에 마침표 (.)를 포함할 수 없습니다.

### <a name="remarks"></a>설명

대화 상자는 OFN_EXPLORER 스타일을 사용 하 여 만들어야 합니다. 그렇지 않으면 함수 어설션에서 실패 합니다.

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

편집 상자 컨트롤에서 현재 텍스트를 설정합니다.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
입력란의 ID입니다.

*strText*<br/>
텍스트 값입니다.

### <a name="remarks"></a>설명

##  <a name="setproperties"></a>  CFileDialog::SetProperties

저장 중인 항목에 사용할 기본값을 정의하는 속성 저장소를 제공합니다.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>매개 변수

*lpszPropList*<br/>
";"으로 구분되는 미리 정의된 속성의 목록입니다. 플래그 목록은 참조 하세요. 합니다 **플래그** 부분 [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)합니다.

### <a name="remarks"></a>설명

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

옵션 단추 그룹 또는 대화 상자에 있는 콤보 상자에서 특정 항목의 선택된 상태를 설정 합니다.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
컨테이너 컨트롤의 ID입니다.

*dwIDItem*<br/>
사용자가 컨트롤에서 선택한 항목의 ID입니다.

### <a name="remarks"></a>설명

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

에 대 한 대화 상자 템플릿을 설정 합니다 [CFileDialog](../../mfc/reference/cfiledialog-class.md) 개체입니다.

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>매개 변수

*nWin3ID*<br/>
[in] 비-탐색기에 대 한 템플릿 리소스의 ID 번호를 포함 `CFileDialog` 개체입니다. 이 템플릿은 Windows NT 3.51 또는 OFN_EXPLORER 스타일 없을 경우에 사용 됩니다.

*nWin4ID*<br/>
[in] 탐색기에 대 한 템플릿 리소스의 ID 번호를 포함 `CFileDialog` 개체입니다. 이 템플릿은 OFN_EXPLORER 스타일에 있는 경우 또는 Windows NT 4.0, 버전, Windows 95 및 이상 버전 에서만 사용 됩니다.

*lpWin3ID*<br/>
[in] 비-탐색기에 대 한 템플릿 리소스의 이름을 포함 `CFileDialog` 개체입니다. 이 템플릿은 Windows NT 3.51 또는 OFN_EXPLORER 스타일 없을 경우에 사용 됩니다.

*lpWin4ID*<br/>
[in] 탐색기의 템플릿 리소스의 이름을 포함 `CFileDialog` 개체입니다. 이 템플릿은 OFN_EXPLORER 스타일에 있는 경우 또는 Windows NT 4.0, 버전, Windows 95 및 이상 버전 에서만 사용 됩니다.

### <a name="remarks"></a>설명

지정 된 템플릿 중 하나에 사용 됩니다. 시스템은 OFN_EXPLORER 스타일 및 응용 프로그램에서 실행 되는 운영 체제의 존재를 기준으로 사용할 템플릿을 결정 합니다. 비 탐색기 및 템플릿 탐색기 스타일을 지정 하 여 Windows NT 3.51, Windows NT 4.0 및 이상 버전 및 Windows 95 및 이상 버전을 지원 하기 쉽습니다.

> [!NOTE]
> Windows Vista 또는 이후 스타일 파일 대화 상자에는이 함수를 지원 하지 않습니다. Windows Vista 또는 이후 스타일 파일 대화 상자에서이 함수를 사용 하는 동안 시킵니다 [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)합니다. 대신은 사용자 지정된 대화 상자를 사용 하는 것입니다. 사용자 지정을 사용 하는 방법에 대 한 자세한 내용은 `CFileDialog`를 참조 하세요 [해 주는 IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)합니다.

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

대화 상자에서 visual 그룹을 선언합니다. 이 그룹에 해당 요소를 추가 하는 모든 "add" 메서드를 다시 호출 합니다.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>매개 변수

*dwIDCtl*<br/>
Visual 그룹의 ID입니다.

*strLabel*<br/>
그룹 이름입니다.

### <a name="remarks"></a>설명

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

업데이트를 `m_ofn` 의 데이터 구조는 [CFileDialog](../../mfc/reference/cfiledialog-class.md) 내부 개체의 현재 상태를 기반으로 합니다.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>설명

Windows Vista을 멤버 이전 Windows 버전에서 [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) 데이터 구조체의 상태를 사용 하 여 지속적으로 동기화 된는 `CFileDialog`합니다. 변경 된 [m_ofn](#m_ofn) 멤버 변수 대화 상자의 상태에 직접적인 영향을 받습니다. 또한 대화 상자 상태의 변경 내용을 즉시 m_ofn 멤버 변수를 업데이트합니다.

Windows Vista 이상 버전에서는 `m_ofn` 데이터 구조가 자동으로 업데이트 되지 않습니다. 에 있는 데이터의 정확성을 보장 하려면 합니다 `m_ofn` 를 호출 해야 멤버 변수를 `UpdateOFNFromShellDialog` 데이터에 액세스 하기 전에 함수입니다. Windows이 함수를 호출이 자동으로 처리 하는 동안 [IFileDialog::OnFileOK](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)합니다.

사용 하는 방법에 대 한 자세한 내용은 합니다 `CFileDialog` Windows Vista에서 클래스 또는 나중에 참조 [CFileDialog 클래스](../../mfc/reference/cfiledialog-class.md)합니다.

### <a name="example"></a>예제

이 예제에서는 업데이트 된 `CFileDialog` 표시 하기 전에 합니다. 업데이트 하기 전에 `m_ofn` 멤버 변수 대화 상자의 현재 상태를 동기화 하려고 합니다.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>참고자료

[CCommonDialog 클래스](../../mfc/reference/ccommondialog-class.md)<br/>
[계층 구조 차트](../../mfc/hierarchy-chart.md)
