---
title: 콜레컨트롤 클래스
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 54138955b0aa61a5e307c64825f3c74fa6f592b1
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753933"
---
# <a name="colecontrol-class"></a>콜레컨트롤 클래스

OLE 컨트롤을 개발할 수 있는 강력한 기본 클래스입니다.

## <a name="syntax"></a>구문

```
class COleControl : public CWnd
```

## <a name="members"></a>멤버

### <a name="public-constructors"></a>Public 생성자

|속성|Description|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|`COleControl` 개체를 만듭니다.|

### <a name="public-methods"></a>Public 메서드

|속성|Description|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|컨트롤의 현재 모양을 검색합니다.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|앰비언트 BackColor 속성의 값을 반환합니다.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|컨테이너에서 지정한 컨트롤 이름을 반환합니다.|
|[COleControl::AmbientFont](#ambientfont)|앰비언트 Font 속성의 값을 반환합니다.|
|[COleControl::AmbientForeColor](#ambientforecolor)|앰비언트 ForeColor 속성의 값을 반환합니다.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|컨테이너의 로캘 ID를 반환합니다.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|컨테이너에서 사용하는 단위 유형을 반환합니다.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|그랩 핸들을 표시할지 여부를 결정합니다.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|해칭을 표시할지 여부를 결정합니다.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|컨테이너에서 지정한 텍스트 정렬 유형을 반환합니다.|
|[COleControl::AmbientUIDead](#ambientuidead)|컨트롤이 사용자 인터페이스 작업에 응답해야 하는지 여부를 결정합니다.|
|[COleControl::AmbientUserMode](#ambientusermode)|컨테이너의 모드를 결정합니다.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|바인딩된 속성이 변경되었음을 컨테이너에 지정합니다.|
|[콜레 컨트롤::바운드속성요청편집](#boundpropertyrequestedit)|속성 값을 편집할 수 있는 권한을 요청합니다.|
|[COleControl::ClientToParent](#clienttoparent)|컨트롤의 원점을 기준으로 한 점을 컨테이너의 원점을 기준으로 한 점으로 변환합니다.|
|[COleControl::ClipCaretRect](#clipcaretrect)|컨트롤에 의해 겹치는 경우 케어트 사각형을 조정합니다.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|컨트롤에서 처리하는 니모닉 집합이 변경된 후 이 함수를 호출합니다.|
|[COleControl::DisplayError](#displayerror)|컨트롤의 사용자에게 스톡 오류 이벤트를 표시합니다.|
|[COleControl::DoClick](#doclick)|주식 `DoClick` 방법의 구현.|
|[COleControl::DoPropExchange](#dopropexchange)|개체의 속성을 직렬화합니다. `COleControl`|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Windows 컨트롤에서 하위 클래스가 된 OLE 컨트롤을 다시 그립니다.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|컨트롤에 대한 간단한 프레임 지원을 활성화합니다.|
|[COleControl::ExchangeExtent](#exchangeextent)|컨트롤의 너비와 높이를 직렬화합니다.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|컨트롤의 스톡 속성을 직렬화합니다.|
|[COleControl::ExchangeVersion](#exchangeversion)|컨트롤의 버전 번호를 직렬화합니다.|
|[COleControl::FireClick](#fireclick)|주식 `Click` 이벤트를 발생시면 됩니다.|
|[COleControl::FireDblClick](#firedblclick)|주식 `DblClick` 이벤트를 발생시면 됩니다.|
|[COleControl::FireError](#fireerror)|주식 `Error` 이벤트를 발생시면 됩니다.|
|[COleControl::FireEvent](#fireevent)|사용자 지정 이벤트를 발생시면 됩니다.|
|[COleControl::FireKeyDown](#firekeydown)|주식 `KeyDown` 이벤트를 발생시면 됩니다.|
|[COleControl::FireKeyPress](#firekeypress)|주식 `KeyPress` 이벤트를 발생시면 됩니다.|
|[COleControl::FireKeyUp](#firekeyup)|주식 `KeyUp` 이벤트를 발생시면 됩니다.|
|[COleControl::FireMouseDown](#firemousedown)|주식 `MouseDown` 이벤트를 발생시면 됩니다.|
|[COleControl::FireMouseMove](#firemousemove)|주식 `MouseMove` 이벤트를 발생시면 됩니다.|
|[COleControl::FireMouseUp](#firemouseup)|주식 `MouseUp` 이벤트를 발생시면 됩니다.|
|[콜레 컨트롤::화재 준비 상태변경](#firereadystatechange)|컨트롤의 준비 상태가 변경되면 이벤트를 발생시입니다.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|인터페이스를 지원하는 컨트롤의 기본 활성화 `IPointerInactive` 동작을 변경합니다.|
|[COleControl::GetAmbientProperty](#getambientproperty)|지정된 앰비언트 속성의 값을 반환합니다.|
|[COleControl::GetAppearance](#getappearance)|주식 모양 속성의 값을 반환합니다.|
|[콜레 컨트롤 :: 겟백 컬러](#getbackcolor)|주식 BackColor 속성의 값을 반환합니다.|
|[COleControl::GetBorderStyle](#getborderstyle)|주식 BorderStyle 속성의 값을 반환합니다.|
|[COleControl::GetCapture](#getcapture)|창없는 활성화된 컨트롤 개체에 마우스 캡처가 있는지 여부를 결정합니다.|
|[COleControl::GetClassID](#getclassid)|컨트롤의 OLE 클래스 ID를 검색합니다.|
|[COleControl::GetClientOffset](#getclientoffset)|컨트롤의 직사각형 영역의 왼쪽 위 모서리와 클라이언트 영역의 왼쪽 위 모서리 간의 차이를 검색합니다.|
|[COleControl::GetClientRect](#getclientrect)|컨트롤의 클라이언트 영역 크기를 검색합니다.|
|[COle Control::GetClientSite](#getclientsite)|컨테이너 내의 현재 클라이언트 사이트에 대한 포인터에 대한 개체를 쿼리합니다.|
|[COleControl::GetControlFlags](#getcontrolflags)|컨트롤 플래그 설정을 검색합니다.|
|[COleControl::GetControlSize](#getcontrolsize)|OLE 컨트롤의 위치와 크기를 반환합니다.|
|[COleControl::GetDC](#getdc)|창 없는 컨트롤이 해당 컨테이너에서 장치 컨텍스트를 가져오기 위한 수단을 제공합니다.|
|[COleControl::GetEnabled](#getenabled)|주식 사용 속성의 값을 반환합니다.|
|[COle 제어::GetExtendedControl](#getextendedcontrol)|컨테이너에 속하는 확장 컨트롤 개체에 대한 포인터를 검색합니다.|
|[COleControl::GetFocus](#getfocus)|컨트롤에 포커스가 있는지 여부를 결정합니다.|
|[COleControl::GetFont](#getfont)|스톡 Font 속성의 값을 반환합니다.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|개체의 메트릭을 `CFontHolder` 반환합니다.|
|[COleControl::GetForeColor](#getforecolor)|주식 ForeColor 속성의 값을 반환합니다.|
|[COleControl::GetHwnd](#gethwnd)|주식 hWnd 속성의 값을 반환합니다.|
|[COleControl::GetMessageString](#getmessagestring)|메뉴 항목에 대한 상태 표시줄 텍스트를 제공합니다.|
|[COleControl::GetNotSupported](#getnotsupported)|사용자가 컨트롤의 속성 값에 액세스할 수 없도록 합니다.|
|[COleControl::GetReadyState](#getreadystate)|컨트롤의 준비 상태를 반환합니다.|
|[COleControl::GetRectInContainer](#getrectincontainer)|해당 컨테이너를 기준으로 컨트롤의 사각형을 반환합니다.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|스톡 Font 속성의 메트릭을 반환합니다.|
|[COleControl::GetText](#gettext)|주식 텍스트 또는 캡션 속성의 값을 반환합니다.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|창 없는 컨트롤이 끌어서 놓기 작업의 대상이 되도록 재정의합니다.|
|[COleControl::InitializeIIDs](#initializeiids)|컨트롤이 사용할 IID의 기본 클래스를 알립니다.|
|[COleControl::InternalGetFont](#internalgetfont)|스톡 `CFontHolder` Font 속성에 대한 개체를 반환합니다.|
|[COleControl::InternalGetText](#internalgettext)|스톡 캡션 또는 텍스트 속성을 검색합니다.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|컨트롤의 준비 상태를 설정하고 준비 상태 변경 이벤트를 발생시면 됩니다.|
|[COleControl::InvalidateControl](#invalidatecontrol)|표시된 컨트롤의 영역을 무효화하여 다시 그려집니다.|
|[COleControl::InvalidateRgn](#invalidatergn)|지정된 지역 내의 컨테이너 창의 클라이언트 영역을 무효화합니다. 영역에서 창 없는 컨트롤을 다시 그리는 데 사용할 수 있습니다.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|OLE 컨트롤을 특수로 로드할 수 있습니다.|
|[COleControl::IsModified](#ismodified)|제어 상태가 변경되었는지 여부를 확인합니다.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|컨테이너가 현재 도면 작업에 최적화된 도면을 지원하는지 여부를 나타냅니다.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|컨트롤이 Windows 컨트롤을 하위 클래스로 지정하는지 여부를 확인하기 위해 호출됩니다.|
|[COleControl::Load](#load)|이전 비동기 데이터를 재설정하고 컨트롤의 비동기 속성에 대한 새 로드를 시작합니다.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|컨테이너에서 컨트롤을 비활성화할 수 있는지 여부를 결정합니다.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|앰비언트 속성이 변경될 때 호출됩니다.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|주식 모양 속성이 변경 될 때 호출 됩니다.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|스톡 BackColor 속성이 변경될 때 호출됩니다.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|스톡 BorderStyle 속성이 변경될 때 호출됩니다.|
|[COleControl::OnClick](#onclick)|스톡 클릭 이벤트를 발생시키기 위해 호출됩니다.|
|[COleControl::OnClose](#onclose)|호출된 컨트롤에 `IOleControl::Close` 대해 지정합니다.|
|[COleControl::OnDoVerb](#ondoverb)|컨트롤 동사가 실행된 후 호출됩니다.|
|[콜레 컨트롤::에 그리기](#ondraw)|컨트롤자체를 다시 그려달라고 요청했을 때 호출됩니다.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|메타파일 장치 컨텍스트를 사용하여 자신을 다시 그릴 수 있도록 컨트롤이 요청될 때 컨테이너에서 호출합니다.|
|[콜레 컨트롤::온에더트](#onedit)|UI에 컨테이너에 의해 호출 OLE 컨트롤을 활성화 합니다.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|주식 사용 속성이 변경될 때 호출됩니다.|
|[콜레 컨트롤::오네눔베브](#onenumverbs)|컨트롤의 동사를 등록하기 위해 컨테이너에서 호출합니다.|
|[COleControl::OnEventAdvise](#oneventadvise)|이벤트 처리기가 컨트롤에서 연결되거나 연결이 끊어지는 경우 호출됩니다.|
|[콜레 컨트롤::온폰트 변경](#onfontchanged)|스톡 Font 속성이 변경될 때 호출됩니다.|
|[콜레 컨트롤::에포컬러 변경](#onforecolorchanged)|주식 ForeColor 속성이 변경 될 때 호출 됩니다.|
|[콜레 컨트롤:::온프리즈 이벤트](#onfreezeevents)|컨트롤의 이벤트가 고정되거나 고정해제될 때 호출됩니다.|
|[콜레 컨트롤::온겟컬러세트](#ongetcolorset)|호출된 컨트롤에 `IOleObject::GetColorSet` 대해 지정합니다.|
|[콜레 컨트롤::온겟컨트롤정보](#ongetcontrolinfo)|용기에 암기 정보를 제공합니다.|
|[콜레 컨트롤::온겟디스플레이 스트링](#ongetdisplaystring)|속성 값을 나타내는 문자열을 얻기 위해 호출됩니다.|
|[콜레 컨트롤::온겟인플레이스메뉴](#ongetinplacemenu)|컨테이너 메뉴와 병합될 컨트롤 메뉴의 핸들을 요청합니다.|
|[콜레 컨트롤::온겟내추럴익스](#ongetnaturalextent)|재정의하여 제안된 크기 및 익스텐트 모드에 가장 가까운 컨트롤의 표시 크기를 검색합니다.|
|[COle Control::OnGet사전정의된 스트링](#ongetpredefinedstrings)|속성에 대 한 가능한 값을 나타내는 문자열을 반환 합니다.|
|[COle Control::OnGetPredefined값](#ongetpredefinedvalue)|미리 정의된 문자열에 해당하는 값을 반환합니다.|
|[콜레 컨트롤::온겟뷰익](#ongetviewextent)|재정의를 사용하여 컨트롤의 표시 영역 크기를 검색할 수 있습니다(2패스 드로잉을 활성화하는 데 사용할 수 있음).|
|[콜레 컨트롤::온겟뷰렉트](#ongetviewrect)|컨트롤의 크기를 특정 위치에서 시작하는 사각형으로 변환하려면 재정의합니다.|
|[콜레 컨트롤::온겟뷰상태](#ongetviewstatus)|재정의하여 컨트롤의 뷰 상태를 검색합니다.|
|[콜레 컨트롤::온하이드툴바](#onhidetoolbars)|컨트롤이 UI비활성화될 때 컨테이너에서 호출됩니다.|
|[콜레 컨트롤::에니액티브마우스무브](#oninactivemousemove)|마우스 포인터 에서 비활성 컨트롤에 대 한 컨테이너를 컨트롤에 WM_MOUSEMOVE 메시지를 디스패치 하도록 재정의 합니다.|
|[콜레 컨트롤::에온액티브셋세트커서](#oninactivesetcursor)|마우스 포인터 에서 비활성 컨트롤에 대 한 컨테이너를 컨트롤에 WM_SETCURSOR 메시지를 디스패치 하도록 재정의 합니다.|
|[콜레 컨트롤::온키다운 이벤트](#onkeydownevent)|주식 KeyDown 이벤트가 발생한 후 호출됩니다.|
|[콜레 컨트롤::온키프레스이벤트](#onkeypressevent)|주식 키 프레스 이벤트가 발생한 후 호출됩니다.|
|[콜레 컨트롤::온키업 이벤트](#onkeyupevent)|주식 KeyUp 이벤트가 발생한 후 호출됩니다.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|속성 편집에 사용할 속성 페이지를 나타냅니다.|
|[콜레 컨트롤::온네모닉](#onmnemonic)|컨트롤의 암수 키를 누를 때 호출됩니다.|
|[COleControl::OnProperties](#onproperties)|컨트롤의 "속성" 동사가 호출되었을 때 호출됩니다.|
|[콜레 컨트롤::온쿼리히트포인트](#onqueryhitpoint)|컨트롤의 표시가 지정된 점과 겹치는지 여부를 쿼리하기 위해 재정의합니다.|
|[콜레 컨트롤::온쿼리히트렉트](#onqueryhitrect)|컨트롤의 표시가 지정된 사각형의 모든 점과 겹치는지 여부를 쿼리하기 위해 재정의합니다.|
|[콜레 컨트롤::온렌더 데이터](#onrenderdata)|지정된 형식으로 데이터를 검색하는 프레임워크에서 호출됩니다.|
|[콜레 컨트롤::온렌더파일데이터](#onrenderfiledata)|지정된 형식의 파일에서 데이터를 검색하기 위해 프레임워크에서 호출됩니다.|
|[콜레 컨트롤::온렌더글로벌데이터](#onrenderglobaldata)|지정된 형식으로 전역 메모리에서 데이터를 검색하는 프레임워크에서 호출됩니다.|
|[콜레 컨트롤::온리셋스테이트](#onresetstate)|컨트롤의 속성을 기본값으로 다시 설정합니다.|
|[콜레 컨트롤::온셋클라이언트사이트](#onsetclientsite)|호출된 컨트롤에 `IOleControl::SetClientSite` 대해 지정합니다.|
|[콜레 컨트롤::온셋 데이터](#onsetdata)|컨트롤의 데이터를 다른 값으로 바꿉습니다.|
|[콜레 컨트롤::온셋익](#onsetextent)|컨트롤의 범위가 변경된 후 호출됩니다.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|컨트롤의 치수가 변경된 후 호출됩니다.|
|[콜레 컨트롤::온쇼툴바](#onshowtoolbars)|컨트롤이 UI가 활성화되었을 때 호출됩니다.|
|[콜레 컨트롤:::온텍스트 변경](#ontextchanged)|스톡 텍스트 또는 캡션 속성이 변경될 때 호출됩니다.|
|[콜레 컨트롤::온윈도우리스메시지](#onwindowlessmessage)|창 없는 컨트롤에 대 한 창 메시지(마우스 및 키보드 메시지 제외)를 처리 합니다.|
|[콜레컨트롤::P렌트토클라이언트](#parenttoclient)|컨테이너의 원점을 기준으로 한 점을 컨트롤의 원점을 기준으로 한 점으로 변환합니다.|
|[콜레컨트롤::P모달디아로그](#postmodaldialog)|모달 대화 상자가 닫혔다는 것을 컨테이너에 알게 합니다.|
|[콜레컨트롤::P레모달디아로그](#premodaldialog)|모달 대화 상자가 표시될 컨테이너에 알신합니다.|
|[콜레 컨트롤::다시 생성 제어 창](#recreatecontrolwindow)|컨트롤의 창을 삭제하고 다시 만듭니다.|
|[콜레 컨트롤::새로 고침](#refresh)|컨트롤의 모양을 다시 그립니다.|
|[COleControl::ReleaseCapture](#releasecapture)|마우스 캡처를 해제합니다.|
|[콜레 컨트롤::릴리스DC](#releasedc)|창 없는 컨트롤의 컨테이너의 표시 장치 컨텍스트를 해제 합니다.|
|[콜레 컨트롤:::리부모 컨트롤윈도우](#reparentcontrolwindow)|컨트롤 창의 상위를 다시 설정합니다.|
|[콜레 컨트롤::리셋스톡프롭스](#resetstockprops)|`COleControl` 주식 속성을 기본값으로 초기화합니다.|
|[COle Control::재설정](#resetversion)|버전 번호를 지정된 값으로 초기화합니다.|
|[콜레 컨트롤::스크롤 창](#scrollwindow)|창 없는 컨트롤이 디스플레이의 내부 활성 이미지 내의 영역을 스크롤할 수 있도록 합니다.|
|[콜레 컨트롤::선택글꼴 개체](#selectfontobject)|사용자 지정 Font 속성을 장치 컨텍스트로 선택합니다.|
|[콜레 컨트롤::셀렉트스톡폰트](#selectstockfont)|장치 컨텍스트로 스톡 Font 속성을 선택합니다.|
|[COleControl::직렬화익](#serializeextent)|컨트롤의 표시 공간을 직렬화하거나 초기화합니다.|
|[COleControl::직렬화스톡프롭스](#serializestockprops)|`COleControl` 스톡 속성을 직렬화하거나 초기화합니다.|
|[COle Control::직렬화반전](#serializeversion)|컨트롤의 버전 정보를 일렬화하거나 초기화합니다.|
|[콜레 컨트롤 :: 세트 모양](#setappearance)|주식 모양 속성의 값을 설정합니다.|
|[콜레 컨트롤 ::세트 백 컬러](#setbackcolor)|주식 BackColor 속성의 값을 설정합니다.|
|[콜레 컨트롤:::세트보더스타일](#setborderstyle)|주식 BorderStyle 속성의 값을 설정합니다.|
|[콜레 컨트롤::세트캡처](#setcapture)|컨트롤의 컨테이너 창이 컨트롤을 대신하여 마우스 캡처를 소유하게 합니다.|
|[콜레 컨트롤::세트 컨트롤크기](#setcontrolsize)|OLE 컨트롤의 위치와 크기를 설정합니다.|
|[COleControl::SetEnabled](#setenabled)|주식 사용 속성의 값을 설정합니다.|
|[콜레 컨트롤::설정 포커스](#setfocus)|컨트롤의 컨테이너 창이 컨트롤을 대신하여 입력 포커스를 소유하게 합니다.|
|[콜레 컨트롤::세트폰트](#setfont)|스톡 Font 속성의 값을 설정합니다.|
|[콜레 컨트롤 ::세트 포어 컬러](#setforecolor)|주식 ForeColor 속성의 값을 설정합니다.|
|[콜레 컨트롤::세트초기크기](#setinitialsize)|컨테이너에 처음 표시될 때 OLE 컨트롤의 크기를 설정합니다.|
|[콜레 컨트롤::세트수정 플래그](#setmodifiedflag)|컨트롤의 수정된 상태를 변경합니다.|
|[콜레 컨트롤::설정금지 허용](#setnotpermitted)|편집 요청이 실패했음을 나타냅니다.|
|[COle Control::SetNot지원](#setnotsupported)|사용자가 컨트롤의 속성 값을 수정하지 못하도록 합니다.|
|[COleControl::SetRectInContainer](#setrectincontainer)|컨트롤의 사각형을 해당 컨테이너를 기준으로 설정합니다.|
|[콜레 컨트롤::SetText](#settext)|주식 텍스트 또는 캡션 속성의 값을 설정합니다.|
|[COle 제어::throwError](#throwerror)|OLE 컨트롤에서 오류가 발생했음을 나타냅니다.|
|[COleControl::TransformCoords](#transformcoords)|컨테이너와 컨트롤 간의 좌표 값을 변환합니다.|
|[콜레 컨트롤::번역색상](#translatecolor)|OLE_COLOR 값을 COLORREF 값으로 변환합니다.|
|[COle Control::윌앰비언트유효로드 중](#willambientsbevalidduringload)|다음에 컨트롤을 로드할 때 앰비언트 속성을 사용할 수 있는지 여부를 결정합니다.|
|[콜레 컨트롤 ::창 프로크](#windowproc)|`COleControl` 개체에 대한 Windows 프로시저를 제공합니다.|

### <a name="protected-methods"></a>Protected 메서드

|속성|Description|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|컨트롤의 모양을 업데이트해야 하는 경우 프레임워크에서 호출합니다.|
|[COleControl::DrawMetafile](#drawmetafile)|메타파일 장치 컨텍스트가 사용 중일 때 프레임워크에서 호출됩니다.|
|[콜레 컨트롤:::이인보크허용](#isinvokeallowed)|자동화 메서드 호출을 활성화합니다.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|컨트롤에서 지원하는 데이터 형식 목록을 초기화하기 위해 프레임워크에서 호출합니다.|

## <a name="remarks"></a>설명

에서 `CWnd`파생 된 이 클래스는 Windows 창 개체의 모든 기능과 이벤트 발생 및 메서드 및 속성을 지원하는 기능과 같은 OLE와 관련된 추가 기능을 상속합니다.

OLE 컨트롤은 OLE 컨테이너 응용 프로그램에 삽입하고 이벤트 발생의 양방향 시스템을 사용하여 컨테이너와 통신할 수 있으며 컨테이너에 메서드 및 특성을 노출할 수 있습니다. 표준 OLE 컨테이너는 OLE 컨트롤의 기본 기능만 지원합니다. OLE 컨트롤의 확장된 기능을 지원할 수 없습니다. 이벤트 발생은 컨트롤에서 수행되는 특정 작업의 결과로 이벤트가 컨테이너로 전송될 때 발생합니다. 차례로 컨테이너는 C++ 클래스의 멤버 함수 및 데이터 멤버와 유사한 노출된 메서드 및 속성 집합을 사용하여 컨트롤과 통신합니다. 이 방법을 사용하면 개발자가 컨트롤의 모양을 제어하고 특정 작업이 발생할 때 컨테이너에 알릴 수 있습니다.

## <a name="windowless-controls"></a>창 없는 컨트롤

OLE 컨트롤은 창 없이 활성화된 상태로 사용할 수 있습니다. 창 없는 컨트롤에는 다음과 같은 상당한 이점이 있습니다.

- 창 없는 컨트롤은 투명하고 직사각형이 될 수 있습니다.

- Windowless 컨트롤은 개체의 인스턴스 크기 및 생성 시간을 줄입니다.

컨트롤에는 창이 필요하지 않습니다. 창이 제공하는 서비스는 단일 공유 창(일반적으로 컨테이너)과 약간의 디스패치 코드를 통해 쉽게 제공할 수 있습니다. 창을 갖는 것은 주로 개체에 불필요한 합병증입니다.

창 없는 활성화를 사용 하는 경우 컨테이너 (창이) 컨트롤의 자체 창에 의해 제공 된 서비스를 제공 하는 책임 입니다. 예를 들어 컨트롤이 키보드 포커스를 쿼리하거나 마우스 캡처를 쿼리하거나 장치 컨텍스트를 가져와야 하는 경우 이러한 작업은 컨테이너에서 관리합니다. `COleControl` 창 없는 작업 멤버 함수는 컨테이너에서 이러한 작업을 호출합니다.

창 없는 활성화가 활성화되면 컨테이너는 입력 메시지를 컨트롤의 `IOleInPlaceObjectWindowless` 인터페이스(창 없는 지원을 위한 [IOleInPlaceObject의](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) 확장)에 위임합니다. `COleControl`이 인터페이스의 구현은 마우스 좌표를 적절하게 조정한 후 컨트롤의 메시지 맵을 통해 이러한 메시지를 전달합니다. 메시지 맵에 해당 항목을 추가하여 일반 창 메시지와 같은 이러한 메시지를 처리할 수 있습니다.

창 없는 컨트롤에서는 항상 해당 `COleControl` `CWnd` 멤버 함수 또는 해당 Windows API 함수 대신 멤버 함수를 사용 해야 합니다.

OLE 제어 개체는 활성화될 때만 창을 만들 수 있지만 비활성 전환에 필요한 작업량이 늘어나고 전환 속도가 느러집니다. 이 문제가 있는 경우가 있습니다: 예를 들어 텍스트 상자의 격자를 고려하십시오. 열을 통해 위아래로 커서할 때 각 컨트롤은 활성화된 다음 비활성화해야 합니다. 비활성/활성 전환 속도는 스크롤 속도에 직접적인 영향을 미칩니다.

OLE 제어 프레임워크 개발에 대한 자세한 내용은 [MFC ActiveX 컨트롤](../../mfc/mfc-activex-controls.md) 및 [개요: MFC ActiveX 제어 프로그램 만들기](../../mfc/reference/mfc-activex-control-wizard.md)문서를 참조하십시오. 창 없는 컨트롤과 깜박임 없는 컨트롤을 포함하여 OLE 컨트롤 최적화에 대한 자세한 내용은 [MFC ActiveX 컨트롤: 최적화를](../../mfc/mfc-activex-controls-optimization.md)참조하십시오.

## <a name="inheritance-hierarchy"></a>상속 계층 구조

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>요구 사항

**헤더:** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>콜레 컨트롤::앰비언트백컬러

앰비언트 BackColor 속성의 값을 반환합니다.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Return Value

컨테이너의 주변 BackColor 속성(있는 경우)의 현재 값입니다. 속성이 지원되지 않는 경우 이 함수는 시스템 정의 Windows 배경 색을 반환합니다.

### <a name="remarks"></a>설명

앰비언트 BackColor 속성은 모든 컨트롤에서 사용할 수 있으며 컨테이너에 의해 정의됩니다. 컨테이너는 이 속성을 지원할 필요가 없습니다.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>콜레 컨트롤::앰비언트디스플레이네임

컨테이너가 컨트롤에 할당한 이름은 사용자에게 표시되는 오류 메시지에 사용할 수 있습니다.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Return Value

OLE 컨트롤의 이름입니다. 기본값은 길이가 0 인 문자열입니다.

### <a name="remarks"></a>설명

컨테이너는 이 속성을 지원할 필요가 없습니다.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>콜레 컨트롤::앰비언트폰트

앰비언트 Font 속성의 값을 반환합니다.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Return Value

컨테이너의 주변 글꼴 디스패치 인터페이스에 대한 포인터입니다. 기본값은 NULL입니다. 반환이 NULL과 같지 않은 경우 [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) 멤버 함수를 호출하여 글꼴을 해제할 책임이 있습니다.

### <a name="remarks"></a>설명

앰비언트 Font 속성은 컨테이너에 의해 정의되며 모든 컨트롤에서 사용할 수 있습니다. 컨테이너는 이 속성을 지원할 필요가 없습니다.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>콜레 컨트롤::앰비언트포어컬러

앰비언트 ForeColor 속성의 값을 반환합니다.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Return Value

컨테이너의 주변 ForeColor 속성(있는 경우)의 현재 값입니다. 지원되지 않는 경우 이 함수는 시스템 정의 Windows 텍스트 색상을 반환합니다.

### <a name="remarks"></a>설명

앰비언트 ForeColor 속성은 모든 컨트롤에서 사용할 수 있으며 컨테이너에 의해 정의됩니다. 컨테이너는 이 속성을 지원할 필요가 없습니다.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>콜레 컨트롤::앰비언트로컬아이드

컨테이너의 로캘 ID를 반환합니다.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Return Value

컨테이너의 LocaleID 속성(있는 경우)의 값입니다. 이 속성이 지원되지 않으면 이 함수는 0을 반환합니다.

### <a name="remarks"></a>설명

컨트롤은 LocaleID를 사용하여 특정 로캘에 대한 사용자 인터페이스를 조정할 수 있습니다. 컨테이너는 이 속성을 지원할 필요가 없습니다.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>콜레 컨트롤::주변 모습

컨트롤 개체에 대한 현재 모양 설정을 검색합니다.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Return Value

컨트롤의 모양:

- **0** 평평한 외관

- **1** 3D 모양

### <a name="remarks"></a>설명

이 함수를 호출하여 컨트롤에 대한 DISPID_AMBIENT_APPEARANCE 속성의 현재 값을 검색합니다.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>콜레 컨트롤::앰비언트 스케일유닛

컨테이너에서 사용하는 단위 유형을 반환합니다.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Return Value

컨테이너의 주변 스케일단위를 포함하는 문자열입니다. 이 속성이 지원되지 않는 경우 이 함수는 길이 가 0문자열을 반환합니다.

### <a name="remarks"></a>설명

컨테이너의 주변 ScaleUnits 속성은 트윕 또는 센티미터와 같이 선택한 단위로 레이블이 지정된 위치 또는 치수를 표시하는 데 사용할 수 있습니다. 컨테이너는 이 속성을 지원할 필요가 없습니다.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>콜레 컨트롤::앰비언트쇼그랩핸들

컨테이너가 활성화될 때 컨트롤이 그랩 핸들을 자체적으로 표시할 수 있는지 여부를 결정합니다.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Return Value

그랩 핸들이 표시되어야 하는 경우 0이 아닙니다. 그렇지 않으면 0. 이 속성이 지원되지 않으면 이 함수는 0이 아닌 함수를 반환합니다.

### <a name="remarks"></a>설명

컨테이너는 이 속성을 지원할 필요가 없습니다.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>콜레 컨트롤::앰비언트쇼해칭

UI가 활성화될 때 컨테이너가 해치된 패턴으로 자신을 표시할 수 있는지 여부를 결정합니다.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Return Value

해치된 패턴을 표시해야 하는 경우 0이 아닙니다. 그렇지 않으면 0. 이 속성이 지원되지 않으면 이 함수는 0이 아닌 함수를 반환합니다.

### <a name="remarks"></a>설명

컨테이너는 이 속성을 지원할 필요가 없습니다.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>콜레 컨트롤::앰비언트텍스트정렬

컨트롤 컨테이너에서 선호하는 주변 텍스트 정렬을 결정합니다.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Return Value

컨테이너의 주변 TextAlign 속성의 상태입니다. 이 속성이 지원되지 않으면 이 함수는 0을 반환합니다.

다음은 유효한 반환 값 목록입니다.

|반환 값|의미|
|------------------|-------------|
|0|일반 맞춤(오른쪽의 숫자, 왼쪽텍스트).|
|1|왼쪽 정당화|
|2|중심|
|3|오른쪽 정당화|

### <a name="remarks"></a>설명

이 속성은 포함된 모든 컨트롤에서 사용할 수 있으며 컨테이너에 의해 정의됩니다. 컨테이너는 이 속성을 지원할 필요가 없습니다.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>콜레 컨트롤::앰비언트UI데드

컨테이너가 컨트롤이 사용자 인터페이스 작업에 응답하도록 할지 여부를 결정합니다.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Return Value

컨트롤이 사용자 인터페이스 작업에 응답해야 하는 경우 0이 아닙니다. 그렇지 않으면 0. 이 속성이 지원되지 않으면 이 함수는 0을 반환합니다.

### <a name="remarks"></a>설명

예를 들어 컨테이너는 디자인 모드에서 이를 TRUE로 설정할 수 있습니다.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>콜레 컨트롤::앰비언트유저 모드

컨테이너가 디자인 모드 또는 사용자 모드에 있는지 확인합니다.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Return Value

컨테이너가 사용자 모드에 있는 경우 0이 아닙니다. 그렇지 않으면 0(디자인 모드에서). 이 속성이 지원되지 않으면 이 함수는 TRUE를 반환합니다.

### <a name="remarks"></a>설명

예를 들어 컨테이너는 디자인 모드에서 이를 FALSE로 설정할 수 있습니다.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>콜레 컨트롤::바운드속성 변경

바인딩된 속성 값이 변경되었음을 나타냅니다.

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>매개 변수

*디스피드 (것)들*<br/>
컨트롤의 바인딩된 속성의 디스패치 ID입니다.

### <a name="remarks"></a>설명

속성 Set 메서드를 통해 변경되지 않은 경우에도 속성 값이 변경될 때마다 이 값을 호출해야 합니다. 특히 멤버 변수에 매핑되는 바인딩된 속성을 알고 있어야 합니다. 이러한 멤버 변수가 변경될 `BoundPropertyChanged` 때마다 호출해야 합니다.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>콜레 컨트롤::바운드속성요청편집

`IPropertyNotifySink` 인터페이스에서 컨트롤에서 제공하는 바인딩된 속성 값을 변경하려면 권한을 요청합니다.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>매개 변수

*디스피드 (것)들*<br/>
컨트롤의 바인딩된 속성의 디스패치 ID입니다.

### <a name="return-value"></a>Return Value

변경이 허용되는 경우 0이 아닙니다. 그렇지 않으면 0. 기본값은 0이 아닙니다.

### <a name="remarks"></a>설명

사용 권한이 거부되면 컨트롤에서 속성 값을 변경하지 않아야 합니다. 이 작업은 속성 값을 변경하려고 시도한 작업을 무시하거나 실패하여 수행할 수 있습니다.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>콜레 컨트롤::클라이언트토부모

*pPoint의* 좌표를 상위 좌표로 변환합니다.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>매개 변수

*lprcBounds*<br/>
컨테이너 내의 OLE 컨트롤 경계에 대한 포인터입니다. 클라이언트 영역이 아니라 테두리와 스크롤 막대를 포함한 전체 컨트롤 영역입니다.

*pPoint*<br/>
OLE 클라이언트 영역을 가리키는 포인터는 부모(컨테이너)의 좌표로 변환됩니다.

### <a name="remarks"></a>설명

입력 *pPoint는* OLE 컨트롤의 클라이언트 영역의 원점을 기준으로 합니다(컨트롤의 클라이언트 영역의 왼쪽 위 모서리). 출력 *pPoint는* 상위의 원점(컨테이너의 왼쪽 위 모서리)을 기준으로 합니다.

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>콜레 컨트롤::클립케어렉트

캐러티 사각형이 겹치는 불투명 한 개체에 의해 완전히 또는 부분적으로 덮여 있는 경우 조정 합니다.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*Lprect*<br/>
입력시 조정할 캐류 영역을 포함하는 [RECT](/windows/win32/api/windef/ns-windef-rect) 구조에 대한 포인터입니다. 출력시, 조정된 캐리트 영역 또는 CARET 사각형이 완전히 덮여 있는 경우 NULL.

### <a name="return-value"></a>Return Value

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

캐터는 일반적으로 텍스트 또는 그래픽이 삽입될 위치를 나타내는 깜박이는 선, 블록 또는 비트맵입니다.

창없는 개체는 먼저 캐리트가 겹치는 개체에 의해 부분적으로 또는 완전히 숨겨져 있는지 여부를 확인하지 않고는 캐리터를 안전하게 표시할 수 없습니다. 이를 가능하게 하기 위해 개체는 `ClipCaretRect` 캐릿을 조정(감소)하여 클리핑 영역에 맞는지 확인하는 데 사용할 수 있습니다.

캐리트 생성 객체는 캐리트 사각형을 `ClipCaretRect` 제출하고 조정된 사각형을 사용하여 카를트에 사용해야 합니다. 카포트가 완전히 숨겨져 있으면이 메서드는 FALSE를 반환하고 이 경우 카를트는 전혀 표시되지 않아야합니다.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>콜레 제어 ::콜레 제어

`COleControl` 개체를 생성합니다.

```
COleControl();
```

### <a name="remarks"></a>설명

이 함수는 일반적으로 직접 호출되지 않습니다. 대신 OLE 컨트롤은 일반적으로 클래스 팩터리에서 만들어집니다.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>콜레 컨트롤::제어정보 변경

컨트롤에서 지원하는 니모닉 집합이 변경되면 이 함수를 호출합니다.

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>설명

이 알림을 받으면 컨트롤의 컨테이너는 [IOleControl::GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)로 호출하여 새로운 니모닉 집합을 가져옵니다. 컨테이너는 이 알림에 응답할 필요가 없습니다.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>콜레컨트롤::Display오류

stock Error 이벤트가 처리된 후 프레임워크에서 호출합니다(이벤트 처리기가 오류 표시를 억제하지 않는 한).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>매개 변수

*Scode*<br/>
보고할 상태 코드 값입니다. 가능한 코드의 전체 목록은 [ActiveX 컨트롤: 고급 항목](../../mfc/mfc-activex-controls-advanced-topics.md)문서를 참조하십시오.

*lpszDescription*<br/>
보고되는 오류에 대한 설명입니다.

*lpszSource*<br/>
오류를 생성하는 모듈의 이름(일반적으로 OLE 제어 모듈의 이름)입니다.

*lpszHelpFile*<br/>
오류에 대한 설명이 포함된 도움말 파일의 이름입니다.

*nHelpID*<br/>
보고되는 오류의 도움말 컨텍스트 ID입니다.

### <a name="remarks"></a>설명

기본 비헤이비어에는 *lpszDescription*에 포함된 오류 설명이 포함된 메시지 상자가 표시됩니다.

이 함수를 재정의하여 오류가 표시되는 방식을 사용자 지정합니다.

## <a name="colecontroldoclick"></a><a name="doclick"></a>콜레 컨트롤::D클릭

컨트롤에서 마우스 클릭 동작을 시뮬레이션합니다.

```cpp
void DoClick();
```

### <a name="remarks"></a>설명

재정의 가능한 `COleControl::OnClick` 멤버 함수가 호출되고 컨트롤에서 지원하는 경우 stock Click 이벤트가 발생합니다.

이 함수는 DoClick이라는 스톡 메서드로 `COleControl` 기본 클래스에서 지원됩니다. 자세한 내용은 [ActiveX 컨트롤: 메서드](../../mfc/mfc-activex-controls-methods.md)를 참조하세요.

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>콜레컨트롤::DoPropExchange

스트림 또는 속성 집합과 같은 영구 저장소 표현에서 컨트롤을 로드하거나 저장할 때 프레임워크에서 호출합니다.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>매개 변수

*pPX*<br/>
`CPropExchange` 개체에 대한 포인터입니다. 프레임워크는 이 개체를 제공하여 해당 방향을 포함하여 속성 교환의 컨텍스트를 설정합니다.

### <a name="remarks"></a>설명

이 함수는 일반적으로 PX_ 함수 **제품군을** 호출하여 OLE 컨트롤의 특정 사용자 정의 속성을 로드하거나 저장합니다.

제어 마법사가 OLE 컨트롤 프로젝트를 만드는 데 사용된 경우 이 함수의 재정의된 버전은 `COleControl` 기본 클래스 함수에 대한 `COleControl::DoPropExchange`호출로 지원되는 스톡 속성을 직렬화합니다. OLE 컨트롤에 사용자 정의 속성을 추가할 때 이 함수를 수정하여 새 속성을 직렬화해야 합니다. 직렬화에 대한 자세한 내용은 [ActiveX 컨트롤: 직렬화](../../mfc/mfc-activex-controls-serializing.md)문서를 참조하십시오.

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>콜레컨트롤: :D오슈퍼클래스페인트

Windows 컨트롤에서 하위 클래스가 된 OLE 컨트롤을 다시 그립니다.

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
컨트롤 컨테이너의 장치 컨텍스트에 대한 포인터입니다.

*rcBounds*<br/>
컨트롤을 그릴 영역입니다.

### <a name="remarks"></a>설명

비활성 OLE 컨트롤의 페인팅을 제대로 처리하려면 이 함수를 호출합니다. 이 함수는 OLE 컨트롤이 Windows 컨트롤을 하위 클래스로 분류하는 경우에만 사용해야 하며 컨트롤의 `OnDraw` 함수에서 호출해야 합니다.

이 함수 및 Windows 컨트롤 하위 분류에 대한 자세한 내용은 [ActiveX 컨트롤: Windows 컨트롤 하위 분류](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)문서를 참조하십시오.

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>콜레컨트롤::D로콘텐츠

컨트롤의 모양을 업데이트해야 하는 경우 프레임워크에서 호출합니다.

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
장치 컨텍스트에 대한 포인터입니다.

*Rc*<br/>
그릴 직사각형 영역입니다.

### <a name="remarks"></a>설명

이 함수는 재정의 `OnDraw` 가능한 함수를 직접 호출합니다.

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>콜레컨트롤::D로메타파일

메타파일 장치 컨텍스트가 사용 중일 때 프레임워크에서 호출됩니다.

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
메타파일 장치 컨텍스트에 대한 포인터입니다.

*Rc*<br/>
그릴 직사각형 영역입니다.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COle 제어::인에이블 심플프레임

OLE 컨트롤에 대한 간단한 프레임 특성을 활성화합니다.

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>설명

이 특성을 사용하면 컨트롤이 다른 컨트롤의 시각적 봉쇄를 지원할 수 있지만 TRUE OLE 포함은 지원하지 않습니다. 예를 들어 내부에 여러 컨트롤이 있는 그룹 상자가 있습니다. 이러한 컨트롤은 OLE가 포함되어 있지 않지만 동일한 그룹 상자에 있습니다.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>콜레 컨트롤::교환범위

컨트롤 익스텐트의 상태(HIMETRIC 단위의 차원)를 직렬화하거나 초기화합니다.

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>매개 변수

*pPX*<br/>
[CPropExchange](../../mfc/reference/cpropexchange-class.md) 개체에 대한 포인터입니다. 프레임워크는 이 개체를 제공하여 해당 방향을 포함하여 속성 교환의 컨텍스트를 설정합니다.

### <a name="return-value"></a>Return Value

함수가 성공한 경우 비영; 0 그렇지 않으면.

### <a name="remarks"></a>설명

이 함수는 일반적으로 의 기본 `COleControl::DoPropExchange`구현에 의해 호출됩니다.

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>콜레컨트롤::익스체인지스프롭스

컨트롤의 스톡 속성 상태를 직렬화하거나 초기화합니다.

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>매개 변수

*pPX*<br/>
[CPropExchange](../../mfc/reference/cpropexchange-class.md) 개체에 대한 포인터입니다. 프레임워크는 이 개체를 제공하여 해당 방향을 포함하여 속성 교환의 컨텍스트를 설정합니다.

### <a name="remarks"></a>설명

이 함수는 일반적으로 의 기본 `COleControl::DoPropExchange`구현에 의해 호출됩니다.

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>콜레 컨트롤::교환버전

컨트롤의 버전 정보의 상태를 직렬화하거나 초기화합니다.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>매개 변수

*pPX*<br/>
`CPropExchange` 개체에 대한 포인터입니다. 프레임워크는 이 개체를 제공하여 해당 방향을 포함하여 속성 교환의 컨텍스트를 설정합니다.

*dwVersionDefault*<br/>
컨트롤의 현재 버전 번호입니다.

*bConvert*<br/>
영구 데이터를 저장할 때 최신 형식으로 변환할지 또는 로드된 것과 동일한 형식으로 유지관리해야 하는지 여부를 나타냅니다.

### <a name="return-value"></a>Return Value

함수의 비영도 성공했다. 0 그렇지 않으면.

### <a name="remarks"></a>설명

일반적으로 이 함수는 컨트롤의 재정의에 의해 호출되는 첫 번째 함수입니다. `COleControl::DoPropExchange` 로드 할 때이 함수는 영구 데이터의 버전 번호를 읽고 그에 따라 [CPropExchange](../../mfc/reference/cpropexchange-class.md) 개체의 버전 특성을 설정합니다. 저장할 때 이 함수는 영구 데이터의 버전 번호를 씁니다.

지속성 및 버전 관리에 대한 자세한 내용은 [ActiveX 컨트롤: 직렬화](../../mfc/mfc-activex-controls-serializing.md)문서를 참조하십시오.

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>콜레 컨트롤 :: 파이어 클릭

활성 컨트롤을 통해 마우스를 클릭할 때 프레임워크에서 호출됩니다.

```cpp
void FireClick();
```

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의되는 경우 이벤트가 발생한 시기를 결정합니다.

Click 이벤트가 자동으로 발생하려면 컨트롤의 이벤트 맵에 스톡 클릭 이벤트가 정의되어 있어야 합니다.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>콜레 컨트롤 :: 파이어 드블 클릭

활성 컨트롤을 통해 마우스를 두 번 클릭할 때 프레임워크에서 호출됩니다.

```cpp
void FireDblClick();
```

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의되는 경우 이벤트가 발생한 시기를 결정합니다.

DblClick 이벤트가 자동으로 발생하려면 컨트롤의 이벤트 맵에 주식 DblClick 이벤트가 정의되어 있어야 합니다.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>콜레 컨트롤::화재 오류

주식 오류 이벤트를 발생시면 됩니다.

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>매개 변수

*Scode*<br/>
보고할 상태 코드 값입니다. 가능한 코드의 전체 목록은 [ActiveX 컨트롤: 고급 항목](../../mfc/mfc-activex-controls-advanced-topics.md)문서를 참조하십시오.

*lpszDescription*<br/>
보고되는 오류에 대한 설명입니다.

*nHelpID*<br/>
보고되는 오류의 도움말 ID입니다.

### <a name="remarks"></a>설명

이 이벤트는 코드의 적절한 위치에서 컨트롤 내에서 오류가 발생했음을 알리는 방법을 제공합니다. 클릭 또는 MouseMove와 같은 다른 스톡 이벤트와 달리 오류는 프레임워크에서 발생하지 않습니다.

속성 get 함수, 속성 집합 함수 또는 자동화 메서드 중에 발생하는 오류를 보고하려면 [COleControl::ThrowError](#throwerror)를 호출합니다.

OLE 컨트롤의 주식 오류 이벤트의 구현은 SCODE 값을 사용합니다. 컨트롤이 이 이벤트를 사용하고 Visual Basic 4.0에서 사용하려는 경우 Visual Basic에서 SCODE 값이 지원되지 않기 때문에 오류가 발생합니다.

이 문제를 해결하려면 컨트롤의 에서 SCODE 매개 변수를 수동으로 변경합니다. ODL 파일을 **긴**. 또한 SCODE 매개 변수를 사용하는 사용자 지정 이벤트, 메서드 또는 속성도 동일한 문제를 일으킵니다.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>콜레 컨트롤 :: 화재 이벤트

선택적 인수의 수와 컨트롤에서 사용자 정의 이벤트를 발생 합니다.

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>매개 변수

*디스피드 (것)들*<br/>
발생할 이벤트의 디스패치 ID입니다.

*pbParams*<br/>
이벤트의 매개 변수 형식에 대한 설명자입니다.

### <a name="remarks"></a>설명

일반적으로 이 함수는 직접 호출해서는 안 됩니다. 대신 컨트롤의 클래스 선언의 이벤트 맵 섹션에서 이벤트 발생 함수를 호출합니다.

*pbParams* 인수는 공간 분리된 **VTS_** 목록입니다. 공백(쉼표가 아님)으로 구분된 이러한 값 중 하나 이상이 함수의 매개 변수 목록을 지정합니다. 가능한 값은 다음과 같습니다.

|기호|매개 변수 형식|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> 변형 데이터 상수에 대한 포인터를 제공하는 VTS_FONT 및 VTS_PICTURE 제외한 모든 변형 형식에 대해 추가 변형 상수가 정의되었습니다. 이러한 상수는 **VTS_P** `constantname` 규칙을 사용하여 명명됩니다. 예를 들어 VTS_PCOLOR VTS_COLOR 상수에 대한 포인터입니다.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>콜레 컨트롤:::파이어키다운

컨트롤이 활성화되어 있는 동안 키를 누를 때 프레임워크에서 호출됩니다.

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>매개 변수

*pnChar*<br/>
누른 키의 가상 키 코드 값에 대한 포인터입니다. 표준 가상 키 코드 목록은 Winuser.h를 참조하십시오.

*nShiftState*<br/>
다음 플래그의 조합을 포함합니다.

- SHIFT_MASK SHIFT 키가 작업 중에 눌렀습니다.

- CTRL_MASK 작업 중에 CTRL 키를 눌렀습니다.

- ALT_MASK 작업 중에 ALT 키를 눌렀습니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의되는 경우 이벤트가 발생한 시기를 결정합니다.

키다운 이벤트가 자동으로 발생하려면 컨트롤의 이벤트 맵에 주식 KeyDown 이벤트가 정의되어 있어야 합니다.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>콜레 컨트롤::파이어키프레스

사용자 지정 컨트롤이 컨테이너 내에서 UI 활성인 동안 키를 누르고 해제할 때 프레임워크에서 호출됩니다.

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>매개 변수

*pnChar*<br/>
누른 키의 문자 값에 대한 포인터입니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의되는 경우 이벤트가 발생한 시기를 결정합니다.

이벤트의 수신자는 *pnChar를*수정할 수 있습니다. 수정된 문자를 검사하려면 을 재정의합니다. `OnKeyPressEvent`

키프레스 이벤트가 자동으로 발생하려면 컨트롤의 이벤트 맵에 주식 KeyPress 이벤트가 정의되어 있어야 합니다.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>콜레 컨트롤 :: 파이어 키업

사용자 지정 컨트롤이 컨테이너 내에서 UI 활성인 동안 키가 해제될 때 프레임워크에서 호출됩니다.

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>매개 변수

*pnChar*<br/>
해제된 키의 가상 키 코드 값에 대한 포인터입니다. 표준 가상 키 코드 목록은 Winuser.h를 참조하십시오.

*nShiftState*<br/>
다음 플래그의 조합을 포함합니다.

- SHIFT_MASK SHIFT 키가 작업 중에 눌렀습니다.

- CTRL_MASK 작업 중에 CTRL 키를 눌렀습니다.

- ALT_MASK 작업 중에 ALT 키를 눌렀습니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의되는 경우 이벤트가 발생한 시기를 결정합니다.

KeyUp 이벤트가 자동으로 발생하려면 컨트롤의 이벤트 맵에 주식 KeyUp 이벤트가 정의되어 있어야 합니다.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>콜레 컨트롤 :: 파이어 마우스 다운

활성 사용자 지정 컨트롤을 통해 마우스 단추를 누를 때 프레임워크에서 호출됩니다.

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>매개 변수

*nButton*<br/>
마우스 단추의 숫자 값을 누른 값입니다. 다음 값 중 하나를 포함할 수 있습니다.

- LEFT_BUTTON 왼쪽 마우스 버튼을 눌렀습니다.

- MIDDLE_BUTTON 가운데 마우스 버튼을 눌렀습니다.

- RIGHT_BUTTON 오른쪽 마우스 버튼을 눌렀습니다.

*nShiftState*<br/>
다음 플래그의 조합을 포함합니다.

- SHIFT_MASK SHIFT 키가 작업 중에 눌렀습니다.

- CTRL_MASK 작업 중에 CTRL 키를 눌렀습니다.

- ALT_MASK 작업 중에 ALT 키를 눌렀습니다.

*x*<br/>
마우스 버튼을 누를 때 커서의 x 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모서리를 기준으로 합니다.

*Y*<br/>
마우스 단추를 누를 때 커서의 y 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모서리를 기준으로 합니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의되는 경우 이벤트가 발생한 시기를 결정합니다.

MouseDown 이벤트가 자동으로 발생하려면 컨트롤의 이벤트 맵에 주식 MouseDown 이벤트가 정의되어 있어야 합니다.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>콜레 컨트롤 :: 파이어 마우스 이동

커서가 활성 사용자 지정 컨트롤을 통해 이동될 때 프레임워크에서 호출됩니다.

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>매개 변수

*nButton*<br/>
마우스 단추의 숫자 값누른 값입니다. 다음 값의 조합을 포함합니다.

- LEFT_BUTTON 작업 중에 왼쪽 마우스 버튼을 눌렀습니다.

- MIDDLE_BUTTON 작업 중에 가운데 마우스 버튼을 눌렀습니다.

- RIGHT_BUTTON 작업 중에 오른쪽 마우스 버튼을 눌렀습니다.

*nShiftState*<br/>
다음 플래그의 조합을 포함합니다.

- SHIFT_MASK SHIFT 키가 작업 중에 눌렀습니다.

- CTRL_MASK 작업 중에 CTRL 키를 눌렀습니다.

- ALT_MASK 작업 중에 ALT 키를 눌렀습니다.

*x*<br/>
커서의 x 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모서리를 기준으로 합니다.

*Y*<br/>
커서의 y 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모서리를 기준으로 합니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의되는 경우 이벤트가 발생한 시기를 결정합니다.

MouseMove 이벤트가 자동으로 발생하려면 컨트롤의 이벤트 맵에 주식 MouseMove 이벤트가 정의되어 있어야 합니다.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>콜레 컨트롤 :: 파이어 마우스 업

활성 사용자 지정 컨트롤을 통해 마우스 단추를 해제할 때 프레임워크에서 호출됩니다.

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>매개 변수

*nButton*<br/>
마우스 단추의 숫자 값입니다. 다음 값 중 하나일 수 있습니다.

- LEFT_BUTTON 왼쪽 마우스 버튼이 해제되었습니다.

- MIDDLE_BUTTON 가운데 마우스 버튼이 해제되었습니다.

- RIGHT_BUTTON 오른쪽 마우스 버튼이 해제되었습니다.

*nShiftState*<br/>
다음 플래그의 조합을 포함합니다.

- SHIFT_MASK SHIFT 키가 작업 중에 눌렀습니다.

- CTRL_MASK 작업 중에 CTRL 키를 눌렀습니다.

- ALT_MASK 작업 중에 ALT 키를 눌렀습니다.

*x*<br/>
마우스 단추를 해제할 때 커서의 x 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모서리를 기준으로 합니다.

*Y*<br/>
마우스 단추를 해제할 때 커서의 y 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모서리를 기준으로 합니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의되는 경우 이벤트가 발생한 시기를 결정합니다.

MouseUp 이벤트가 자동으로 발생하려면 컨트롤의 이벤트 맵에 주식 MouseUp 이벤트가 정의되어 있어야 합니다.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>콜레 컨트롤::화재 준비 상태변경

제어 준비 상태의 현재 값으로 이벤트를 발생시입니다.

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>설명

준비 상태는 다음 값 중 하나가 될 수 있습니다.

|||
|-|-|
|READYSTATE_UNINITIALIZED|기본 초기화 상태|
|READYSTATE_LOADING|컨트롤이 현재 해당 속성을 로드하고 있습니다.|
|READYSTATE_LOADED|제어가 초기화되었습니다.|
|READYSTATE_INTERACTIVE|컨트롤에 대화형으로 사용할 수 있는 데이터가 충분하지만 모든 비동기 데이터가 아직 로드되지는 않습니다.|
|READYSTATE_COMPLETE|컨트롤에는 모든 데이터가 있습니다.|

[GetReadyState를](#getreadystate) 사용하여 컨트롤의 현재 준비 상태를 확인합니다.

[InternalSetReadyState는](#internalsetreadystate) 준비 상태를 제공된 값으로 `FireReadyStateChange`변경한 다음 을 호출합니다.

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COle Control::Get활성화정책

인터페이스를 지원하는 컨트롤의 기본 활성화 `IPointerInactive` 동작을 변경합니다.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Return Value

POINTERINACTIVE 열거형의 플래그 조합입니다. 가능한 플래그는 다음과 같습니다.

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|마우스 이동 작업 중에 마우스가 개체에 들어갈 때 개체가 활성화되어야 합니다.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|마우스 이동 작업 중에 마우스가 개체를 떠날 때 개체를 비활성화해야 합니다.|
|POINTERINACTIVE_ACTIVATEONDRAG|끌어서 놓기 작업 중에 마우스를 마우스 위로 드래그할 때 개체가 활성화되어야 합니다.|

### <a name="remarks"></a>설명

인터페이스가 `IPointerInactive` 활성화되면 컨테이너는 WM_SETCURSOR 위임하고 메시지를 WM_MOUSEMOVE. `COleControl`이 인터페이스의 구현은 마우스 좌표를 적절하게 조정한 후 컨트롤의 메시지 맵을 통해 이러한 메시지를 전달합니다.

컨테이너가 지원 `IPointerInactive`중인 비활성 개체 위에 마우스 포인터가 있는 WM_SETCURSOR 또는 `GetActivationPolicy` WM_MOUSEMOVE 메시지를 받을 때마다 인터페이스를 호출하고 POINTERINACTIVE 열거형에서 플래그를 반환해야 합니다.

메시지 맵에 해당 항목을 추가하여 일반 창 메시지와 마찬가지로 이러한 메시지를 처리할 수 있습니다. 처리기에서 먼저 해당 `m_hWnd` 값이 NULL이 아닌지 확인하지 않고 멤버 변수(또는 이를 사용하는 멤버 함수)를 사용하지 마십시오.

마우스 커서를 설정하거나 특별한 시각적 피드백을 제공하는 것과 같은 마우스 이동 이벤트를 발생시키기 위한 모든 개체는 POINTERINACTIVE_ACTIVATEONENTRY 플래그를 반환하고 활성화된 경우에만 피드백을 그려야 합니다. 개체가 이 플래그를 반환하는 경우 컨테이너는 즉시 해당 플래그를 활성화한 다음 호출을 트리거한 동일한 메시지를 전달해야 합니다. `GetActivationPolicy`

POINTERINACTIVE_ACTIVATEONENTRY 플래그와 POINTERINACTIVE_DEACTIVATEONLEAVE 플래그가 모두 반환되면 마우스가 개체 위에 있을 때만 개체가 활성화됩니다. POINTERINACTIVE_ACTIVATEONENTRY 플래그만 반환되면 마우스가 오브젝트에 처음 들어갈 때 개체가 한 번만 활성화됩니다.

또한 비활성 컨트롤이 OLE 드래그 앤 드롭 작업의 대상이 될 수도 있습니다. 이렇게 하려면 컨트롤의 창을 놓기 대상으로 등록할 수 있도록 사용자가 개체를 드래그하는 순간에 컨트롤을 활성화해야 합니다. 드래그 중에 활성화가 발생하려면 POINTERINACTIVE_ACTIVATEONDRAG 플래그를 반환합니다.

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

통신하는 정보는 `GetActivationPolicy` 컨테이너에 의해 캐시되어서는 안 됩니다. 대신 마우스가 비활성 개체에 들어갈 때마다 이 메서드를 호출해야 합니다.

비활성 개체가 마우스에 들어갈 때 활성화되도록 요청하지 않는 경우 해당 컨테이너는 마우스 포인터가 개체 위에 머무르는 한 [OnInactiveSetCursor를](#oninactivesetcursor) 호출하여 이 개체에 후속 WM_SETCURSOR 메시지를 디스패치해야 합니다.

일반적으로 인터페이스를 `IPointerInactive` 사용하도록 설정하면 컨트롤이 항상 마우스 메시지를 처리할 수 있도록 해야 합니다. `IPointerInactive` 인터페이스를 지원하지 않는 컨테이너에서 이 동작을 얻으려면 컨트롤이 표시될 때 항상 컨트롤이 활성화되어야 OLEMISC_ACTIVATEWHENVISIBLE 합니다. 그러나 이 플래그가 지원되는 `IPointerInactive`컨테이너에서 적용되지 않도록 하려면 OLEMISC_IGNOREACTIVATEWHENVISIBLE 플래그를 지정할 수도 있습니다.

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>콜레 컨트롤::GetAmbient속성

컨테이너의 주변 속성 값을 가져옵니다.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>매개 변수

*dwDispid*<br/>
원하는 주변 속성의 디스패치 ID입니다.

*vtProp*<br/>
*pvProp에서*반환할 값의 형식을 지정하는 변형 형식 태그입니다.

*pvProp*<br/>
속성 값 또는 반환 값을 받을 변수의 주소에 대 한 포인터입니다. 이 포인터의 실제 형식은 *vtProp*에서 지정한 형식과 일치해야 합니다.

|vtProp|pvProp의 유형|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Return Value

앰비언트 속성이 지원되는 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

주변 DisplayName 및 ScaleUnits 속성을 검색하는 `GetAmbientProperty` 데 사용하는 경우 *vtProp을* VT_BSTR 및 *pvProp을* 로 설정합니다. `CString*` 주변 글꼴 속성을 검색하는 경우 *vtProp을* VT_FONT 설정하고 *pvProp을* LPFONTDISP*로 설정합니다.

[앰비언트백컬러](#ambientbackcolor) 및 [앰비언트폰트와](#ambientfont)같은 일반적인 주변 속성에 대한 함수가 이미 제공되었습니다.

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>콜레 컨트롤 :: Get외관

컨트롤의 스톡 모양 속성의 Get 함수를 구현합니다.

```
short GetAppearance ();
```

### <a name="return-value"></a>Return Value

반환 값은 성공하면 현재 모양 **short** 설정을 짧은(VT_I2) 값으로 지정합니다. 이 값은 컨트롤의 모양이 평평한 경우 0이고 컨트롤의 모양이 3D인 경우 1입니다.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>콜레 컨트롤 :: 겟백 컬러

컨트롤의 스톡 BackColor 속성의 Get 함수를 구현합니다.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Return Value

반환 값은 성공하면 현재 배경색을 OLE_COLOR 값으로 지정합니다. 이 값은 `TranslateColor`을 호출하여 COLORREF 값으로 변환할 수 있습니다.

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>콜레 컨트롤:::겟보더스타일

컨트롤의 스톡 BorderStyle 속성의 Get 함수를 구현합니다.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Return Value

컨트롤에 일반 테두리가 있는 경우 1입니다. 컨트롤에 테두리가 없는 경우 0입니다.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>콜레 컨트롤 :: 겟캡쳐

개체에 `COleControl` 마우스 캡처가 있는지 여부를 확인합니다.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Return Value

컨트롤이 활성화되고 창이 없는 **경우** 컨트롤에 현재 마우스 캡처(컨트롤의 컨테이너에 의해 결정됨) 또는 캡처가 없는 경우 NULL이 반환됩니다.

그렇지 않으면 `CWnd` 마우스 캡처가 있는 개체(와 동일)를 `CWnd::GetCapture`반환합니다.

### <a name="remarks"></a>설명

활성화된 창 없는 [컨트롤은 SetCapture가](#setcapture) 호출될 때 마우스 캡처를 수신합니다.

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>콜레 컨트롤 :: GetClassID

컨트롤의 OLE 클래스 ID를 검색 하는 프레임 워크에서 호출 됩니다.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>매개 변수

*pclsid*<br/>
클래스 ID의 위치에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

호출이 성공하지 않은 경우 0이 아님을 그렇지 않으면 0.

### <a name="remarks"></a>설명

일반적으로 [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)의해 구현됩니다.

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COleControl::GetClientoffset

컨트롤의 직사각형 영역의 왼쪽 위 모서리와 클라이언트 영역의 왼쪽 위 모서리 간의 차이를 검색합니다.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>매개 변수

*pdxOffset*<br/>
OLE 컨트롤의 클라이언트 영역의 수평 오프셋에 대한 포인터입니다.

*pdyOffset*<br/>
OLE 컨트롤의 클라이언트 영역의 수직 오프셋에 대한 포인터입니다.

### <a name="remarks"></a>설명

OLE 컨트롤에는 컨테이너 내에 직사각형 영역이 있습니다. 컨트롤의 클라이언트 영역은 테두리와 스크롤 막대를 제외한 제어 영역입니다. 검색된 `GetClientOffset` 오프셋은 컨트롤의 직사각형 영역의 왼쪽 위 모서리와 클라이언트 영역의 왼쪽 위 모서리 간의 차이입니다. 컨트롤에 표준 테두리 및 스크롤 막대 이외의 비클라이언트 요소가 있는 경우 이 멤버 함수를 재정의하여 오프셋을 지정합니다.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>콜레 컨트롤::GetClientRect

컨트롤의 클라이언트 영역 크기를 검색합니다.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>매개 변수

*Lprect*<br/>
창 없는 `RECT` 컨트롤의 클라이언트 영역의 치수를 포함 하는 구조에 대 한 포인터; 즉, 컨트롤의 크기에서 창 테두리, 프레임, 스크롤 막대 등을 뺀 값입니다. *lpRect* 매개 변수는 해당 위치가 아닌 컨트롤의 클라이언트 사각형크기를 나타냅니다.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COle Control::GetClientSite

컨테이너 내의 현재 클라이언트 사이트에 대한 포인터에 대한 개체를 쿼리합니다.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Return Value

컨테이너에 있는 컨트롤의 현재 클라이언트 사이트에 대한 포인터입니다.

### <a name="remarks"></a>설명

반환된 포인터는 `IOleClientSite`의 인스턴스를 가리킵니다. 컨테이너에 의해 구현된 인터페이스는 `IOleClientSite` 해당 컨텍스트에 대한 개체의 보기입니다.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>콜레 컨트롤::GetControlFlags

컨트롤 플래그 설정을 검색합니다.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Return Value

컨트롤플래그 열거형의 플래그의 ORed 조합:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>설명

기본적으로 `GetControlFlags` 반환 `fastBeginPaint | clipPaintDC`합니다.

|||
|-|-|
|`fastBeginPaint`|설정된 경우 [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API 대신 OLE 컨트롤에 맞게 조정된 시작 페인트 함수를 사용합니다(기본적으로 설정).|
|`clipPaintDC`|설정하지 않으면 호출을 `IntersectClipRect` `COleControl` 비활성화하고 작은 속도 이점을 얻습니다. 창 없는 활성화를 사용하는 경우 플래그는 영향을 주지 않습니다.|
|`pointerInactive`|설정된 경우 기본적으로 비활성화된 `COleControl` `IPointerInactive` 인터페이스의 구현을 활성화하여 컨트롤이 비활성 상태인 동안 마우스 상호 작용을 제공합니다.|
|`noFlickerActivate`|설정된 경우 추가 그리기 작업과 함께 제공되는 시각적 깜박임이 제거됩니다. 비활성 및 활성 상태에서 컨트롤이 동일하게 그려지면 사용합니다. 창 없는 활성화를 사용하는 경우 플래그는 영향을 주지 않습니다.|
|`windowlessActivate`|설정하면 컨트롤이 창 없는 활성화를 사용했음을 나타냅니다.|
|`canOptimizeDraw`|설정하면 컨테이너가 지원하는 경우 컨트롤이 최적화된 도면을 수행한다는 것을 나타냅니다.|

OLE 컨트롤의 `GetControlFlags` 기타 최적화에 대한 자세한 내용은 [ActiveX 컨트롤: 최적화](../../mfc/mfc-activex-controls-optimization.md)를 참조하십시오.

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>콜레 컨트롤::GetControlSize

OLE 컨트롤 창의 크기를 검색합니다.

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>매개 변수

*pcx*<br/>
컨트롤의 너비를 픽셀 단위로 지정합니다.

*pcy*<br/>
컨트롤의 높이를 픽셀 단위로 지정합니다.

### <a name="remarks"></a>설명

컨트롤 창의 모든 좌표는 컨트롤의 왼쪽 위 모서리를 기준으로 합니다.

## <a name="colecontrolgetdc"></a><a name="getdc"></a>콜레 컨트롤::GetDC

창없는 개체가 컨테이너에서 화면(또는 호환되는) 장치 컨텍스트를 가져옵니다.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>매개 변수

*lprcRect*<br/>
창 없는 컨트롤이 컨트롤의 클라이언트 좌표에서 다시 그리려는 사각형에 대한 포인터입니다. NULL은 전체 개체의 범위를 의미합니다.

*dwFlags*<br/>
장치 컨텍스트의 특성 그리기입니다. 선택 사항은 다음과 같습니다.

- OLEDC_NODRAW 객체가 장치 컨텍스트를 사용하여 드로잉을 수행하지 말고 단순히 표시 장치에 대한 정보를 얻을 수 있음을 나타냅니다. 컨테이너는 추가 처리 없이 창의 DC를 전달하기만 하면 됩니다.

- OLEDC_PAINTBKGND DC를 반환하기 전에 컨테이너가 배경을 페인트해 달라는 요청을 합니다. 투명한 배경이 있는 영역을 다시 그리기 위해 DC를 요청하는 경우 개체는 이 플래그를 사용해야 합니다.

- OLEDC_OFFSCREEN 개체가 화면 오프 비트맵으로 렌더링할 것을 컨테이너에 알린 다음 화면에 복사해야 합니다. 객체는 수행하려는 그리기 작업이 많은 깜박임을 생성할 때 이 플래그를 사용해야 합니다. 컨테이너는 이 요청을 준수할 수 있습니다. 그러나 이 플래그가 설정되지 않은 경우 컨테이너는 화면 DC를 다시 전달해야 합니다. 이렇게 하면 개체가 **XOR** 작업을 통해 선택 영역을 표시하는 등의 직접 화면 작업을 수행할 수 있습니다.

### <a name="return-value"></a>Return Value

성공한 경우 컨테이너 `CWnd` 클라이언트 영역에 대한 표시 장치 컨텍스트에 대한 포인터; 그렇지 않으면 반환 값은 NULL입니다. 디스플레이 장치 컨텍스트는 후속 GDI 함수에서 컨테이너 창의 클라이언트 영역에 그릴 때 사용할 수 있습니다.

### <a name="remarks"></a>설명

페인팅 후 컨텍스트를 해제하려면 [ReleaseDC](#releasedc) 멤버 함수를 호출해야 합니다. 호출할 `GetDC`때 개체는 자체 클라이언트 좌표에 그려지려는 사각형을 전달합니다. `GetDC`이를 컨테이너 클라이언트 영역의 좌표로 변환합니다. 개체는 [GetClientRect를](#getclientrect)통해 검색할 수 있는 크기를 자체 클라이언트 영역 사각형보다 큰 원하는 그리기 사각형을 요청해서는 안 됩니다. 이렇게 하면 객체가 의도하지 않은 위치에 그리는 것을 방지할 수 있습니다.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COleControl::GetEnabled

컨트롤의 stock Enabled 속성의 Get 함수를 구현합니다.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Return Value

컨트롤이 활성화된 경우 0이 아닙니다. 그렇지 않으면 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COle 제어::GetExtendedControl

확장된 속성 집합을 사용하여 컨트롤을 나타내는 컨테이너에서 유지 관리하는 개체에 대한 포인터를 가져옵니다.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Return Value

컨테이너의 확장 된 컨트롤 개체에 대 한 포인터입니다. 사용 가능한 개체가 없는 경우 값은 NULL입니다.

이 개체는 인터페이스를 `IDispatch` 통해 조작할 수 있습니다. 개체에서 제공하는 `QueryInterface` 다른 사용 가능한 인터페이스를 가져오는 데도 사용할 수 있습니다. 그러나 개체는 특정 인터페이스 집합을 지원할 필요가 없습니다. 컨테이너의 확장된 제어 개체의 특정 기능에 의존하면 컨트롤의 이식성이 다른 임의 컨테이너로 제한됩니다.

### <a name="remarks"></a>설명

이 함수를 호출 하는 함수는 개체와 함께 완료 될 때 포인터를 해제 하는 담당 합니다. 컨테이너는 이 개체를 지원할 필요가 없습니다.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>콜레 컨트롤::Get포커스

개체에 포커스가 `COleControl` 있는지 여부를 확인합니다.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Return Value

컨트롤이 활성화되고 창이 없는 **경우** 컨트롤에 현재 키보드 포커스(컨트롤의 컨테이너에 의해 결정됨)가 있는 경우 또는 포커스가 없는 경우 NULL이 반환됩니다.

그렇지 않으면 `CWnd` 포커스가 있는 개체(와 `CWnd::GetFocus`동일)를 반환합니다.

### <a name="remarks"></a>설명

활성화된 창 없는 컨트롤은 SetFocus가 호출될 때 [포커스를 수신합니다.](#setfocus)

## <a name="colecontrolgetfont"></a><a name="getfont"></a>콜레 컨트롤 :: 겟폰트

스톡 Font 속성의 Get 함수를 구현합니다.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Return Value

컨트롤의 스톡 Font 속성의 글꼴 디스패치 인터페이스에 대한 포인터입니다.

### <a name="remarks"></a>설명

호출자는 완료되면 개체를 해제해야 합니다. 컨트롤의 구현 내에서 컨트롤의 스톡 Font 개체에 액세스하는 데 사용합니다. `InternalGetFont` 컨트롤에서 글꼴 사용에 대한 자세한 내용은 [ActiveX 컨트롤: ActiveX 컨트롤의 글꼴 사용](../../mfc/mfc-activex-controls-using-fonts.md)문서를 참조하십시오.

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>콜레 컨트롤::겟폰트텍스트메트릭스

컨트롤이 소유한 모든 `CFontHolder` 개체에 대한 텍스트 메트릭을 측정합니다.

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>매개 변수

*lptm*<br/>
[텍스트 메트릭](/windows/win32/api/wingdi/ns-wingdi-textmetricw) 구조에 대한 포인터입니다.

*fontHolder*<br/>
[CFontHolder](../../mfc/reference/cfontholder-class.md) 개체에 대한 참조입니다.

### <a name="remarks"></a>설명

이러한 글꼴은 [COleControl::SelectFontObject](#selectfontobject) 함수를 사용 하 고 선택할 수 있습니다. `GetFontTextMetrics`*lptm에* 의해 가리키는 `fontHolder` `TEXTMETRIC` 구조를 초기화하고 성공하면 글꼴에 대한 유효한 메트릭 정보가 있거나 성공하지 못하면 구조를 0으로 채웁니다. 포함된 OLE 개체와 마찬가지로 컨트롤이 메타파일로 렌더링해야 할 수 있으므로 컨트롤을 페인팅할 때 [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) 대신 이 함수를 사용해야 합니다.

`TEXTMETRIC` [SelectFontObject](#selectfontobject) 함수가 호출될 때 기본 글꼴의 구조가 새로 고쳐집니다. 제공된 정보가 `GetFontTextMetrics` 유효한지 확인하기 위해 스톡 Font 속성을 선택한 후에만 호출해야 합니다.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>콜레 컨트롤 ::GetForeColor

주식 ForeColor 속성의 Get 함수를 구현합니다.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Return Value

반환 값은 성공하면 현재 전경 색상을 OLE_COLOR 값으로 지정합니다. 이 값은 `TranslateColor`을 호출하여 [COLORREF](/windows/win32/gdi/colorref) 값으로 변환할 수 있습니다.

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>콜레 컨트롤 :: GetHwnd

stock hWnd 속성의 Get 함수를 구현합니다.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Return Value

OLE 컨트롤의 창 핸들(있는 경우)입니다. 그렇지 않으면 NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>콜레 컨트롤::GetMessageString

*nID로*식별된 메뉴 항목의 목적을 설명하는 짧은 문자열을 얻기 위해 프레임워크에서 호출합니다.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>매개 변수

*nID*<br/>
메뉴 항목 ID입니다.

*rMessage*<br/>
문자열이 반환되는 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 개체에 대한 참조입니다.

### <a name="remarks"></a>설명

메뉴 항목이 강조 표시되어 있는 동안 상태 표시줄에 표시할 메시지를 가져오는 데 사용할 수 있습니다. 기본 구현은 *nID*로 식별된 문자열 리소스를 로드하려고 시도합니다.

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COle Control::GetNot지원

사용자가 컨트롤의 속성 값에 액세스할 수 없도록 합니다.

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>설명

컨트롤의 사용자가 속성을 검색할 수 없는 속성의 Get 함수 대신이 함수를 호출 합니다. 한 가지 예는 쓰기전용 속성입니다.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>콜레 컨트롤::GetReadyState

컨트롤의 준비 상태를 반환합니다.

```
long GetReadyState();
```

### <a name="return-value"></a>Return Value

컨트롤의 준비 상태(다음 값 중 하나)는 다음과 같은 값입니다.

|||
|-|-|
|READYSTATE_UNINITIALIZED|기본 초기화 상태|
|READYSTATE_LOADING|컨트롤이 현재 해당 속성을 로드하고 있습니다.|
|READYSTATE_LOADED|제어가 초기화되었습니다.|
|READYSTATE_INTERACTIVE|컨트롤에 대화형으로 사용할 수 있는 데이터가 충분하지만 모든 비동기 데이터가 아직 로드되지는 않습니다.|
|READYSTATE_COMPLETE|컨트롤에는 모든 데이터가 있습니다.|

### <a name="remarks"></a>설명

대부분의 간단한 컨트롤은 LOADED와 대화형 을 구분할 필요가 없습니다. 그러나 데이터 경로 속성을 지원하는 컨트롤은 적어도 일부 데이터가 비동기적으로 수신될 때까지 대화형으로 사용할 준비가 되지 않을 수 있습니다. 컨트롤은 가능한 한 빨리 대화형으로 만들어야 합니다.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>콜레 컨트롤::GetRectIn컨테이너

장치 단위로 표현된 컨테이너를 기준으로 컨트롤의 사각형 좌표를 가져옵니다.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*Lprect*<br/>
컨트롤의 좌표를 복사할 사각형 구조에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

컨트롤이 활성 상태인 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

사각형은 컨트롤이 현재 상태인 경우에만 유효합니다.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>콜레 컨트롤::겟스톡텍스트메트릭스

[SelectStockFont](#selectstockfont) 함수로 선택할 수 있는 컨트롤의 스톡 Font 속성에 대한 텍스트 메트릭을 측정합니다.

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>매개 변수

*lptm*<br/>
[텍스트 메트릭](/windows/win32/api/wingdi/ns-wingdi-textmetricw) 구조에 대한 포인터입니다.

### <a name="remarks"></a>설명

이 `GetStockTextMetrics` 함수는 성공하면 유효한 메트릭 정보로 `TEXTMETRIC` *lptm이* 가리키는 구조를 초기화하거나 성공하지 못하면 구조를 0으로 채웁니다. 포함된 OLE 개체와 마찬가지로 컨트롤이 메타파일로 렌더링해야 할 수 있으므로 컨트롤을 페인팅할 때 [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) 대신 이 함수를 사용합니다.

함수가 호출될 때 기본 글꼴의 `TEXTMETRIC` `SelectStockFont` 구조가 새로 고쳐집니다. 제공된 정보가 유효한지 확인하기 위해 스톡 글꼴을 선택한 후에만 이 함수를 호출해야 합니다.

## <a name="colecontrolgettext"></a><a name="gettext"></a>콜레 컨트롤::GetText

스톡 텍스트 또는 캡션 속성의 Get 함수를 구현합니다.

```
BSTR GetText();
```

### <a name="return-value"></a>Return Value

문자열이 없는 경우 컨트롤 텍스트 문자열또는 0 길이 문자열의 현재 값입니다.

> [!NOTE]
> BSTR 데이터 형식에 대한 자세한 내용은 매크로 및 전역 섹션의 [데이터 형식을](../../mfc/reference/data-types-mfc.md) 참조하십시오.

### <a name="remarks"></a>설명

이 함수의 호출자는 리소스를 해제하기 위해 반환된 문자열을 호출해야 `SysFreeString` 합니다. 컨트롤의 구현 내에서 컨트롤의 스톡 텍스트 또는 캡션 속성에 액세스 하는 데 사용 합니다. `InternalGetText`

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>콜레 컨트롤::GetWindowlessDropTarget

창 `GetWindowlessDropTarget` 없는 컨트롤을 OLE 드래그 앤 드롭 작업의 대상으로 지정하는 경우 재정의합니다.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Return Value

개체의 인터페이스에 `IDropTarget` 대한 포인터입니다. 창이 없으므로 창 없는 개체는 인터페이스를 `IDropTarget` 등록할 수 없습니다. 그러나 드래그 앤 드롭에 참여하려면 창없는 개체는 여전히 인터페이스를 `GetWindowlessDropTarget`구현하고 에서 반환할 수 있습니다.

### <a name="remarks"></a>설명

일반적으로 이를 위해서는 컨트롤의 창이 놓기 대상으로 등록되어야 합니다. 그러나 컨트롤에는 자체 창이 없으므로 컨테이너는 자체 창을 놓기 대상으로 사용합니다. 컨트롤은 단순히 컨테이너가 적절한 `IDropTarget` 시간에 호출을 위임할 수 있는 인터페이스의 구현을 제공해야 합니다. 다음은 그 예입니다.

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>콜레 컨트롤::초기화 IIDs

컨트롤이 사용할 IID의 기본 클래스를 알립니다.

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>매개 변수

*piidPrimary*<br/>
컨트롤의 기본 디스패치 인터페이스의 인터페이스 ID에 대한 포인터입니다.

*piidEvents*<br/>
컨트롤의 이벤트 인터페이스의 인터페이스 ID에 대한 포인터입니다.

### <a name="remarks"></a>설명

컨트롤의 생성자에서 이 함수를 호출하여 컨트롤이 사용할 인터페이스 의 기본 클래스에 알립니다.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>콜레 컨트롤::내부GetFont

컨트롤의 스톡 글꼴 속성에 액세스

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Return Value

스톡 글꼴 개체를 포함하는 [CFontHolder](../../mfc/reference/cfontholder-class.md) 개체에 대한 참조입니다.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>콜레 컨트롤::내부GetText

컨트롤의 스톡 텍스트 또는 캡션 속성에 액세스합니다.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Return Value

컨트롤 텍스트 문자열에 대한 참조입니다.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>콜레 컨트롤::내부세트준비 상태

컨트롤의 준비 상태를 설정합니다.

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>매개 변수

*lNewReadyState*<br/>
컨트롤에 대해 설정할 준비 상태(다음 값 중 하나)는 다음과 같은 값입니다.

|||
|-|-|
|READYSTATE_UNINITIALIZED|기본 초기화 상태|
|READYSTATE_LOADING|컨트롤이 현재 해당 속성을 로드하고 있습니다.|
|READYSTATE_LOADED|제어가 초기화되었습니다.|
|READYSTATE_INTERACTIVE|컨트롤에 대화형으로 사용할 수 있는 데이터가 충분하지만 모든 비동기 데이터가 아직 로드되지는 않습니다.|
|READYSTATE_COMPLETE|컨트롤에는 모든 데이터가 있습니다.|

### <a name="remarks"></a>설명

대부분의 간단한 컨트롤은 LOADED와 대화형 을 구분할 필요가 없습니다. 그러나 데이터 경로 속성을 지원하는 컨트롤은 적어도 일부 데이터가 비동기적으로 수신될 때까지 대화형으로 사용할 준비가 되지 않을 수 있습니다. 컨트롤은 가능한 한 빨리 대화형으로 만들어야 합니다.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>콜레 컨트롤::무효 제어

컨트롤이 강제로 다시 그려지도록 합니다.

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>매개 변수

*Lprect*<br/>
무효화할 컨트롤 영역에 대한 포인터입니다.

*bErase*<br/>
업데이트 영역이 처리될 때 업데이트 영역 내의 배경을 지울지 여부를 지정합니다.

### <a name="remarks"></a>설명

*lpRect에* NULL 값이 있으면 전체 컨트롤이 다시 그려집니다. *lpRect가* NULL이 아닌 경우 무효화할 컨트롤 사각형 의 일부를 나타냅니다. 컨트롤에 창이 없거나 현재 활성화되어 있지 않은 경우 사각형이 무시되고 클라이언트 사이트의 [IAdviseSink::OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) 멤버 함수에 대한 호출이 수행됩니다. 또는 `InvalidateRect`이 함수 `CWnd::InvalidateRect` 대신 이 함수를 사용합니다.

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>콜레 컨트롤::무효화Rgn

지정된 지역 내의 컨테이너 창의 클라이언트 영역을 무효화합니다.

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>매개 변수

*pRgn*<br/>
포함 창의 클라이언트 좌표에서 무효화할 OLE 개체의 표시 영역을 식별하는 [CRgn](../../mfc/reference/crgn-class.md) 개체에 대한 포인터입니다. 이 매개 변수가 NULL이면 익스텐은 전체 개체입니다.

*bErase*<br/>
무효화된 영역 내의 배경을 지울지 여부를 지정합니다. TRUE이면 배경이 지워집니다. FALSE인 경우 배경은 변경되지 않습니다.

### <a name="remarks"></a>설명

컨테이너 내에서 창 없는 컨트롤을 다시 그리는 데 사용할 수 있습니다. 무효화된 영역은 업데이트 영역의 다른 모든 영역과 함께 다음 [WM_PAINT](/windows/win32/gdi/wm-paint) 메시지가 전송될 때 페인팅으로 표시됩니다.

*bErase가* 업데이트 영역의 모든 부분에 TRUE인 경우 지정된 부분뿐만 아니라 전체 영역의 배경이 지워집니다.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>콜레 컨트롤::이스컨변환VBX

OLE 컨트롤을 특수로 로드할 수 있습니다.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Return Value

컨트롤이 변환되는 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

VBX 컨트롤을 사용하는 양식을 OLE 컨트롤을 사용하는 형식으로 변환할 때 OLE 컨트롤에 대한 특수 로드 코드가 필요할 수 있습니다. 예를 들어 OLE 컨트롤의 인스턴스를 로드하는 경우 `DoPropExchange`다음 의 [PX_Font](persistence-of-ole-controls.md#px_font) 호출할 수 있습니다.

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

그러나 VBX 컨트롤에는 Font 개체가 없습니다. 각 글꼴 속성이 개별적으로 저장되었습니다. 이 경우 다음 두 `IsConvertingVBX` 경우를 구분하는 데 사용합니다.

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

또 다른 경우는 VBX 컨트롤이 독점 이진 데이터(VBM_SAVEPROPERTY 메시지 처리기)에 저장하고 OLE 컨트롤이 이진 데이터를 다른 형식으로 저장하는 경우입니다. OLE 컨트롤이 VBX 컨트롤과 이전 버전과 호환되도록 하려면 VBX 컨트롤 또는 `IsConvertingVBX` OLE 컨트롤이 로드되고 있는지 여부를 구분하여 함수를 사용하여 이전 형식과 새 형식을 모두 읽을 수 있습니다.

컨트롤의 `DoPropExchange` 함수에서 이 조건을 확인하고 true인 경우 이전 예제와 같이 이 변환과 관련된 로드 코드를 실행할 수 있습니다. 컨트롤이 변환되지 않는 경우 일반 로드 코드를 실행할 수 있습니다. 이 기능은 VBX 대응에서 변환되는 컨트롤에만 적용됩니다.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>콜레 컨트롤:::이인보크허용

자동화 메서드 호출을 활성화합니다.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Return Value

컨트롤이 초기화된 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

지정된 `IDispatch::Invoke` 함수(식별)가 `IsInvokeAllowed` `dispid`호출될 수 있는지 여부를 결정하기 위한 프레임워크의 호출 구현입니다. OLE 컨트롤의 기본 동작은 컨트롤이 초기화된 경우에만 자동화 메서드를 호출할 수 있도록 하는 것입니다. 그러나 `IsInvokeAllowed` 가상 함수이며 필요한 경우 재정의될 수 있습니다(예: 컨트롤이 자동화 서버로 사용되는 경우).

## <a name="colecontrolismodified"></a><a name="ismodified"></a>콜레 컨트롤::수정되었습니다.

컨트롤의 상태가 수정되었는지 확인합니다.

```
BOOL IsModified();
```

### <a name="return-value"></a>Return Value

컨트롤이 마지막으로 저장된 이후 수정된 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

속성값이 변경될 때 컨트롤의 상태가 수정됩니다.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>콜레 컨트롤::최적화된 그리기

컨테이너가 현재 도면 작업에 최적화된 도면을 지원하는지 여부를 결정합니다.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Return Value

TRUE 컨테이너가 현재 도면 작업에 최적화된 도면을 지원하는 경우; 그렇지 않으면 거짓.

### <a name="remarks"></a>설명

최적화된 도면이 지원되는 경우 드로잉이 완료되면 컨트롤에서 이전 객체(펜, 브러시, 글꼴 등)를 장치 컨텍스트에 선택할 필요가 없습니다.

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>콜레 컨트롤::IsSubclassControl

컨트롤이 Windows 컨트롤을 하위 클래스로 지정하는지 여부를 확인하기 위해 프레임워크에서 호출합니다.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Return Value

컨트롤이 하위 클래스인 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

OLE 컨트롤이 Windows 컨트롤을 하위 클래스로 지정하는 경우 이 함수를 재정의하고 TRUE를 반환해야 합니다.

## <a name="colecontrolload"></a><a name="load"></a>콜레 제어 ::로드

비동기적으로 로드된 이전 데이터를 재설정하고 컨트롤의 비동기 속성에 대한 새 로드를 시작합니다.

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>매개 변수

*strNewPath*<br/>
비동기 제어 속성의 절대 위치를 참조하는 경로를 포함하는 문자열에 대한 포인터입니다.

*소품*<br/>
비동기 제어 속성을 구현하는 [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) 개체입니다.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>콜레 컨트롤::록인플레이스액티브

컨테이너가 컨트롤을 비활성화하지 못하도록 합니다.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>매개 변수

*블록*<br/>
TRUE 컨트롤의 현재 상태 활성 상태가 잠겨있는 경우; FALSE를 잠금 해제할 수 있는 경우.

### <a name="return-value"></a>Return Value

잠금이 성공한 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

컨트롤의 모든 잠금은 완료되면 컨트롤의 잠금 해제와 페어링되어야 합니다. 이벤트를 발생하는 동안과 같이 짧은 기간 동안만 컨트롤을 잠글 수 있습니다.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>콜레 컨트롤::온앰비언트속성체인지

컨테이너의 앰비언트 속성이 값을 변경했을 때 프레임워크에서 호출됩니다.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>매개 변수

*dispID*<br/>
변경된 주변 속성의 디스패치 ID 또는 여러 속성이 변경된 경우 DISPID_UNKNOWN.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>콜레 컨트롤::에 외관 변경

주식 모양 속성 값이 변경 된 경우 프레임 워크에 의해 호출 됩니다.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>설명

이 속성이 변경된 후 알림을 받으면 이 함수를 재정의합니다. 기본 구현은 `InvalidateControl`을 호출합니다.

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>콜레 컨트롤::온백컬러 변경

주식 BackColor 속성 값이 변경 된 경우 프레임 워크에 의해 호출 됩니다.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>설명

이 속성이 변경된 후 알림을 받으면 이 함수를 재정의합니다. 기본 구현은 `InvalidateControl`을 호출합니다.

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>콜레 컨트롤::온보더 스타일 변경

주식 BorderStyle 속성 값이 변경 된 경우 프레임 워크에 의해 호출 됩니다.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>설명

기본 구현은 `InvalidateControl`을 호출합니다.

이 속성이 변경된 후 알림을 받으면 이 함수를 재정의합니다.

## <a name="colecontrolonclick"></a><a name="onclick"></a>콜레 컨트롤 ::온클릭

마우스 단추를 클릭했거나 DoClick stock 메서드가 호출되었을 때 프레임워크에서 호출됩니다.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>매개 변수

*iButton*<br/>
마우스 단추의 인덱스입니다. 다음 값 중 하나가 될 수 있습니다.

- LEFT_BUTTON 왼쪽 마우스 버튼을 클릭했습니다.

- MIDDLE_BUTTON 가운데 마우스 버튼을 클릭했습니다.

- RIGHT_BUTTON 오른쪽 마우스 버튼을 클릭했습니다.

### <a name="remarks"></a>설명

기본 구현은 `COleControl::FireClick`을 호출합니다.

기본 처리를 수정하거나 확장하려면 이 멤버 함수를 재정의합니다.

## <a name="colecontrolonclose"></a><a name="onclose"></a>콜레 컨트롤::온클로즈

컨테이너가 컨트롤의 `IOleControl::Close` 함수를 호출할 때 프레임워크에서 호출됩니다.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>매개 변수

*dwSaveOption*<br/>
로드하기 전에 개체를 저장할지 여부를 나타내는 플래그입니다. 유효한 값은 다음과 같습니다.

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>설명

기본적으로 컨트롤 `OnClose` 개체가 수정되고 *dwSaveOption이* OLECLOSE_SAVEIFDIRTY 또는 OLECLOSE_PROMPTSAVE 경우 컨트롤 개체를 저장합니다.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>콜레 컨트롤::온도버브

컨테이너가 멤버 함수를 호출할 때 프레임워크에서 호출됩니다. `IOleObject::DoVerb`

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*iVerb*<br/>
호출할 컨트롤 동사의 인덱스입니다.

*lpMsg*<br/>
동사를 호출하는 원인이 된 Windows 메시지에 대한 포인터입니다.

*hWnd부모*<br/>
컨트롤의 상위 창에 대한 핸들입니다. 동사의 실행이 창(또는 창)을 만드는 경우 *hWndParent를* 부모로 사용해야 합니다.

*Lprect*<br/>
컨테이너를 기준으로 컨트롤의 좌표를 복사하는 RECT 구조에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

호출이 성공한 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

기본 구현에서는 ON_OLEVERB 및 ON_STDOLEVERB 메시지 맵 항목을 사용하여 호출할 적절한 함수를 결정합니다.

이 함수를 재정의하여 동사의 기본 처리를 변경합니다.

## <a name="colecontrolondraw"></a><a name="ondraw"></a>콜레 컨트롤::에 그리기

지정된 장치 컨텍스트를 사용하여 지정된 경계 사각형에서 OLE 컨트롤을 그리려면 프레임워크에서 호출합니다.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
도면이 발생하는 장치 컨텍스트입니다.

*rcBounds*<br/>
테두리를 포함한 컨트롤의 직사각형 영역입니다.

*rcInvalid*<br/>
컨트롤의 사각형 영역이 잘못되었습니다.

### <a name="remarks"></a>설명

`OnDraw`일반적으로 화면 장치 컨텍스트를 *pDC로*전달하는 화면 표시에 대해 호출됩니다. *rcBounds* 매개 변수는 대상 장치 컨텍스트에서 사각형을 식별합니다(현재 매핑 모드에 상대). *rcInvalid* 매개 변수는 유효하지 않은 실제 사각형입니다. 경우에 따라 *rcBounds*보다 작은 영역이 됩니다.

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>콜레 컨트롤::온드로우메타파일

지정된 메타파일 장치 컨텍스트를 사용하여 지정된 경계 사각형에서 OLE 컨트롤을 그리려면 프레임워크에서 호출합니다.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
도면이 발생하는 장치 컨텍스트입니다.

*rcBounds*<br/>
테두리를 포함한 컨트롤의 직사각형 영역입니다.

### <a name="remarks"></a>설명

기본 구현은 [OnDraw](#ondraw) 함수를 호출합니다.

## <a name="colecontrolonedit"></a><a name="onedit"></a>콜레 컨트롤::온에더트

컨트롤을 UI활성화합니다.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*lpMsg*<br/>
동사를 호출하는 Windows 메시지에 대한 포인터입니다.

*hWnd부모*<br/>
컨트롤의 상위 창에 대한 핸들입니다.

*Lprect*<br/>
컨테이너의 컨트롤에서 사용하는 사각형에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

호출이 성공하면 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

컨트롤의 OLEIVERB_UIACTIVATE 동사를 호출하는 것과 동일한 효과가 있습니다.

이 함수는 일반적으로 ON_OLEVERB 메시지 맵 항목에 대한 처리기 함수로 사용됩니다. 이렇게 하면 컨트롤의 "개체" 메뉴에서 "편집" 동사를 사용할 수 있습니다. 다음은 그 예입니다.

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COleControl::에 활성화변경

주식 사용 속성 값이 변경 된 경우 프레임 워크에 의해 호출 됩니다.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>설명

이 속성이 변경된 후 알림을 받으면 이 함수를 재정의합니다. 기본 구현호출 [InvalidateControl](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>콜레 컨트롤::오네눔베브

컨테이너가 멤버 함수를 호출할 때 프레임워크에서 호출됩니다. `IOleObject::EnumVerbs`

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>매개 변수

*ppenumOleVerb*<br/>
컨트롤의 `IEnumOLEVERB` 동사를 연수하는 개체에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

동사를 사용할 수 있는 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

기본 구현은 메시지 맵의 ON_OLEVERB 항목을 개과시합니다.

이 함수를 재정의하여 동사를 열거하는 기본 방법을 변경합니다.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>콜레 컨트롤::온이벤트어드

이벤트 처리기가 OLE 컨트롤에 연결되거나 연결이 끊어지면 프레임워크에서 호출됩니다.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>매개 변수

*bAdvise*<br/>
TRUE는 이벤트 처리기가 컨트롤에 연결되었음을 나타냅니다. FALSE는 이벤트 처리기가 컨트롤에서 연결이 끊어졌음을 나타냅니다.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>콜레 컨트롤::온폰트 변경

스톡 Font 속성 값이 변경된 경우 프레임워크에서 호출합니다.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>설명

기본 구현은 `COleControl::InvalidateControl`을 호출합니다. 컨트롤이 Windows 컨트롤을 하위 분류하는 경우 기본 구현에서는 컨트롤의 창에 WM_SETFONT 메시지도 보냅니다.

이 속성이 변경된 후 알림을 받으면 이 함수를 재정의합니다.

### <a name="example"></a>예제

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>콜레 컨트롤::에포컬러 변경

주식 ForeColor 속성 값이 변경 된 경우 프레임 워크에 의해 호출 됩니다.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>설명

기본 구현은 `InvalidateControl`을 호출합니다.

이 속성이 변경된 후 알림을 받으면 이 함수를 재정의합니다.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>콜레 컨트롤:::온프리즈 이벤트

컨테이너 호출 후 프레임 `IOleControl::FreezeEvents`워크에 의해 호출 됩니다.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>매개 변수

*bFreeze*<br/>
컨트롤의 이벤트 처리가 고정된 경우 TRUE입니다. 그렇지 않으면 거짓.

### <a name="remarks"></a>설명

기본 구현은 아무 작업도 수행하지 않습니다.

이벤트 처리가 고정되거나 고정해제될 때 추가 동작을 원하는 경우 이 함수를 재정의합니다.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>콜레 컨트롤::온겟컬러세트

컨테이너가 멤버 함수를 호출할 때 프레임워크에서 호출됩니다. `IViewObject::GetColorSet`

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>매개 변수

*ptd*<br/>
그림을 렌더링해야 하는 대상 장치를 가리킵니다. 이 값이 NULL이면 그림은 기본 대상 장치(일반적으로 표시 장치)에 대해 렌더링되어야 합니다.

*hicTargetDev*<br/>
*ptd로*표시된 대상 장치의 정보 컨텍스트를 지정합니다. 이 매개 변수는 장치 컨텍스트일 수 있지만 반드시 그런 것은 아닙니다. *ptd가* NULL이면 *hicTargetDev도* NULL이어야 합니다.

*ppColorSet*<br/>
사용할 색상 집합을 복사해야 하는 위치에 대한 포인터입니다. 함수가 색상 집합을 반환하지 않으면 NULL이 반환됩니다.

### <a name="return-value"></a>Return Value

유효한 색상 집합이 반환되는 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

컨테이너는 OLE 컨트롤을 그리는 데 필요한 모든 색상을 얻기 위해 이 함수를 호출합니다. 컨테이너는 전체 색상 팔레트를 설정하는 데 필요한 색상과 함께 얻은 색상 집합을 사용할 수 있습니다. 기본 구현은 FALSE를 반환합니다.

이 요청의 특수 처리를 수행하려면 이 함수를 재정의합니다.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>콜레 컨트롤::온겟컨트롤정보

컨트롤의 컨테이너가 컨트롤에 대한 정보를 요청한 경우 프레임워크에서 호출됩니다.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>매개 변수

*pControlInfo*<br/>
채울 [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) 구조에 대한 포인터입니다.

### <a name="remarks"></a>설명

이 정보는 주로 컨트롤의 니모닉 키에 대한 설명으로 구성됩니다. 기본 구현은 *pControlInfo를* 기본 정보로 채웁니다.

컨트롤에서 니모닉 키를 처리해야 하는 경우 이 함수를 재정의합니다.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>콜레 컨트롤::온겟디스플레이 스트링

*dispid로*식별된 속성의 현재 값을 나타내는 문자열을 얻기 위해 프레임워크에서 호출합니다.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>매개 변수

*디스피드 (것)들*<br/>
컨트롤의 속성에 대한 디스패치 ID입니다.

*strValue*<br/>
문자열이 반환되는 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 개체에 대한 참조입니다.

### <a name="return-value"></a>Return Value

strValue에서 문자열이 반환된 경우 0이 아닌 *0입니다.*

### <a name="remarks"></a>설명

컨트롤에 값을 문자열로 직접 변환할 수 없는 속성이 있고 속성값을 컨테이너 제공 속성 브라우저에 표시하려는 경우 이 함수를 재정의합니다.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>콜레 컨트롤::온겟인플레이스메뉴

컨트롤이 UI 활성화될 때 프레임워크에서 호출하여 컨테이너의 기존 메뉴에 병합할 메뉴를 가져옵니다.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Return Value

컨트롤의 메뉴 핸들 또는 컨트롤에 없는 경우 NULL입니다. 기본 구현은 NULL을 반환합니다.

### <a name="remarks"></a>설명

OLE 리소스 병합에 대한 자세한 내용은 [OLE(메뉴 및 리소스)](../../mfc/menus-and-resources-ole.md)문서를 참조하십시오.

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>콜레 컨트롤::온겟내추럴익스

컨테이너의 요청에 대한 응답으로 프레임워크에서 `IViewObjectEx::GetNaturalExtent` 호출됩니다.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>매개 변수

*dwAspect*<br/>
개체를 표현할 방법을 지정합니다. 표현에는 콘텐츠, 아이콘, 축소판 그림 또는 인쇄된 문서가 포함됩니다. 유효한 값은 [열거형 DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져온 값입니다.

*lindex*<br/>
관심 있는 개체의 부분입니다. 현재 -1만 유효합니다.

*ptd*<br/>
개체의 크기를 반환해야 하는 대상 장치를 정의하는 [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) 구조를 가리킵니다.

*hicTargetDev*<br/>
개체가 장치 메트릭을 추출하고 장치의 기능을 테스트할 수 있는 *ptd* 매개 변수로 표시된 대상 장치에 대한 정보 컨텍스트를 지정합니다. *ptd가* NULL이면 개체는 *hicTargetDev* 매개 변수의 값을 무시해야 합니다.

*pExtentInfo*<br/>
크기 조정 `DVEXTENTINFO` 데이터를 지정하는 구조를 가리킵니다. 구조는 다음과 같은 것입니다. `DVEXTENTINFO`

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

구조멤버는 `dwExtentMode` 다음 두 값 중 하나를 사용할 수 있습니다.

- DVEXTENT_CONTENT 컨트롤이 콘텐츠에 정확히 맞게 얼마나 큰지 문의하십시오(스냅 투 사이즈)

- DVEXTENT_INTEGRAL 크기를 조정할 때 제안된 크기를 전달하여

*psizel*<br/>
컨트롤에 의해 반환되는 데이터의 크기 조정을 가리킵니다. 반환된 크기 조정 데이터는 조정되지 않은 모든 차원에 대해 -1로 설정됩니다.

### <a name="return-value"></a>Return Value

비영이 성공적으로 크기를 반환하거나 조정하는 경우; 그렇지 않으면 0.

### <a name="remarks"></a>설명

`DVEXTENTINFO` 이 함수를 재정의하여 오브젝트의 표시 크기를 구조에서 제안된 크기 및 익스텐트 모드에 가장 가깝게 반환합니다. 기본 구현은 FALSE를 반환하고 크기를 조정하지 않습니다.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COle Control::OnGet사전정의된 스트링

속성에 대 한 가능한 값을 나타내는 미리 정의 된 문자열 집합을 얻기 위해 프레임 워크에 의해 호출 됩니다.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>매개 변수

*디스피드 (것)들*<br/>
컨트롤의 속성에 대한 디스패치 ID입니다.

*pStringArray*<br/>
반환 값으로 채울 문자열 배열입니다.

*pCookieArray*<br/>
반환 값으로 채울 DWORD 배열입니다.

### <a name="return-value"></a>Return Value

*pStringArray* 및 *pCookieArray에*요소가 추가된 경우 0이 아닙니다.

### <a name="remarks"></a>설명

컨트롤에 문자열로 나타낼 수 있는 가능한 값 집합이 있는 속성이 있는 경우 이 함수를 재정의합니다. *pStringArray에*추가 된 각 요소에 대해 *pCookieArray에* 해당 "쿠키" 요소를 추가해야 합니다. 이러한 "쿠키" 값은 나중에 프레임워크에 `COleControl::OnGetPredefinedValue` 의해 함수에 전달될 수 있습니다.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COle Control::OnGetPredefined값

의 재정의에 의해 이전에 반환 된 미리 정의 된 문자열 중 `COleControl::OnGetPredefinedStrings`하나에 해당하는 값을 얻기 위해 프레임 워크에 의해 호출 .

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>매개 변수

*디스피드 (것)들*<br/>
컨트롤의 속성에 대한 디스패치 ID입니다.

*dwCookie*<br/>
의 재정의에 의해 이전에 `COleControl::OnGetPredefinedStrings`반환된 쿠키 값입니다.

*lpvarOut*<br/>
속성 값이 `VARIANT` 반환되는 구조에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

*값이 lpvarOut에서*반환된 경우 비영; 그렇지 않으면 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>콜레 컨트롤::온겟뷰익

컨테이너의 [IViewObject2:GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) 요청에 대한 응답으로 프레임워크에서 호출됩니다.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>매개 변수

*dwDrawAspect*<br/>
개체의 어떤 형태 또는 측면을 표시할지 설명하는 DWORD입니다. 유효한 값은 [열거형 DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져온 값입니다.

*lindex*<br/>
관심 있는 개체의 부분입니다. 현재 -1만 유효합니다.

*ptd*<br/>
개체의 크기를 반환해야 하는 대상 장치를 정의하는 [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) 구조를 가리킵니다.

*lpsizel*<br/>
개체의 크기가 반환되는 위치를 가리킵니다.

### <a name="return-value"></a>Return Value

익스텐트 정보가 성공적으로 반환되는 경우 비영; 그렇지 않으면 0.

### <a name="remarks"></a>설명

컨트롤이 2패스 드로잉을 사용하고 불투명하고 투명한 부품의 치수가 다른 경우 이 함수를 재정의합니다.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>콜레 컨트롤::온겟뷰렉트

컨테이너의 요청에 대한 응답으로 프레임워크에서 `IViewObjectEx::GetRect` 호출됩니다.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>매개 변수

*dwAspect*<br/>
개체의 어떤 형태 또는 측면을 표시할지 설명하는 DWORD입니다. 유효한 값은 [열거형 DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져온 것입니다.

- 전체 개체의 DVASPECT_CONTENT 경계 사각형입니다. 오브젝트의 원점에서 왼쪽 상단 모서리와 크기는 에서 `GetViewExtent`반환되는 범위와 *같습니다.*

- DVASPECT_OPAQUE 사각형 불투명 영역이 있는 오브젝트는 해당 사각형을 반환합니다. 다른 사람들은 실패합니다.

- 모든 투명 하거나 불규칙 한 부분을 덮는 사각형을 DVASPECT_TRANSPARENT.

*pRect*<br/>
객체를 그려야 하는 사각형을 지정하는 [RECTL](/windows/win32/api/windef/ns-windef-rectl) 구조를 가리킵니다. 이 매개변수는 오브젝트의 위치 지정 및 스트레칭을 제어합니다.

### <a name="return-value"></a>Return Value

개체에 크기가 큰 사각형이 성공적으로 반환되는 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

개체의 크기는 특정 위치에서 `OnGetViewRect` 시작하는 사각형으로 변환됩니다(기본값은 디스플레이의 왼쪽 위 모서리). 컨트롤이 2패스 드로잉을 사용하고 불투명하고 투명한 부품의 치수가 다른 경우 이 함수를 재정의합니다.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>콜레 컨트롤::온겟뷰상태

컨테이너의 요청에 대한 응답으로 프레임워크에서 `IViewObjectEx::GetViewStatus` 호출됩니다.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Return Value

성공한 경우 VIEWSTATUS 열거형의 값 중 하나입니다. 그렇지 않으면 0. 가능한 값은 다음의 모든 조합입니다.

|||
|-|-|
|VIEWSTATUS_OPAQUE|개체가 완전히 불투명합니다. 이 비트가 설정되지 않은 경우 오브젝트에 투명 부품이 포함됩니다. 이 비트는 콘텐츠 관련 측면에만 적용되며 DVASPECT_ICON DVASPECT_DOCPRINT 않습니다.|
|VIEWSTATUS_SOLIDBKGND|오브젝트에는 단색 배경이 있습니다(브러시 패턴이 아닌 단색으로 구성). 이 비트는 VIEWSTATUS_OPAQUE 설정되어 콘텐츠 관련 측면에만 적용되고 DVASPECT_ICON DVASPECT_DOCPRINT 않는 경우에만 의미가 있습니다.|
|VIEWSTATUS_DVASPECTOPAQUE|개체는 DVASPECT_OPAQUE 지원합니다. 그리기 측면을 매개 변수로 하는 모든 IViewObjectEx 메서드를 이 측면으로 호출할 수 있습니다.|
|VIEWSTATUS_DVASPECTTRANSPARENT|개체는 DVASPECT_TRANSPARENT 지원합니다. 드로잉 `IViewObjectEx` 측면을 매개변수로 하는 모든 메서드를 이 측면으로 호출할 수 있습니다.|

### <a name="remarks"></a>설명

컨트롤에서 2패스 드로잉을 사용하는 경우 이 함수를 재정의합니다. 기본 구현은 VIEWSTATUS_OPAQUE 반환합니다.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>콜레 컨트롤::온하이드툴바

컨트롤이 UI비활성화될 때 프레임워크에서 호출됩니다.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>설명

구현은 에 표시된 모든 `OnShowToolbars`도구 모음을 숨겨야 합니다.

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>콜레 컨트롤::에니액티브마우스무브

WM_MOUSEMOVE 메시지를 수신할 때 마우스 포인터 아래의 비활성 개체에 대한 컨테이너에서 호출합니다.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>매개 변수

*lprcBounds*<br/>
포함된 창의 클라이언트 좌표에서 사각형을 경계하는 개체입니다. WM_MOUSEMOVE 메시지가 수신되었을 때 개체의 정확한 위치와 크기를 화면에 알려줍니다.

*x*<br/>
포함된 창의 클라이언트 좌표에서 마우스 위치의 x 좌표입니다.

*Y*<br/>
포함된 창의 클라이언트 좌표에서 마우스 위치의 y 좌표입니다.

*dwKeyState*<br/>
키보드에서 키보드 수정자 키의 현재 상태를 식별합니다. 유효한 값은 MK_CONTROL 플래그, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON 및 MK_RBUTTON 조합일 수 있습니다.

### <a name="remarks"></a>설명

창 클라이언트 좌표(픽셀)는 마우스 커서 위치를 전달하는 데 사용됩니다. 이는 동일한 좌표계에서 오브젝트의 경계 사각형도 전달하여 가능합니다.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>콜레 컨트롤::에온액티브셋세트커서

WM_SETCURSOR 메시지를 수신할 때 마우스 포인터 아래의 비활성 개체에 대한 컨테이너에서 호출합니다.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>매개 변수

*lprcBounds*<br/>
포함된 창의 클라이언트 좌표에서 사각형을 경계하는 개체입니다. WM_SETCURSOR 메시지가 수신되었을 때 개체의 정확한 위치와 크기를 화면에 알려줍니다.

*x*<br/>
포함된 창의 클라이언트 좌표에서 마우스 위치의 x 좌표입니다.

*Y*<br/>
포함된 창의 클라이언트 좌표에서 마우스 위치의 y 좌표입니다.

*dwMouseMsg*<br/>
WM_SETCURSOR 발생한 마우스 메시지의 식별자입니다.

*bSetAlways*<br/>
개체가 커서를 설정해야 하는지 여부를 지정합니다. TRUE이면 개체는 커서를 설정해야 합니다. FALSE인 경우 커서는 커서를 설정할 의무가 없으며 이 경우 S_FALSE 반환해야 합니다.

### <a name="return-value"></a>Return Value

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

창 클라이언트 좌표(픽셀)는 마우스 커서 위치를 전달하는 데 사용됩니다. 이는 동일한 좌표계에서 오브젝트의 경계 사각형도 전달하여 가능합니다.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>콜레 컨트롤::온키다운 이벤트

주식 KeyDown 이벤트가 처리된 후 프레임워크에서 호출됩니다.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>매개 변수

*Nchar*<br/>
누른 키의 가상 키 코드 값입니다. 표준 가상 키 코드 목록은 Winuser.h를 참조하십시오.

*nShiftState*<br/>
다음 플래그의 조합을 포함합니다.

- SHIFT_MASK SHIFT 키가 작업 중에 눌렀습니다.

- CTRL_MASK 작업 중에 CTRL 키를 눌렀습니다.

- ALT_MASK 작업 중에 ALT 키를 눌렀습니다.

### <a name="remarks"></a>설명

이벤트가 발생한 후 컨트롤이 키 정보에 액세스해야 하는 경우 이 함수를 재정의합니다.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>콜레 컨트롤::온키프레스이벤트

주식 KeyPress 이벤트가 발생한 후 프레임 워크에 의해 호출됩니다.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>매개 변수

*Nchar*<br/>
누른 키의 가상 키 코드 값을 포함합니다. 표준 가상 키 코드 목록은 Winuser.h를 참조하십시오.

### <a name="remarks"></a>설명

*nChar* 값은 컨테이너에 의해 수정되었을 수 있습니다.

이 이벤트가 발생한 후 알림을 받으면 이 함수를 재정의합니다.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>콜레 컨트롤::온키업 이벤트

주식 KeyDown 이벤트가 처리된 후 프레임워크에서 호출됩니다.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>매개 변수

*Nchar*<br/>
누른 키의 가상 키 코드 값입니다. 표준 가상 키 코드 목록은 Winuser.h를 참조하십시오.

*nShiftState*<br/>
다음 플래그의 조합을 포함합니다.

- SHIFT_MASK SHIFT 키가 작업 중에 눌렀습니다.

- CTRL_MASK 작업 중에 CTRL 키를 눌렀습니다.

- ALT_MASK 작업 중에 ALT 키를 눌렀습니다.

### <a name="remarks"></a>설명

이벤트가 발생한 후 컨트롤이 키 정보에 액세스해야 하는 경우 이 함수를 재정의합니다.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>콜레 컨트롤::온맵속성 토페이지

지정된 속성의 편집을 구현 하는 속성 페이지의 클래스 ID를 가져오려면 프레임 워크에서 호출 합니다.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>매개 변수

*디스피드 (것)들*<br/>
컨트롤의 속성에 대한 디스패치 ID입니다.

*lpclsid*<br/>
클래스 ID가 `CLSID` 반환되는 구조에 대한 포인터입니다.

*pbPageOptional*<br/>
지정된 속성 페이지의 사용이 선택 사항인지 여부를 나타내는 표시기를 반환합니다.

### <a name="return-value"></a>Return Value

클래스 ID가 *lpclsid로*반환된 경우 비영; 그렇지 않으면 0.

### <a name="remarks"></a>설명

이 함수를 재정의하여 컨테이너의 속성 브라우저에서 컨트롤의 속성 페이지를 호출하는 방법을 제공합니다.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>콜레 컨트롤::온네모닉

컨테이너가 OLE 컨트롤의 니모닉 키를 눌렀다는 것을 감지했을 때 프레임워크에서 호출합니다.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>매개 변수

*pMsg*<br/>
니모닉 키 누르기로 생성되는 Windows 메시지에 대한 포인터입니다.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>콜레 컨트롤::온프로퍼티

컨트롤의 속성 동사가 컨테이너에 의해 호출된 경우 프레임워크에서 호출합니다.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*lpMsg*<br/>
동사를 호출하는 Windows 메시지에 대한 포인터입니다.

*hWnd부모*<br/>
컨트롤의 상위 창에 대한 핸들입니다.

*Lprect*<br/>
컨테이너의 컨트롤에서 사용하는 사각형에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

호출이 성공하면 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

기본 구현에는 모달 속성 대화 상자가 표시됩니다.

이 함수를 사용하여 컨트롤의 속성 페이지가 표시될 수도 있습니다. *hWndParent* `OnProperties` 매개 변수에서 컨트롤의 부모의 핸들을 전달 하는 함수를 호출 합니다. 이 경우 *lpMsg* 및 *lpRect* 매개 변수의 값은 무시됩니다.

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>콜레 컨트롤::온쿼리히트포인트

컨테이너의 요청에 대한 응답으로 프레임워크에서 `IViewObjectEx::QueryHitPoint` 호출됩니다.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>매개 변수

*dwAspect*<br/>
개체가 표시되는 방법을 지정합니다. 유효한 값은 [열거형 DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져온 값입니다.

*pRectBounds*<br/>
OLE 제어 `RECT` 클라이언트 영역의 경계 사각형을 지정하는 구조에 대한 포인터입니다.

*ptlLoc*<br/>
적중을 `POINT` 확인할 점을 지정하는 구조에 대한 포인터입니다. 점은 OLE 클라이언트 영역 좌표에 지정됩니다.

*lCloseHint*<br/>
점에 "닫기"를 정의하는 거리가 적중을 확인했습니다.

*pHitResult*<br/>
조회 쿼리의 결과에 대한 포인터입니다. 해당 값은

- HITRESULT_OUTSIDE *ptlLoc은* OLE 개체 외부에 있고 닫히지 않습니다.

- HITRESULT_TRANSPARENT *ptlLoc은* OLE 개체의 경계 내에 있지만 이미지에 가깝지 않습니다. 예를 들어 투명 원의 중간에 있는 점은 HITRESULT_TRANSPARENT 수 있습니다.

- HITRESULT_CLOSE *ptlLoc은* OLE 개체 내부 또는 외부에 있지만 내부로 간주될 개체에 충분히 가깝습니다. 작고, 얇거나, 상세한 객체는 이 값을 사용할 수 있습니다. 점이 객체의 경계 사각형 외부에 있더라도 여전히 가까우면 (작은 오브젝트를 치는 데 필요합니다).

- HITRESULT_HIT *ptlLoc은* 개체의 이미지 내에 있습니다.

### <a name="return-value"></a>Return Value

적중 결과가 성공적으로 반환되는 경우 0이 아닙니다. 그렇지 않으면 0. 적중은 OLE 컨트롤 표시 영역과 겹칩니다.

### <a name="remarks"></a>설명

개체의 표시 사각형이 지정된 점과 겹치는지 여부를 쿼리합니다(점에 적중). `QueryHitPoint`직사각형이 아닌 오브젝트에 대한 적중을 테스트하기 위해 재정의할 수 있습니다.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>콜레 컨트롤::온쿼리히트렉트

컨테이너의 요청에 대한 응답으로 프레임워크에서 `IViewObjectEx::QueryHitRect` 호출됩니다.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>매개 변수

*dwAspect*<br/>
개체를 표현할 방법을 지정합니다. 유효한 값은 [열거형 DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져온 값입니다.

*pRectBounds*<br/>
OLE 제어 `RECT` 클라이언트 영역의 경계 사각형을 지정하는 구조에 대한 포인터입니다.

*prcLoc*<br/>
개체의 `RECT` 왼쪽 위 모서리를 기준으로 적중(개체 사각형과 겹치는)을 검사할 사각형을 지정하는 구조에 대한 포인터입니다.

*lCloseHint*<br/>
사용되지 않습니다.

*pHitResult*<br/>
조회 쿼리의 결과에 대한 포인터입니다. 해당 값은

- HITRESULT_OUTSIDE 사각형의 아무 소용이 OLE 개체에 의해 명중 되지 않습니다.

- 사각형의 하나 이상의 HITRESULT_HIT 개체에 대한 히트가 될 수 있습니다.

### <a name="return-value"></a>Return Value

적중 결과가 성공적으로 반환되는 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

개체의 표시 사각형이 지정된 사각형의 모든 지점과 겹치는지 여부를 쿼리합니다(직사각형 에 적중). `QueryHitRect`직사각형이 아닌 오브젝트에 대한 적중을 테스트하기 위해 재정의할 수 있습니다.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>콜레 컨트롤::온렌더 데이터

지정된 형식으로 데이터를 검색하는 프레임워크에서 호출됩니다.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>매개 변수

*lpFormatEtc*<br/>
정보가 요청되는 형식을 지정하는 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 구조를 가리킵니다.

*lpStgMedium*<br/>
데이터를 반환할 [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) 구조를 가리킵니다.

### <a name="return-value"></a>Return Value

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

지정된 형식은 지연 렌더링을 위해 [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) 또는 [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) 멤버 함수를 사용하여 컨트롤 개체에 이전에 배치된 형식입니다. 이 함수의 기본 `OnRenderFileData` 구현은 제공된 저장소 매체가 파일 또는 메모리인 경우 각각 호출하거나 `OnRenderGlobalData`호출합니다. 요청된 형식이 CF_METAFILEPICT 또는 영구 속성 집합 형식인 경우 기본 구현은 적절한 데이터를 렌더링하고 0이 아닌 값을 반환합니다. 그렇지 않으면 0을 반환하고 아무 것도 수행하지 않습니다.

*>>* TYMED_NULL 경우 stGMEDIUM를 할당하고 *lpFormatEtc->의해*지정된 대로 채워야 합니다. TYMED_NULL 않으면 STGMEDIUM가 데이터로 채워져야 합니다.

이 함수를 재정의하여 요청된 형식 및 매체로 데이터를 제공합니다. 데이터에 따라 이 함수의 다른 버전 중 하나를 대신 재정의할 수 있습니다. 데이터가 작고 크기가 고정된 경우 `OnRenderGlobalData`재정의합니다. 데이터가 파일에 있거나 크기가 가변인 경우 재정의합니다. `OnRenderFileData`

자세한 내용은 Windows `FORMATETC` SDK의 및 `STGMEDIUM` 구조를 참조하십시오.

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>콜레 컨트롤::온렌더파일데이터

저장소 매체가 파일일 때 지정된 형식으로 데이터를 검색하기 위해 프레임워크에서 호출합니다.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>매개 변수

*lpFormatEtc*<br/>
정보가 요청되는 형식을 지정하는 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 구조를 가리킵니다.

*pFile*<br/>
데이터를 렌더링할 [CFile](../../mfc/reference/cfile-class.md) 개체를 가리킵니다.

### <a name="return-value"></a>Return Value

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

지정된 형식은 지연된 렌더링을 위해 [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) 멤버 함수를 사용하여 컨트롤 개체에 이전에 배치된 형식입니다. 이 함수의 기본 구현은 단순히 FALSE를 반환합니다.

이 함수를 재정의하여 요청된 형식 및 매체로 데이터를 제공합니다. 데이터에 따라 이 함수의 다른 버전 중 하나를 대신 재정의할 수 있습니다. 여러 저장소 매체를 처리하려면 을 `OnRenderData`재정의합니다. 데이터가 파일에 있거나 크기가 가변인 경우 재정의합니다. `OnRenderFileData`

자세한 내용은 Windows `FORMATETC` SDK의 구조를 참조하십시오.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>콜레 컨트롤::온렌더글로벌데이터

지정된 저장소 매체가 전역 메모리인 경우 지정된 형식으로 데이터를 검색하기 위해 프레임워크에서 호출합니다.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>매개 변수

*lpFormatEtc*<br/>
정보가 요청되는 형식을 지정하는 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 구조를 가리킵니다.

*phGlobal*<br/>
데이터를 반환할 전역 메모리에 대한 핸들을 가리킵니다. 메모리가 할당되지 않은 경우 이 매개 변수는 NULL이 될 수 있습니다.

### <a name="return-value"></a>Return Value

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

지정된 형식은 지연된 렌더링을 위해 [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) 멤버 함수를 사용하여 컨트롤 개체에 이전에 배치된 형식입니다. 이 함수의 기본 구현은 단순히 FALSE를 반환합니다.

*phGlobal이* NULL이면 새 HGLOBAL을 할당하고 *phGlobal로*반환해야 합니다. 그렇지 않으면 phGlobal에서 지정한 *HGLOBAL은* 데이터로 채워야 합니다. HGLOBAL에 배치된 데이터 양은 메모리 블록의 현재 크기를 초과해서는 안 됩니다. 또한 블록을 더 큰 크기로 다시 할당할 수 없습니다.

이 함수를 재정의하여 요청된 형식 및 매체로 데이터를 제공합니다. 데이터에 따라 이 함수의 다른 버전 중 하나를 대신 재정의할 수 있습니다. 여러 저장소 매체를 처리하려면 을 `OnRenderData`재정의합니다. 데이터가 파일에 있거나 크기가 가변인 경우 재정의합니다. `OnRenderFileData`

자세한 내용은 Windows `FORMATETC` SDK의 구조를 참조하십시오.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>콜레 컨트롤::온리셋스테이트

컨트롤의 속성을 기본값으로 설정해야 하는 경우 프레임워크에서 호출합니다.

```
virtual void OnResetState();
```

### <a name="remarks"></a>설명

기본 구현호출 [DoPropExchange](#dopropexchange), `CPropExchange` 속성을 기본값으로 설정 하는 개체를 전달 합니다.

컨트롤 작성기는 이 재정의 가능한 OLE 컨트롤에 대한 초기화 코드를 삽입할 수 있습니다. 이 함수는 `IPersistStream::Load` 또는 `IPersistStorage::Load`를 먼저 호출하지 않고 [IPersistStream::load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) 또는 [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)가 실패하거나[IPersistStreamInit::InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) 또는 [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew)가 호출될 때 호출됩니다.

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>콜레 컨트롤::온셋클라이언트사이트

컨테이너가 컨트롤의 `IOleControl::SetClientSite` 함수를 호출할 때 프레임워크에서 호출됩니다.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>설명

기본적으로 데이터 `OnSetClientSite` 경로 속성이 로드되는지 여부를 확인하고 호출하는 경우 를 호출합니다. `DoDataPathPropExchange`

이 알림의 특수 처리를 수행하려면 이 함수를 재정의합니다. 특히 이 함수의 재정의는 기본 클래스를 호출해야 합니다.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>콜레 컨트롤::온셋 데이터

컨트롤의 데이터를 지정된 데이터로 바꾸기 위해 프레임워크에서 호출됩니다.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>매개 변수

*lpFormatEtc*<br/>
데이터의 형식을 지정하는 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 구조에 대한 포인터입니다.

*lpStgMedium*<br/>
데이터가 상주하는 [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) 구조에 대한 포인터입니다.

*bRelease*<br/>
컨트롤이 저장 매체를 해제해야 하는 경우 TRUE; FALSE 컨트롤이 저장소 매체를 해제하지 않아야 하는 경우.

### <a name="return-value"></a>Return Value

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

데이터가 영구 속성 집합 형식인 경우 기본 구현은 그에 따라 컨트롤의 상태를 수정합니다. 그렇지 않으면 기본 구현은 아무 것도 수행하지 않습니다. *bRelease가* TRUE이면 `ReleaseStgMedium` 호출이 이루어집니다. 그렇지 않으면 그렇지 않습니다.

이 함수를 재정의하여 컨트롤의 데이터를 지정된 데이터로 바꿉습니다.

자세한 내용은 Windows `FORMATETC` SDK의 및 `STGMEDIUM` 구조를 참조하십시오.

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>콜레 컨트롤::온셋익

[IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)에 대한 호출의 결과로 컨트롤의 익스텐을 변경해야 하는 경우 프레임워크에서 호출됩니다.

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>매개 변수

*lpSizeL*<br/>
HIMETRIC 단위로 `SIZEL` 표현된 컨트롤의 너비와 높이를 나타내기 위해 긴 정수를 사용하는 구조에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

크기 변경이 허용된 경우 0이 아닌 경우; 그렇지 않으면 0.

### <a name="remarks"></a>설명

기본 구현은 컨트롤 범위의 크기 조정을 처리합니다. 컨트롤이 활성 상태인 경우 컨테이너에 대한 `OnPosRectChanged` 호출이 이루어집니다.

이 함수를 재정의하여 컨트롤의 기본 크기 조정을 변경합니다.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>콜레 컨트롤::온셋오브젝트렉트

[IOleInPlaceObject::SetObjectRects에](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)대한 호출을 구현하기 위해 프레임워크에서 호출합니다.

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>매개 변수

*lpRectPos*<br/>
컨테이너를 기준으로 `RECT` 컨트롤의 새 위치와 크기를 나타내는 구조에 대한 포인터입니다.

*lpRectClip*<br/>
컨트롤을 `RECT` 클리핑할 직사각형 영역을 나타내는 구조에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

위치 조정이 수락된 경우 비영점; 그렇지 않으면 0.

### <a name="remarks"></a>설명

기본 구현은 컨트롤 창의 위치 조정 및 크기 조정을 자동으로 처리하고 TRUE를 반환합니다.

이 함수를 재정의하여 이 함수의 기본 동작을 변경합니다.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>콜레 컨트롤::온쇼툴바

컨트롤이 UI활성화되었을 때 프레임워크에서 호출됩니다.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>설명

기본 구현은 아무 작업도 수행하지 않습니다.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>콜레 컨트롤:::온텍스트 변경

주식 캡션 또는 Text 속성 값이 변경된 경우 프레임워크에서 호출합니다.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>설명

기본 구현은 `InvalidateControl`을 호출합니다.

이 속성이 변경된 후 알림을 받으면 이 함수를 재정의합니다.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>콜레 컨트롤::온윈도우리스메시지

컨테이너의 요청에 대한 응답으로 프레임워크에서 `IOleInPlaceObjectWindowless::OnWindowMessage` 호출됩니다.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>매개 변수

*메시지*<br/>
Windows에서 전달한 메시지 식별자입니다.

*wParam*<br/>
윈도우에 의해 전달로. 추가 메시지 관련 정보를 지정합니다. 이 매개 변수의 내용은 *msg* 매개 변수의 값에 따라 다릅니다.

*lParam*<br/>
윈도우에 의해 전달로. 추가 메시지 관련 정보를 지정합니다. 이 매개 변수의 내용은 *msg* 매개 변수의 값에 따라 다릅니다.

*plResult*<br/>
윈도우 결과 코드입니다. 메시지 처리 결과를 지정하고 보낸 메시지에 따라 다릅니다.

### <a name="return-value"></a>Return Value

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

창 없는 컨트롤에 대 한 창 메시지를 처리 합니다. `COleControl`'s는 `OnWindowlessMessage` 마우스 메시지 및 키보드 메시지 이외의 창 메시지에 사용해야 합니다. `COleControl`에서는 창없는 OLE 개체에 대한 마우스 캡처 및 키보드 포커스를 얻기 위해 [SetCapture](#setcapture) 및 [SetFocus를](#setfocus) 제공합니다.

창 없는 개체에는 창이 없기 때문에 컨테이너가 메시지를 디스패치할 수 있는 메커니즘이 필요합니다. 창 없는 OLE 개체는 `OnWindowMessage` `IOleInPlaceObjectWindowless` 인터페이스의 메서드(창 없는 지원을 위한 [IOleInPlaceObject의](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) 확장)를 통해 컨테이너에서 메시지를 가져옵니다. `OnWindowMessage`매개 변수를 `HWND` 사용하지 않습니다.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>콜레컨트롤::P렌트토클라이언트

*pPoint의* 좌표를 클라이언트 좌표로 변환합니다.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>매개 변수

*lprcBounds*<br/>
컨테이너 내의 OLE 컨트롤 경계에 대한 포인터입니다. 클라이언트 영역이 아니라 테두리와 스크롤 막대를 포함한 전체 컨트롤 영역입니다.

*pPoint*<br/>
컨트롤의 클라이언트 영역의 좌표로 변환할 부모(컨테이너) 점에 대한 포인터입니다.

*bHitTest*<br/>
적중 테스트가 지점에서 수행될지 여부를 지정합니다.

### <a name="return-value"></a>Return Value

*bHitTest가* FALSE이면 HTNOWHERE를 반환합니다. *bHitTest가* TRUE이면 부모(컨테이너) 점이 OLE 컨트롤의 클라이언트 영역에 착륙한 위치를 반환하고 다음 마우스 적중 테스트 값 중 하나입니다.

- HTBORDER 크기 테두리가 없는 창의 테두리입니다.

- HTBOTTOM 창의 아래쪽 수평 테두리에 있습니다.

- HTBOTTOMLEFT 창 테두리의 왼쪽 아래 모서리에 있습니다.

- HTBOTTOMRIGHT 창 테두리의 오른쪽 아래 모서리에 있습니다.

- HT캡션 제목 표시줄 영역에서.

- 클라이언트 영역에서 HTCLIENT.

- HTERROR 화면 배경 또는 창 사이의 구분선에 `DefWndProc` (Windows 함수가 오류를 나타내는 시스템 비프음을 생성하는 것을 제외하고 는 HTNOWHERE와 동일).

- HTGROWBOX 크기 상자에.

- HTH스크롤 가로 스크롤 막대에서.

- HTLEFT 창의 왼쪽 테두리에 있습니다.

- HTMAXBUTTON 최대화 버튼에서.

- 메뉴 영역에서 HTMENU.

- HTMINBUTTON 최소화 버튼.

- HTNOWHERE 화면 배경 또는 창 사이의 구분선에.

- 최소화 버튼에서 HTREDUCE.

- HTRIGHT 창의 오른쪽 테두리에 있습니다.

- HTSIZE 크기 상자 (HTGROWBOX와 동일).

- HTSYSMENU 컨트롤 메뉴 또는 자식 창의 닫기 단추에서.

- HTTOP 창의 위쪽 수평 테두리에 있습니다.

- HTTOPLEFT 창 테두리의 왼쪽 위 모서리에 있습니다.

- HTTOPRIGHT 창 테두리의 오른쪽 위 모서리에 있습니다.

- HT투명 현재 다른 창으로 덮여 있는 창에서.

- HTV스크롤 세로 스크롤 막대에서.

- HTZOOM 최대화 버튼에서.

### <a name="remarks"></a>설명

입력 *pPoint는* 상위의 원점(컨테이너의 왼쪽 위 모서리)을 기준으로 합니다. 출력 *pPoint는* OLE 컨트롤의 클라이언트 영역의 원본(컨트롤의 클라이언트 영역의 왼쪽 위 모서리)을 기준으로 합니다.

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>콜레컨트롤::P모달디아로그

모달 대화 상자가 닫혔다는 것을 컨테이너에 알게 합니다.

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>매개 변수

*hWnd부모*<br/>
모달 대화 상자의 상위 창을 처리합니다.

### <a name="remarks"></a>설명

모달 대화 상자를 표시한 후 이 함수를 호출합니다. 컨테이너에서 비활성화된 최상위 창을 사용하도록 설정할 수 있도록 `PreModalDialog`이 함수를 호출해야 합니다. 이 함수는 `PreModalDialog`에 대한 호출과 페어링되어야 합니다.

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>콜레컨트롤::P레모달디아로그

모달 대화 상자가 표시될 컨테이너에 알신합니다.

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>매개 변수

*hWnd부모*<br/>
모달 대화 상자의 상위 창을 처리합니다.

### <a name="remarks"></a>설명

모달 대화 상자를 표시하기 전에 이 함수를 호출합니다. 컨테이너가 모든 최상위 창을 사용하지 않도록 설정하려면 이 함수를 호출해야 합니다. 모달 대화 상자가 표시되면 다음 을 `PostModalDialog`호출해야 합니다.

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>콜레 컨트롤::다시 생성 제어 창

컨트롤의 창을 삭제하고 다시 만듭니다.

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>설명

창의 스타일 비트를 변경해야 하는 경우 이 필요가 있을 수 있습니다.

## <a name="colecontrolrefresh"></a><a name="refresh"></a>콜레 컨트롤::새로 고침

OLE 컨트롤을 다시 그립니다.

```cpp
void Refresh();
```

### <a name="remarks"></a>설명

이 함수는 기본 `COleControl` 클래스에서 Refresh라고 하는 스톡 메서드로 지원됩니다. 이렇게 하면 OLE 컨트롤의 사용자가 특정 시간에 컨트롤을 다시 그릴 수 있습니다. 이 방법에 대한 자세한 내용은 [ActiveX 컨트롤: 메서드](../../mfc/mfc-activex-controls-methods.md)를 참조하십시오.

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>콜레 컨트롤::릴리스 캡처

마우스 캡처를 해제합니다.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Return Value

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

컨트롤에 현재 마우스 캡처가 있는 경우 캡처가 해제됩니다. 그렇지 않으면 이 함수는 영향을 주지 않습니다.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>콜레 컨트롤::릴리스DC

창 없는 컨트롤의 컨테이너의 표시 장치 컨텍스트를 해제 하 여 다른 응용 프로그램에서 사용할 수 있는 장치 컨텍스트를 해제 합니다.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
릴리스할 컨테이너 장치 컨텍스트를 식별합니다.

### <a name="return-value"></a>Return Value

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

응용 프로그램은 `ReleaseDC` [GetDC에](#getdc)대한 각 호출을 호출해야 합니다.

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>콜레 컨트롤:::리부모 컨트롤윈도우

컨트롤의 부모를 설정합니다.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>매개 변수

*hWndOuter*<br/>
컨트롤 창의 핸들입니다.

*hWnd부모*<br/>
새 상위 창의 핸들입니다.

### <a name="remarks"></a>설명

이 함수를 호출하여 컨트롤 창의 부모를 재설정합니다.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>콜레 컨트롤::리셋스톡프롭스

`COleControl` 주식 속성의 상태를 기본값으로 초기화합니다.

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>설명

속성은 다음과 같습니다: 모양, 뒤로 색, 테두리 스타일, 캡션, 사용, 글꼴, 포어 컬러, hWnd 및 텍스트. 스톡 속성에 대한 설명은 [ActiveX 컨트롤: 주식 속성 추가](../../mfc/mfc-activex-controls-adding-stock-properties.md)를 참조하십시오.

을 사용하고 `ResetStockProps` `ResetVersion` 재정의하여 `COleControl::OnResetState`컨트롤의 이진 초기화 성능을 향상시킬 수 있습니다. 아래 예제를 참조하세요. 초기화 최적화에 대한 자세한 내용은 [ActiveX 컨트롤: 최적화를](../../mfc/mfc-activex-controls-optimization.md)참조하십시오.

### <a name="example"></a>예제

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COle Control::재설정

버전 번호를 지정된 값으로 초기화합니다.

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>매개 변수

*dwVersionDefault*<br/>
컨트롤에 할당할 버전 번호입니다.

### <a name="remarks"></a>설명

을 사용하고 `ResetVersion` `ResetStockProps` 재정의하여 `COleControl::OnResetState`컨트롤의 이진 초기화 성능을 향상시킬 수 있습니다. [리셋스톡프롭스](#resetstockprops)의 예제를 참조하십시오. 초기화 최적화에 대한 자세한 내용은 [ActiveX 컨트롤: 최적화를](../../mfc/mfc-activex-controls-optimization.md)참조하십시오.

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>콜레 컨트롤::스크롤 창

창 없는 OLE 개체가 화면의 내부 활성 이미지 내에서 영역을 스크롤할 수 있습니다.

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>매개 변수

*xAmount*<br/>
장치 단위의 가로 스크롤 양을 지정합니다. 이 매개 변수는 왼쪽으로 스크롤하려면 음수 값이어야 합니다.

*yAmount*<br/>
장치 단위의 세로 스크롤 양을 지정합니다. 위쪽으로 스크롤하려면 이 매개 변수가 음수 값이어야 합니다.

*Lprect*<br/>
포함 창의 클라이언트 좌표에서 스크롤할 OLE 개체의 클라이언트 영역 부분을 지정하는 [CRect](../../atl-mfc-shared/reference/crect-class.md) 개체 또는 RECT 구조를 가리킵니다. *lpRect가* NULL이면 전체 OLE 개체의 클라이언트 영역이 스크롤됩니다.

*lpClipRect*<br/>
클립할 `CRect` 사각형을 `RECT` 지정하는 개체 또는 구조를 가리킵니다. 사각형 내부의 픽셀만 스크롤됩니다. 사각형 외부의 비트는 *lpRect* 사각형에 있더라도 영향을 받지 않습니다. *lpClipRect가* NULL이면 스크롤 사각형에서 클리핑이 수행되지 않습니다.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>콜레 컨트롤::선택글꼴 개체

장치 컨텍스트에 글꼴을 선택합니다.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
장치 컨텍스트 개체에 대한 포인터입니다.

*fontHolder*<br/>
선택할 글꼴을 나타내는 [CFontHolder](../../mfc/reference/cfontholder-class.md) 개체에 대한 참조입니다.

### <a name="return-value"></a>Return Value

이전에 선택한 글꼴에 대한 포인터입니다. 호출자가 *fontHolder를* 사용하는 모든 그리기 작업을 완료하면 [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject)에 매개 변수로 전달하여 이전에 선택한 글꼴을 다시 선택해야 합니다.

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>콜레 컨트롤::셀렉트스톡폰트

장치 컨텍스트로 스톡 Font 속성을 선택합니다.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
글꼴을 선택할 장치 컨텍스트입니다.

### <a name="return-value"></a>Return Value

이전에 선택한 `CFont` 개체에 대한 포인터입니다. [CDC::SelectObject를](../../mfc/reference/cdc-class.md#selectobject) 사용하여 완료되면 이 글꼴을 장치 컨텍스트로 다시 선택해야 합니다.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COleControl::직렬화익

컨트롤에 할당된 디스플레이 공간의 상태를 직렬화하거나 초기화합니다.

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>매개 변수

*ar*<br/>
직렬화할 `CArchive` 개체입니다.

### <a name="remarks"></a>설명

을 `SerializeExtent`사용하고 `SerializeStockProps` `SerializeVersion` 재정의하여 `COleControl::Serialize`컨트롤의 이진 지속성 성능을 향상시킬 수 있습니다. 아래 예제를 참조하세요. 초기화 최적화에 대한 자세한 내용은 [ActiveX 컨트롤: 최적화를](../../mfc/mfc-activex-controls-optimization.md)참조하십시오.

### <a name="example"></a>예제

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COleControl::직렬화스톡프롭스

`COleControl` 모양, 백컬러, 테두리 스타일, 캡션, 사용 설정, 글꼴, ForeColor 및 텍스트 : 스톡 속성의 상태를 직렬화하거나 초기화합니다.

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>매개 변수

*ar*<br/>
직렬화할 `CArchive` 개체입니다.

### <a name="remarks"></a>설명

스톡 속성에 대한 설명은 [ActiveX 컨트롤: 주식 속성 추가](../../mfc/mfc-activex-controls-adding-stock-properties.md)를 참조하십시오.

을 `SerializeStockProps`사용하고 `SerializeExtent` `SerializeVersion` 재정의하여 `COleControl::Serialize`컨트롤의 이진 지속성 성능을 향상시킬 수 있습니다. 예를 들어 [Serialize익](#serializeextent)의 코드를 참조하십시오. 초기화 최적화에 대한 자세한 내용은 [ActiveX 컨트롤: 최적화를](../../mfc/mfc-activex-controls-optimization.md)참조하십시오.

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COle Control::직렬화반전

컨트롤의 버전 정보의 상태를 직렬화하거나 초기화합니다.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>매개 변수

*ar*<br/>
직렬화할 `CArchive` 개체입니다.

*dwVersionDefault*<br/>
컨트롤의 현재 버전 번호입니다.

*bConvert*<br/>
영구 데이터를 저장할 때 최신 형식으로 변환할지 또는 로드할 때와 동일한 형식으로 유지관리해야 하는지 여부를 나타냅니다.

### <a name="return-value"></a>Return Value

컨트롤의 버전 번호입니다. 지정된 아카이브가 로드되는 `SerializeVersion` 경우 해당 아카이브에서 로드된 버전을 반환합니다. 그렇지 않으면 현재 로드된 버전을 반환합니다.

### <a name="remarks"></a>설명

을 `SerializeVersion`사용하고 `SerializeExtent` `SerializeStockProps` 재정의하여 `COleControl::Serialize`컨트롤의 이진 지속성 성능을 향상시킬 수 있습니다. 예를 들어 [Serialize익](#serializeextent)의 코드를 참조하십시오. 초기화 최적화에 대한 자세한 내용은 [ActiveX 컨트롤: 최적화를](../../mfc/mfc-activex-controls-optimization.md)참조하십시오.

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>콜레 컨트롤 :: 세트 모양

컨트롤의 주식 모양 속성 값을 설정합니다.

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>매개 변수

*sAppearance*<br/>
컨트롤의 모양에 사용할 **짧은(VT_I2)** 값입니다. 값이 0이면 컨트롤의 모양을 플랫으로 설정하고 값이 1이면 컨트롤의 모양을 3D로 설정합니다.

### <a name="remarks"></a>설명

스톡 속성에 대한 자세한 내용은 [ActiveX 컨트롤: 속성](../../mfc/mfc-activex-controls-properties.md)을 참조하십시오.

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>콜레 컨트롤 ::세트 백 컬러

컨트롤의 Stock BackColor 속성 값을 설정합니다.

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>매개 변수

*dwBackColor*<br/>
컨트롤의 배경 그리기에 사용할 OLE_COLOR 값입니다.

### <a name="remarks"></a>설명

이 속성 및 기타 관련 속성 사용에 대한 자세한 내용은 [ActiveX 컨트롤: 속성](../../mfc/mfc-activex-controls-properties.md)을 참조하십시오.

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>콜레 컨트롤:::세트보더스타일

컨트롤의 스톡 BorderStyle 속성 값을 설정합니다.

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>매개 변수

*sBorderStyle*<br/>
컨트롤에 대 한 새 테두리 스타일; 0은 테두리가 없음을 나타내고 1은 일반 테두리를 나타냅니다.

### <a name="remarks"></a>설명

그러면 컨트롤 창이 다시 `OnBorderStyleChanged` 만들어지고 호출됩니다.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>콜레 컨트롤::세트캡처

컨트롤의 컨테이너 창이 컨트롤을 대신하여 마우스 캡처를 소유하게 합니다.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Return Value

이전에 마우스 `CWnd` 입력을 받은 창 개체에 대한 포인터입니다.

### <a name="remarks"></a>설명

컨트롤이 활성화되고 창이 없는 경우 이 함수로 인해 컨트롤의 컨테이너 창이 컨트롤을 대신하여 마우스 캡처를 소유하게 됩니다. 그렇지 않으면 이 함수로 인해 컨트롤 자체가 마우스 캡처(와 `CWnd::SetCapture`동일)를 소유하게 됩니다.

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>콜레 컨트롤::세트 컨트롤크기

OLE 제어 창의 크기를 설정하고 제어 사이트가 변경되고 있음을 컨테이너에 보올합니다.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>매개 변수

*Cx*<br/>
컨트롤의 새 너비를 픽셀 단위로 지정합니다.

*Cy*<br/>
컨트롤의 새 높이를 픽셀 단위로 지정합니다.

### <a name="return-value"></a>Return Value

호출이 성공한 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

이 함수는 컨트롤의 생성자에서 사용해서는 안 됩니다.

컨트롤 창의 모든 좌표는 컨트롤의 왼쪽 위 모서리를 기준으로 합니다.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>콜레 컨트롤::설정 가능

컨트롤의 주식 사용 속성 값을 설정합니다.

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>매개 변수

*bEnabled*<br/>
TRUE 컨트롤을 사용하도록 설정하려면 그렇지 않으면 거짓.

### <a name="remarks"></a>설명

이 속성을 설정 `OnEnabledChange` 한 후 호출 됩니다.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>콜레 컨트롤::설정 포커스

컨트롤의 컨테이너 창이 컨트롤을 대신하여 입력 포커스를 소유하게 합니다.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Return Value

이전에 입력 `CWnd` 포커스가 있었던 창 개체에 대한 포인터 또는 이러한 창이 없는 경우 NULL입니다.

### <a name="remarks"></a>설명

컨트롤이 활성화되고 창이 없는 경우 이 함수로 인해 컨트롤의 컨테이너 창이 컨트롤을 대신하여 입력 포커스를 소유하게 됩니다. 입력 포커스는 키보드 입력을 컨테이너의 창으로 향하게 하고 컨테이너는 이후의 모든 `SetFocus`키보드 메시지를 호출하는 OLE 개체로 디스패치합니다. 이전에 입력 포커스가 있었던 모든 창은 손실됩니다.

컨트롤이 창없는 경우 이 함수로 인해 컨트롤 자체가 입력 포커스(와 `CWnd::SetFocus`동일)를 소유하게 됩니다.

## <a name="colecontrolsetfont"></a><a name="setfont"></a>콜레 컨트롤::세트폰트

컨트롤의 스톡 Font 속성을 설정합니다.

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>매개 변수

*pFontDisp*<br/>
글꼴 디스패치 인터페이스에 대한 포인터입니다.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>콜레 컨트롤 ::세트 포어 컬러

컨트롤의 주식 ForeColor 속성 값을 설정합니다.

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>매개 변수

*dwForeColor*<br/>
컨트롤의 전경 도면에 사용할 OLE_COLOR 값입니다.

### <a name="remarks"></a>설명

이 속성 및 기타 관련 속성 사용에 대한 자세한 내용은 [ActiveX 컨트롤: 속성](../../mfc/mfc-activex-controls-properties.md)을 참조하십시오.

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COle Control::설정 초기 데이터 형식

컨트롤에서 지원하는 데이터 형식 목록을 초기화하기 위해 프레임워크에서 호출합니다.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>설명

기본 구현은 CF_METAFILEPICT 및 영구 속성 집합의 두 형식을 지정합니다.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>콜레 컨트롤::세트초기크기

컨테이너에 처음 표시될 때 OLE 컨트롤의 크기를 설정합니다.

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>매개 변수

*Cx*<br/>
OLE 컨트롤의 초기 너비를 픽셀 단위로 제어합니다.

*Cy*<br/>
OLE 컨트롤의 초기 높이를 픽셀 단위로 제어합니다.

### <a name="remarks"></a>설명

생성자에서 이 함수를 호출하여 컨트롤의 초기 크기를 설정합니다. 초기 크기는 장치 단위 또는 픽셀로 측정됩니다. 컨트롤의 생성자에서 이 호출을 하는 것이 좋습니다.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>콜레 컨트롤::세트수정 플래그

컨트롤의 수정된 상태를 변경합니다.

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>매개 변수

*bModified*<br/>
컨트롤의 수정된 플래그에 대한 새 값입니다. TRUE는 컨트롤의 상태가 수정되었음을 나타냅니다. FALSE는 컨트롤의 상태가 방금 저장되었음을 나타냅니다.

### <a name="remarks"></a>설명

컨트롤의 영구 상태에 영향을 주는 변경이 발생할 때마다 이 함수를 호출합니다. 예를 들어 영구 속성의 값이 변경되면 *bModified* **TRUE를**이 함수를 호출합니다.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>콜레 컨트롤::설정금지 허용

편집 요청이 실패했음을 나타냅니다.

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>설명

실패할 때 `BoundPropertyRequestEdit` 이 함수를 호출합니다. 이 함수는 집합 작업이 `COleDispScodeException` 허용되지 않음을 나타내는 형식의 예외를 throw합니다.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COle Control::SetNot지원

사용자가 컨트롤의 속성 값을 수정하지 못하도록 합니다.

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>설명

컨트롤의 사용자에 의해 속성 값의 수정이 지원되지 않는 속성의 Set 함수 대신이 함수를 호출합니다. 한 가지 예는 읽기 전용 속성입니다.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>콜레 컨트롤::SetRectInContainer

장치 단위로 표현된 컨테이너를 기준으로 컨트롤의 사각형 좌표를 설정합니다.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*Lprect*<br/>
컨테이너를 기준으로 컨트롤의 새 좌표를 포함하는 사각형에 대한 포인터입니다.

### <a name="return-value"></a>Return Value

호출이 성공한 경우 0이 아닙니다. 그렇지 않으면 0.

### <a name="remarks"></a>설명

컨트롤이 열려 있으면 크기가 조정됩니다. 그렇지 않으면 컨테이너의 `OnPosRectChanged` 함수가 호출됩니다.

## <a name="colecontrolsettext"></a><a name="settext"></a>콜레 컨트롤::SetText

컨트롤의 스톡 캡션 또는 텍스트 속성 값을 설정합니다.

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>매개 변수

*pszText*<br/>
문자 문자열에 대한 포인터입니다.

### <a name="remarks"></a>설명

주식 캡션 및 텍스트 속성은 모두 동일한 값으로 매핑됩니다. 즉, 두 속성 중 하나를 변경하면 두 속성이 자동으로 변경됩니다. 일반적으로 컨트롤은 스톡 캡션 또는 Text 속성을 지원해야 하지만 둘 다 지원되지는 않습니다.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COle 제어::throwError

컨트롤에서 오류가 발생했음을 나타냅니다.

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>매개 변수

*사우스 캐롤라이나*<br/>
보고할 상태 코드 값입니다. 가능한 코드의 전체 목록은 [ActiveX 컨트롤: 고급 항목](../../mfc/mfc-activex-controls-advanced-topics.md)문서를 참조하십시오.

*nDescriptionID*<br/>
보고할 예외의 문자열 리소스 ID입니다.

*nHelpID*<br/>
보고할 주제의 도움말 ID입니다.

*pszDescription*<br/>
보고할 예외에 대한 설명이 포함된 문자열입니다.

### <a name="remarks"></a>설명

이 함수는 OLE 속성에 대한 Get 또는 Set 함수 내에서또는 OLE 자동화 메서드의 구현에서만 호출되어야 합니다. 다른 시간에 발생하는 오류를 신호해야 하는 경우 stock 오류 이벤트를 발생시켜야 합니다.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>콜레 컨트롤 :: 변환 코르드

HIMETRIC 단위와 컨테이너의 기본 단위 사이의 좌표 값을 변환합니다.

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>매개 변수

*lpptlHimetric*<br/>
HIMETRIC `POINTL` 단위의 좌표를 포함하는 구조체에 대한 포인터입니다.

*lpptfContainer*<br/>
컨테이너의 `POINTF` 단위 크기에 좌표를 포함하는 구조에 대한 포인터입니다.

*플래그*<br/>
다음 값의 조합:

- XFORMCOORDS_POSITION 컨테이너의 위치입니다.

- XFORMCOORDS_SIZE 컨테이너의 크기입니다.

- XFORMCOORDS_HIMETRICTOCONTAINER HIMETRIC 단위를 컨테이너 단위로 변환합니다.

- XFORMCOORDS_CONTAINERTOHIMETRIC 컨테이너의 단위를 HIMETRIC 단위로 변환합니다.

### <a name="remarks"></a>설명

처음 두 플래그(XFORMCOORDS_POSITION 및 XFORMCOORDS_SIZE)는 좌표를 위치 또는 크기로 처리할지 여부를 나타냅니다. 나머지 두 플래그는 변환 방향을 나타냅니다.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>콜레 컨트롤::번역색상

색상 값을 OLE_COLOR 데이터 형식에서 [COLORREF](/windows/win32/gdi/colorref) 데이터 유형으로 변환합니다.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>매개 변수

*clrColor*<br/>
OLE_COLOR 데이터 형식입니다. 자세한 내용은 Windows [올레번역컬러](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) 기능을 참조하십시오.

*hpal*<br/>
선택적 팔레트에 대한 핸들; NULL이 될 수 있습니다.

### <a name="return-value"></a>Return Value

장치가 나타낼 수 있는 *clrColor* 값에 가장 가까운 단색을 정의하는 RGB(빨간색, 녹색, 파란색) 32비트 색상 값입니다.

### <a name="remarks"></a>설명

이 함수는 주식 ForeColor 및 BackColor 속성을 [CDC](../../mfc/reference/cdc-class.md) 멤버 함수에서 사용하는 COLORREF 유형으로 변환하는 데 유용합니다.

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COle Control::윌앰비언트유효로드 중

컨트롤이 이후 영구 상태에서 로드될 때 앰비언트 속성의 값을 기본값으로 사용해야 하는지 여부를 결정합니다.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Return Value

비영은 앰비언트 속성이 유효하다는 것을 나타냅니다. 그렇지 않으면 주변 속성이 유효하지 않습니다.

### <a name="remarks"></a>설명

일부 컨테이너에서 컨트롤은 `COleControl::DoPropExchange`의 재정의에 대한 초기 호출 중에 해당 주변 속성에 액세스하지 못할 수 있습니다. 컨테이너가 [IPersistStreamInit:::Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) 또는 [IPersistStorage::로드를](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) 호출하기 전에 [IOleObject::SetClientSite를](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) 호출하는 경우(즉, OLEMISC_SETCLIENTSITEFIRST 상태 비트를 준수하지 않는 경우)를 호출하는 경우입니다.

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>콜레 컨트롤 ::창 프로크

`COleControl` 개체에 대한 Windows 프로시저를 제공합니다.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>매개 변수

*message*<br/>
처리할 Windows 메시지를 지정합니다.

*wParam*<br/>
메시지 처리에 사용되는 추가 정보를 제공합니다. 매개 변수 값은 메시지에 따라 다릅니다.

*lParam*<br/>
메시지 처리에 사용되는 추가 정보를 제공합니다. 매개 변수 값은 메시지에 따라 다릅니다.

### <a name="return-value"></a>Return Value

전달된 메시지의 반환 값입니다.

### <a name="remarks"></a>설명

이 함수를 호출하여 컨트롤의 메시지 맵을 통해 특정 메시지를 디스패치합니다.

## <a name="see-also"></a>참조

[MFC 샘플 CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC 샘플 테스트도움말](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage 클래스](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd 클래스](../../mfc/reference/cwnd-class.md)<br/>
[계층 구조 차트](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder 클래스](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder 클래스](../../mfc/reference/cpictureholder-class.md)<br/>
