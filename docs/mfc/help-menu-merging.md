---
title: 도움말 메뉴 병합 | Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- menus [MFC], merging
- merging Help menus [MFC]
- Help [MFC], for active document containers
ms.assetid: 9d615999-79ba-471a-9288-718f0c903d49
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: ecdc450bbab725c6f81cf23e16fa32a2246b2b3a
ms.sourcegitcommit: 060f381fe0807107ec26c18b46d3fcb859d8d2e7
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/25/2018
ms.locfileid: "36931294"
---
# <a name="help-menu-merging"></a>도움말 메뉴 병합
개체가 컨테이너 내에서 활성화 되 면 메뉴 병합 OLE 문서의 프로토콜이 제공의 개체가 완전히 제어는 **도움말** 메뉴. 결과적으로, 컨테이너의 도움말 항목 사용할 수 없는 사용자 개체를 비활성화 하지 않는 한 합니다. 액티브 문서 포함 아키텍처는 컨테이너와 공유할 메뉴에 활성화 되는 활성 문서를 허용 하도록 병합 내부 메뉴에 대 한 규칙을 확장 합니다. 새 규칙은 구성 요소가 무엇 인지 메뉴의 어떤 부분을 소유 하 고 공유 메뉴 생성 방법에 대 한는 추가 규칙입니다.  
  
 새 규칙은 간단 합니다. 활성 문서에서는 **도움말** 메뉴에는 다음과 같이 구성 하는 두 개의 최상위 메뉴 항목:  
  
 `Help`  
  
 `Container Help >`  
  
 `Object Help    >`  
  
 단어 섹션 Office Binder에서 활성화 되어 예를 들어 하면 **도움말** 메뉴는 다음과 같이 표시 됩니다.  
  
 `Help`  
  
 `Binder Help >`  
  
 `Word Help   >`  
  
 두 메뉴 항목은 계단식 메뉴는 컨테이너 및 개체 관련 추가 메뉴 항목이 모든 사용자에 게 제공 됩니다. 컨테이너 및 개체에 따라 달라 집니다에 나타나는 메뉴 항목 여기 참여 합니다.  
  
 병합이 생성 **도움말** 메뉴, 액티브 문서 포함 아키텍처 일반적인 OLE 문서 프로시저를 수정 합니다. OLE 문서에 따라 병합된 된 메뉴 모음 6 개 그룹의 사용할 수 메뉴, 즉 **파일**, **편집**, **컨테이너**, **개체**,  **창**, **도움말**한다는 점에서 순서입니다. 각 그룹에서에 0 개 이상의 메뉴 있을 수 있습니다. 그룹 **파일**, **컨테이너**, 및 **창** 컨테이너와 그룹에 속한 **편집**, **개체,** 및 **도움말** 개체에 속해 있습니다. 개체를 메뉴 병합을 수행 하려는 경우 빈 메뉴 모음을 만들고 컨테이너에 전달 합니다. 컨테이너는 다음 따라 메뉴를 호출 하 여 삽입 `IOleInPlaceFrame::InsertMenus`합니다. 개체는 또한 긴 6 개 값의 배열 되는 구조를 전달 (**작업**). 컨테이너 메뉴를 삽입 한 후 해당 그룹, 한 다음 중 하나를 각에 추가한 메뉴의 수를 표시 합니다. 다음 개체의 메뉴, 각 컨테이너 그룹에서 메뉴의 개수가에 주의 삽입 합니다. 마지막으로, 개체를 반환 하는 불투명 한 "메뉴 설명자" 처리 OLE 병합된 된 메뉴 모음 및 배열 (을 각 그룹에 메뉴의 개수가 포함)을 전달 합니다. 나중에 개체가 전달 해당 핸들 및 병합된 된 메뉴 모음 컨테이너에 통해 `IOleInPlaceFrame::SetMenu`합니다. 이 때 컨테이너 병합 된 메뉴 모음을 표시 하 고 OLE 메뉴 메시지의 적절 한 디스패치 작업을 수행할 수 있도록 ole 핸들을 전달 합니다.  
  
 수정 된 현재 문서 프로시저에서 개체를 초기화 해야 합니다는 **작업** 요소를 사용 하는 컨테이너를 전달 하기 전에 0입니다. 다음 한 가지 예외로 일반적인 메뉴 삽입을 수행 하는 컨테이너: 컨테이너 삽입 한 **도움말** 마지막 항목으로 메뉴의 여섯 번째 마지막 항목에서 1의 값을 저장 하 고는 **작업** 배열 (즉, 너비 [5], 개체의 도움말 그룹에 속함). 이 **도움말** 메뉴는 하위 메뉴는 항목을 하나만 갖습니다는 "**컨테이너 도움말** >" 앞에서 설명한 대로 계단식 메뉴.  
  
 개체를 삽입 하기 전에 점을 제외 하 고 해당 일반적인 메뉴 삽입 코드를 다음 실행 해당 **도움말** 의 여섯 번째 항목 확인 메뉴는 **작업** 배열입니다. 값은 1이 고 마지막 메뉴의 이름이 경우 **도움말** (또는 적절 한 지역화 된 문자열) 개체를 삽입 한 다음 해당 **도움말** 컨테이너의 하위 메뉴로 메뉴 **도움말** 메뉴입니다.  
  
 개체는 다음의 여섯 번째 요소를 가져오거나 설정 **작업** 0으로 다섯 번째 요소를 하나 증가 시킴을 합니다. 이렇게 하면 OLE 것을 알고 있습니다.는 **도움말** 메뉴 컨테이너에 속하며 해당 메뉴 (및 그 하위)에 해당 하는 메뉴 메시지를 라우트해야 하는 컨테이너입니다. 전달 해야 하는 컨테이너의 다음 **WM_INITMENUPOPUP**, **WM_SELECT**, **WM_COMMAND**, 메시지 및 개체의에 속하는 다른 메뉴와 연결 된 메시지 일부는 **도움말** 메뉴. 사용 하 여 이렇게 **WM_INITMENU** 사용자가 탐색 하는 개체에 있는지 여부에 컨테이너를 알려 주는 플래그를 지우려면 **도움말** 메뉴. 컨테이너를 감시 **WM_MENUSELECT** 에 항목 또는 항목에는 **도움말** 메뉴 컨테이너 자체를 추가 하지 않았습니다. 입력 시 컨테이너 개체 도움말 메뉴""에 플래그를 설정 하 고 해당 플래그의 상태를 사용 하 여 하나를 전달 하는 개체 메뉴에 사용자가 탐색 의미 **WM_MENUSELECT**, **WM_INITMENUPOPUP**, 및  **WM_COMMAND** 개체 창에는 최소한의 메시지입니다. (종료 컨테이너 플래그를 지웁니다 및 자체 이러한 동일한 메시지를 처리 합니다.) 컨테이너 개체의에서 반환 된 창을 사용할지 `IOleInPlaceActiveObejct::GetWindow` 이러한 메시지에 대 한 대상으로 작동 합니다.  
  
 개체의 여섯 번째 요소에 0을 검색 하는 경우 **작업**, 일반 OLE 문서 규칙에 따라 진행 됩니다. 이 프로시저는 컨테이너에 참여 않는 **도움말** 메뉴 하지 않는 뿐 아니라 병합 합니다.  
  
 개체 호출 하는 경우 `IOleInPlaceFrame::SetMenu`병합 된 메뉴 모음에서 컨테이너 검사 여부 표시 전에 **도움말** 메뉴 컨테이너에 삽입 되는 것 외에 추가 하위 메뉴에 있습니다. 따라서 컨테이너 벗어나면 해당 **도움말** 병합 된 메뉴 모음에서 메뉴. 경우는 **도움말** 메뉴에 추가 하위 메뉴가 없는, 컨테이너를 제거 합니다 해당 **도움말** 병합된 된 메뉴 모음에서 메뉴. 이 프로시저는에 참여 하는 개체는 **도움말** 메뉴 하지 않는 뿐 아니라 병합 합니다.  
  
 마지막으로, 메뉴 디스어셈블할 때는 개체 제거는 삽입 된 **도움말** 다른 제거 될 뿐만 아니라 메뉴가 메뉴에 삽입 합니다. 제거 컨테이너 제거 하는 경우 해당 **도움말** 에 삽입 하는 기타 메뉴는 메뉴입니다.  
  
## <a name="see-also"></a>참고 항목  
 [액티브 문서 컨테이너](../mfc/active-document-containers.md)

