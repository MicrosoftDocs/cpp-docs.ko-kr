---
title: 도움말 메뉴 병합
ms.date: 11/04/2016
helpviewer_keywords:
- menus [MFC], merging
- merging Help menus [MFC]
- Help [MFC], for active document containers
ms.assetid: 9d615999-79ba-471a-9288-718f0c903d49
ms.openlocfilehash: 3db635cfdc39f9c4166bbf3d6958f52e535d91f1
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/31/2018
ms.locfileid: "50578531"
---
# <a name="help-menu-merging"></a>도움말 메뉴 병합

개체 컨테이너 내에서 활성화 되 면 메뉴 병합 OLE 문서의 프로토콜이 개체 전체 제어를 제공 하는 합니다 **도움말** 메뉴. 결과적으로, 사용자 개체를 비활성화 하지 않는 한 컨테이너의 도움말 항목이 제공 되지 않습니다. 액티브 문서 포함 아키텍처 원위치 메뉴 컨테이너와 메뉴 공유에 대해 활성화 되는 활성 문서를 허용 하도록 병합에 대 한 규칙을 확장 합니다. 새 규칙은 메뉴의 어떤 부분을 소유 하는 어떤 구성 요소 및 공유 메뉴 생성 방법에 대 한 단순히 추가 규칙입니다.

새 규칙은 간단 합니다. 활성 문서에는 **도움말** 메뉴에는 두 개의 최상위 메뉴 항목이 다음과 같이 구성:

`Help`

`Container Help >`

`Object Help    >`

Word 섹션 Office Binder 활성은 예를 들어, 해당 **도움말** 메뉴는 다음과 같이 표시 됩니다.

`Help`

`Binder Help >`

`Word Help   >`

두 메뉴 항목은 컨테이너 및 개체에 특정 한 추가 메뉴 항목을 모두 사용자에 게 제공 되는 계단식 메뉴입니다. 나타나는 메뉴 항목 다음에 따라 달라 집니다 컨테이너 및 개체와 관련 된 합니다.

병합이 데 **도움말** 메뉴, 액티브 문서 포함 아키텍처 일반적인 OLE 문서 프로시저를 수정 합니다. OLE 문서에 따라 병합된 된 메뉴 모음 그룹이 있을 수 6 메뉴, 즉 **파일**, **편집**, **컨테이너**하십시오 **개체**,  **창**, **도움말**를 주문 합니다. 각 그룹에서에 0 개 이상의 메뉴 있을 수 있습니다. 그룹 **파일**를 **컨테이너**, 및 **창을** 컨테이너와 그룹에 속한 **편집**, **개체를** 하 고 **도움말** 개체에 속해 있습니다. 개체를 메뉴 병합을 수행 하려는 경우 빈 메뉴 모음을 만들고 컨테이너에 전달 합니다. 컨테이너를 호출 하 여 해당 메뉴 삽입 `IOleInPlaceFrame::InsertMenus`합니다. 개체는 6 시간 값의 배열이 구조체를 전달도 (**작업**). 컨테이너 메뉴를 삽입 한 후 해당 그룹을 차례로 반환 중 각각에 추가한 메뉴의 개수를 표시 합니다. 그러면 개체 삽입 메뉴, 각 컨테이너 그룹에서 메뉴의 수에 주의 합니다. 마지막으로 개체는 OLE를 불투명 "메뉴 설명자"를 반환 하는 처리 병합된 된 메뉴 모음 및 배열 (포함 하는 각 그룹에 있는 메뉴의 수)를 전달 합니다. 나중에 개체는 핸들 및 전달 병합된 된 메뉴 모음 컨테이너를 통해 `IOleInPlaceFrame::SetMenu`합니다. 이때 컨테이너 병합 된 메뉴를 표시 하 고 OLE 메뉴 메시지의 적절 한 디스패치 작업을 수행할 수 있도록 OLE에 핸들을 전달 합니다.

먼저 초기화 해야 개체가 수정 된 현재 문서의 절차에서는 합니다 **작업** 요소를 컨테이너에 전달 하기 전에 0입니다. 컨테이너는 한 가지 예외를 사용 하 여 표준 메뉴 삽입을 수행: 컨테이너 삽입을 **도움말** 마지막 항목으로 메뉴의 마지막 여섯 번째 항목의 1의 값을 가져와 합니다 **작업** 배열 (즉, 너비 [5], 개체의 지원 그룹에 속함). 이 **도움말** 메뉴에는 하위 메뉴 인 항목을 하나만 갖습니다는 "**컨테이너 도움말** >" 앞에서 설명한 대로 계단식 메뉴.

삽입 하기 전에 제외 하 고 해당 표준 메뉴 삽입 코드를 다음 실행 하는 개체 해당 **도움말** 메뉴의 여섯 번째 항목을 검사 합니다 **작업** 배열 합니다. 값은 1 이며 경우 마지막 메뉴의 이름을 **도움말** (또는 적절 한 지역화 된 문자열) 개체를 삽입 한 다음 해당 **도움말** 컨테이너의 하위 메뉴로 메뉴 **도움말** 메뉴입니다.

개체의 여섯 번째 요소를 설정한 **작업** 0 다섯 번째 요소를 1 씩입니다. 그러면 사실을 OLE를 **도움말** 메뉴 컨테이너에 속하며 해당 하는 메뉴 (및 그 하위) 메뉴 메시지 컨테이너에 라우팅해야 합니다. 전달 해야 하는 컨테이너의 이면 **WM_INITMENUPOPUP**, **WM_SELECT**하십시오 **WM_COMMAND**, 및 개체에 속하는 다른 메뉴와 연결 된 메시지 부분을 **도움말** 메뉴. 사용 하 여 이렇게 **WM_INITMENU** 개체의 사용자가 탐색 하는 여부 컨테이너에 지시 하는 플래그를 지우려면 **도움말** 메뉴. 컨테이너를 감시 **WM_MENUSELECT** 진입 또는 종료의 모든 항목에 대 한 합니다 **도움말** 메뉴 컨테이너 자체를 추가 하지 않았습니다. 항목의 컨테이너 개체 도움말 메뉴에서 "플래그를 설정 하 고 해당 플래그의 상태를 사용 하 여 하나를 전달 하는 개체 메뉴에 사용자가 탐색 의미 **WM_MENUSELECT**를 **WM_INITMENUPOPUP**, 및  **WM_COMMAND** 개체 창에 최소한의 메시지입니다. 종료 시 컨테이너 플래그를 지웁니다과 자체 이러한 동일한 메시지를 처리 합니다. 컨테이너 개체에서 반환 된 창을 사용 하 여 해야 `IOleInPlaceActiveObejct::GetWindow` 이러한 메시지의 대상으로 작동 합니다.

개체의 여섯 번째 요소의 0 감지 **작업**, 일반 OLE 문서 규칙에 따라 진행 합니다. 이 프로시저는 참여 수행 하는 컨테이너 **도움말** 메뉴는 하지 않는 병합 합니다.

개체 호출 하는 경우 `IOleInPlaceFrame::SetMenu`병합된 된 메뉴 모음에서 컨테이너 확인 여부를 표시 하려면를 **도움말** 메뉴 컨테이너에 삽입 되는 것 외에도 추가 하위 메뉴에 있습니다. 따라서 컨테이너 떠나는 경우 해당 **도움말** 병합 된 메뉴 모음에서 메뉴. 경우는 **도움말** 메뉴에 추가 하위 메뉴가 없는, 컨테이너 제거는 해당 **도움말** 병합 된 메뉴 모음에서 메뉴. 이 프로시저는 참여 하는 개체 **도움말** 메뉴는 하지 않는 병합 합니다.

마지막으로, 메뉴를 디스어셈블 하는 데 시간이 되 면 개체 제거를 삽입 **도움말** 다른를 제거 하는 것 외에도 메뉴는 메뉴를 삽입 합니다. 컨테이너 메뉴를 제거 하면 제거 됩니다 해당 **도움말** 다른 메뉴에 삽입 하는 것 외에도 메뉴.

## <a name="see-also"></a>참고 항목

[액티브 문서 컨테이너](../mfc/active-document-containers.md)

