---
title: CRowset 클래스
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 6af7b30ef7055fbf5b3c998dba6f3b84d0129c31
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/31/2018
ms.locfileid: "50543068"
---
# <a name="crowset-class"></a>CRowset 클래스

OLE DB 행 집합 개체와 관련 된 여러 캡슐화 인터페이스 및 행 집합 데이터 조작 메서드를 제공 합니다.

## <a name="syntax"></a>구문

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>매개 변수

*TAccessor*<br/>
접근자 클래스입니다. 기본값은 `CAccessorBase`입니다.

## <a name="requirements"></a>요구 사항

**헤더:** atldbcli.h

## <a name="members"></a>멤버

### <a name="methods"></a>메서드

|||
|-|-|
|[AddRefRows](#addrefrows)|현재 행과 연결 된 참조 횟수를 증가.|
|[닫기](#close)|행 및 현재 릴리스 `IRowset` 인터페이스입니다.|
|[Compare](#compare)|사용 하 여 책갈피 비교 하 여 두 [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539)합니다.|
|[CRowset](#crowset)|새로 만듭니다 `CRowset` 개체를 사용 하 여 연결 (선택 사항)는 `IRowset` 인터페이스 매개 변수로 제공 합니다.|
|[삭제](#delete)|사용 하 여 행 집합에서 행을 삭제 [IRowsetChange:DeleteRows](/previous-versions/windows/desktop/ms724362(v%3dvs.85))합니다.|
|[FindNextRow](#findnextrow)|지정한 책갈피를 다음에 나오는 다음 일치 하는 행을 찾습니다.|
|[GetApproximatePosition](#getapproximateposition)|책갈피에 해당 하는 행의 대략적인 위치를 반환 합니다.|
|[GetData](#getdata)|행 집합의 행 복사본에서 데이터를 검색합니다.|
|[GetDataHere](#getdatahere)|지정된 된 버퍼에서 데이터를 검색합니다.|
|[GetOriginalData](#getoriginaldata)|가장 최근에 풀에서 반입 되거나 보류 중인 변경 내용을 무시 하 고, 데이터 원본에 전송 된 데이터를 검색 합니다.|
|[GetRowStatus](#getrowstatus)|모든 행의 상태를 반환 합니다.|
|[삽입](#insert)|만들고 사용 하 여 새 행 삽입 [IRowsetChange:InsertRow](/previous-versions/windows/desktop/ms716921)합니다.|
|[IsSameRow](#issamerow)|현재 행과 지정된 된 행을 비교합니다.|
|[MoveFirst](#movefirst)|다음 인출 위치를 처음 위치로 다시 설정합니다.|
|[MoveLast](#movelast)|마지막 레코드로 이동합니다.|
|[MoveNext](#movenext)|다음 순차 행 이나 지정된 된 수의 다음 행을 초과 하는 위치에서 데이터를 인출합니다.|
|[MovePrev](#moveprev)|이전 레코드로 이동 합니다.|
|[MoveToBookmark](#movetobookmark)|책갈피에서 책갈피로 표시 행 이나 지정된 된 오프셋에서 행을 인출 합니다.|
|[MoveToRatio](#movetoratio)|행 집합의 소수 자릿수 위치에서 시작 하는 행을 인출 합니다.|
|[ReleaseRows](#releaserows)|호출 [irowset:: Releaserows](/previous-versions/windows/desktop/ms719771) 현재 행 핸들을 릴리스해야 합니다.|
|[SetData](#setdata)|사용 하 여 행의 하나 이상의 열에 데이터 값을 설정 [IRowsetChange:SetData](/previous-versions/windows/desktop/ms721232)합니다.|
|[실행 취소](#undo)|마지막 fetch를 이후 행에 대 한 모든 변경 내용을 실행 취소 하거나 [업데이트](../../data/oledb/crowset-update.md)합니다.|
|[업데이트](#update)|보류 중인 마지막 페치 또는 업데이트 이후 현재 행에 대 한 변경 내용을 전송 합니다.|
|[UpdateAll](#updateall)|보류 중인 마지막 페치 또는 업데이트 이후 모든 행에 대 한 변경 내용을 전송 합니다.|

## <a name="remarks"></a>설명

OLE DB 행 집합 개체는 프로그램을 설정 하 고 데이터를 검색입니다.

이 클래스 수 인 스턴 화 되었지만 대신 템플릿 매개 변수로 전달 하기 위한 것 `CTable` 나 `CCommand` (`CRowset` 기본값).

## <a name="addrefrows"></a> Crowset:: Addrefrows

호출 [irowset:: Addrefrows](/previous-versions/windows/desktop/ms719619) 현재 행 핸들을 사용 하 여 연결 된 참조 횟수를 1) (씩 증가 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드는 현재 행 핸들에 대 한 참조 수를 늘립니다. 호출 [ReleaseRows](../../data/oledb/crowset-releaserows.md) 수 감소 합니다. 이동 방법을 사용 하 여 반환 되는 행의 참조 횟수를 경우

## <a name="close"></a> Crowset:: Close

행 및 현재 릴리스 [IRowset](/previous-versions/windows/desktop/ms720986) 인터페이스입니다.

### <a name="syntax"></a>구문

```cpp
void Close() throw();
```

### <a name="remarks"></a>설명

이 메서드는 현재 행 집합의에서 모든 행을 해제합니다.

## <a name="compare"></a> Crowset:: Compare

사용 하 여 책갈피 비교 하 여 두 [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539)합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1, 
   const CBookmarkBase& bookmark2, 
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>매개 변수

*Bookmark1*<br/>
[in] 비교할 첫 번째 책갈피입니다.

*Bookmark2*<br/>
[in] 비교할 두 번째 책갈피입니다.

*pComparison*<br/>
[out] 비교의 결과에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드에 필요한 선택적 인터페이스 `IRowsetLocate`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetLocate` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

소비자에 책갈피를 사용 하는 방법에 대 한 내용은 [책갈피를 사용 하 여](../../data/oledb/using-bookmarks.md)입니다.

## <a name="crowset"></a> Crowset:: Crowset

새로 만듭니다 `CRowset` 개체를 사용 하 여 연결 (선택 사항)는 [IRowset](/previous-versions/windows/desktop/ms720986) 인터페이스 매개 변수로 제공 합니다.

### <a name="syntax"></a>구문

```cpp
CRowset(); 

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>매개 변수

*pRowset*<br/>
[in] 이 클래스와 연결된 `IRowset` 인터페이스에 대한 포인터입니다.

## <a name="delete"></a> Crowset:: Delete

호출 [irowsetchange:: Deleterows](/previous-versions/windows/desktop/ms724362(v%3dvs.85)) 행 집합에서 현재 행을 삭제 하려고 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

## <a name="findnextrow"></a> Crowset:: Findnextrow

지정한 책갈피를 다음에 나오는 다음 일치 하는 행을 찾습니다.

### <a name="syntax"></a>구문

```cpp
HRESULT FindNextRow(DBCOMPAREOP op, 
   BYTE* pData, 
   DBTYPE wType, 
   DBLENGTH nLength, 
   BYTE bPrecision, 
   BYTE bScale, 
   BOOL bSkipCurrent = TRUE, 
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>매개 변수

*op*<br/>
[in] 행 값 비교에 사용할 작업입니다. 값을 참조 하세요 [irowsetfind:: Findnextrow](/previous-versions/windows/desktop/ms723091)합니다.

*pData*<br/>
[in] 일치 시킬 값에 대 한 포인터입니다.

*wType*<br/>
[in] 버퍼의 값 부분 형식을 데이터를 나타냅니다. 유형 표시기에 대 한 정보를 참조 하세요. [데이터 형식](/previous-versions/windows/desktop/ms723969) 에 *OLE DB Programmer's Reference* Windows SDK의 합니다.

*nLength*<br/>
[in] 데이터 값에 할당 된 소비자 데이터 구조의 길이 (바이트) 합니다. 세부 정보에 대 한 설명을 참조 하세요 `cbMaxLen` 에 [DBBINDING 구조체](/previous-versions/windows/desktop/ms716845) 에 *OLE DB 프로그래머 참조입니다.*

*bPrecision*<br/>
[in] 데이터를 가져올 때 사용 되는 최대 전체 자릿수입니다. 사용 되는 경우에만 *wType* DBTYPE_NUMERIC 됩니다. 자세한 내용은 참조 하세요. [DBTYPE_NUMERIC 또는 DBTYPE_DECIMAL를 포함 하는 변환은](/previous-versions/windows/desktop/ms719714) 에 *OLE DB Programmer's Reference*합니다.

*bScale*<br/>
[in] 데이터를 가져올 때 사용할 소수 자릿수입니다. 사용 되는 경우에만 *wType* DBTYPE_NUMERIC 인지 DBTYPE_DECIMAL 합니다. 자세한 내용은 참조 하세요. [DBTYPE_NUMERIC 또는 DBTYPE_DECIMAL를 포함 하는 변환은](/previous-versions/windows/desktop/ms719714) 에 *OLE DB Programmer's Reference*합니다.

*bSkipCurrent*<br/>
[in] 검색을 시작 하는 책갈피에서 행의 수입니다.

*pBookmark*<br/>
[in] 검색을 시작 하는 위치에 대 한 책갈피입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드에 필요한 선택적 인터페이스 `IRowsetFind`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetFind` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

소비자에 책갈피를 사용 하는 방법에 대 한 내용은 [책갈피를 사용 하 여](../../data/oledb/using-bookmarks.md)입니다.

## <a name="getapproximateposition"></a> Crowset:: Getapproximateposition

책갈피에 해당 하는 행의 대략적인 위치를 반환 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark, 
   DBCOUNTITEM* pPosition, 
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>매개 변수

*pBookmark*<br/>
[in] 위치가 있는 행을 식별 하는 책갈피에 대 한 포인터입니다. 행 개수는 필요한 경우 NULL입니다.

*pPosition*<br/>
[out] 위치에 대 한 포인터는 `GetApproximatePosition` 행의 위치를 반환 합니다. 위치 필요 하지 않은 경우 NULL입니다.

*pcRows*<br/>
[out] 위치에 대 한 포인터는 `GetApproximatePosition` 행의 총 수를 반환 합니다. 행 개수를 필요 하지 않은 경우 NULL입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드에 필요한 선택적 인터페이스 `IRowsetScroll`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetScroll` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

소비자에 책갈피를 사용 하는 방법에 대 한 내용은 [책갈피를 사용 하 여](../../data/oledb/using-bookmarks.md)입니다.

## <a name="getdata"></a> Crowset:: Getdata

행 집합의 행 복사본에서 데이터를 검색합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetData() throw(); 

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>매개 변수

*nAccessor*<br/>
[in] 사용 데이터에 액세스 하는 접근자 (0-오프셋) 인덱스 번호입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

자동 없는 접근자를 지정 하는 경우 [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md),이 메서드를 사용 하 여 명시적으로 접근자 수를 전달 하 여 데이터를 가져옵니다.

## <a name="getdatahere"></a> Crowset:: Getdatahere

현재 행에서 데이터를 검색 하 고 지정된 된 버퍼에 배치 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetDataHere(int nAccessor, 
   void* pBuffer) throw();
```

#### <a name="parameters"></a>매개 변수

*nAccessor*<br/>
[in] 데이터에 액세스 하는 데 접근자의 인덱스 번호입니다.

*pBuffer*<br/>
[out] 현재 레코드에 대 한 데이터를 배치 하는 버퍼입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 함수를 사용 하는 방법의 예제를 참조 합니다 [MultiRead 샘플](../../visual-cpp-samples.md)합니다.

## <a name="getoriginaldata"></a> Crowset:: Getoriginaldata

호출 `IRowsetUpdate::GetOriginalData` 최근에 풀에서 반입 되거나 데이터 원본에 전송 된 데이터를 검색 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드는 검색 데이터에서 가장 최근에 인출 또는; 데이터 원본에 전송 보류 중인 변경 내용에 따라 값을 검색 하지는 않습니다.

이 메서드에 필요한 선택적 인터페이스 `IRowsetUpdate`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetUpdate` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

## <a name="getrowstatus"></a> Crowset:: Getrowstatus

모든 행의 상태를 반환 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>매개 변수

*pStatus*<br/>
[out] 위치에 대 한 포인터는 `GetRowStatus` 상태 값을 반환 합니다. OLE DB Programmer's Reference의 DBPENDINGSTATUS를 참조 하세요.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드에 필요한 선택적 인터페이스 `IRowsetUpdate`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetUpdate` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

## <a name="insert"></a> Crowset:: Insert

만들고 접근자에서 데이터를 사용 하 여 새 행을 초기화 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Insert(int nAccessor = 0, 
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>매개 변수

*nAccessor*<br/>
[in] 데이터를 삽입 하는 데 접근자의 수입니다.

*bGetHRow*<br/>
[in] 삽입 된 행에 대 한 핸들을 검색 하는지 여부를 나타냅니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드에 필요한 선택적 인터페이스 `IRowsetChange`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetChange` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

하나 이상의 열에 쓸 수 없는 경우 삽입 실패할 수 있습니다. 이 문제를 해결하려면 커서 맵을 수정합니다.

### <a name="example"></a>예제

다음 예에서는 행 집합을 통해 데이터 원본에 액세스 한 다음 해당 행 집합의 테이블을 사용 하는 문자열을 삽입 하는 방법을 보여 줍니다.

먼저 프로젝트에 새 ATL 개체를 삽입 하 여 테이블 클래스를 만듭니다. 예를 들어, 작업 영역 창에서 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 선택 **ATL New-object**합니다. **데이터 액세스** 범주를 선택한 **소비자**합니다. 형식의 소비자 개체를 만듭니다 **테이블**합니다. (선택 **테이블** 테이블에서 직접 행 집합을 만듭니다; 선택 **명령** SQL 명령을 통해 행 집합을 만듭니다.) 해당 데이터 원본에 액세스 하는 테이블을 지정 하는 데이터 원본을 선택 합니다. 소비자 개체를 호출 하면 **CCustomerTable**, 삽입 코드를 다음과 같이 구현 합니다.

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a> Crowset:: Issamerow

현재 행과 지정된 된 행을 비교합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>매개 변수

*hRow*<br/>
[in] 현재 행에 비교할 행 핸들입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다. S_ok이 고, 행이 동일한 것을 나타냅니다. 다른 값을 참조 하세요 [IRowsetIndentity::IsSameRow](/previous-versions/windows/desktop/ms719629) 에 *OLE DB Programmer's Reference* Windows SDK의 합니다.

## <a name="movefirst"></a> Crowset:: Movefirst

초기 위치에 커서를 이동 하 고 초기 행을 검색 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

호출 [irowset:: Restartposition](/previous-versions/windows/desktop/ms712877) 위치는 초기 위치 (행 집합을 만든 다음 페치 위치에는 위치)를 다음 인출 위치를 변경 하 고 초기 행을 검색 합니다.

## <a name="movelast"></a> Crowset:: Movelast

커서가 마지막 행으로 이동합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

호출 [irowset:: Restartposition](/previous-versions/windows/desktop/ms712877) 다음 인출 위치를 마지막 위치에 배치 하 고 마지막 행을 검색 합니다.

이 메서드는 설정 해야 `DBPROP_CANSCROLLBACKWARDS` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다. (성능 향상을 위해 속성도 설정할 수 있습니다 `DBPROP_QUICKRESTART` 를 variant_true로 설정 합니다.)

## <a name="movenext"></a> Crowset:: Movenext

커서를 다음 레코드로 이동합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip, 
   bool bForward= true) throw();
```

#### <a name="parameters"></a>매개 변수

*lSkip*<br/>
[in] 페치 하기 전에 건너뛸 행 수입니다.

*bForward*<br/>
[in] 전달 **true** 를 다음 레코드로 앞으로 이동 하려면 **false** 뒤로 이동 합니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다. 행 집합의 끝에 도달 하는 경우에 DB_S_ENDOFROWSET 반환 합니다.

### <a name="remarks"></a>설명

다음 순차적인 행 인출는 `CRowset` 개체를 이전 위치를 기억 합니다. 선택적으로 건너 뛰 세요 하도록 선택할 수 있습니다 *lSkip* 행 또는 뒤로 이동 합니다.

이 메서드 호출 하기 전에 다음 속성을 설정 해야 `Open` 테이블이 나 행 집합을 포함 하는 명령:

- `DBPROP_CANSCROLLBACKWARDS` 경우 VARIANT_TRUE 여야 *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` 경우 VARIANT_TRUE 여야 *bForward* = false

그렇지 않은 경우 (하는 경우 *lSkip* > = 0 및 *bForward* = true), 추가 속성을 설정할 필요가 없습니다.

## <a name="moveprev"></a> Crowset:: Moveprev

커서가 이전 레코드로 이동합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드 중 하나를 설정 하는 필요한 `DBPROP_CANFETCHBACKWARDS` 또는 `DBPROP_CANSCROLLBACKWARDS` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

## <a name="movetobookmark"></a> Crowset:: Movetobookmark

책갈피 또는 지정 된 오프셋에 있는 행으로 표시 하는 행을 인출 (*lSkip*) 해당 책갈피에서.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark, 
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>매개 변수

*책갈피*<br/>
[in] 데이터를 인출 하려는 위치를 표시 하는 책갈피입니다.

*lSkip*<br/>
[in] 대상 행에 책갈피에서 행의 수입니다. 하는 경우 *lSkip* 가 0 이면 첫 번째 인출 된 행이 책갈피가 표시 된 행입니다. 하는 경우 *lSkip* 이 1 이면 첫 번째 인출 된 행이 행 책갈피가 표시 된 행 후 합니다. 하는 경우 *lSkip* 가-1 이면 첫 번째 인출 된 행이 책갈피가 표시 된 행 앞에 있는 행입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드에 필요한 선택적 인터페이스 `IRowsetLocate`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetLocate` 를 variant_true로 설정 하 고 `DBPROP_CANFETCHBACKWARDS` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

소비자에 책갈피를 사용 하는 방법에 대 한 내용은 [책갈피를 사용 하 여](../../data/oledb/using-bookmarks.md)입니다.

## <a name="movetoratio"></a> Crowset:: Movetoratio

행 집합의 소수 자릿수 위치에서 시작 하는 행을 인출 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator, 
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>매개 변수

*nNumerator*<br/>
[in] 소수 자릿수를 결정 하는 데 분자 데이터를 인출 하는 위치입니다.

*nDenominator*<br/>
[in] 소수 자릿수를 결정 하는 데 사용 되는 분모에서 데이터를 인출 하는 위치입니다.

*bForward*<br/>
[in] 앞 이나 뒤로 이동할 것인지를 나타냅니다. 기본값은 전달 합니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

`MoveToRatio` 다음 수식으로 약에 따라 행을 인출 합니다.

`(nNumerator *  RowsetSize ) / nDenominator`

여기서 `RowsetSize` 행 단위로 측정 되는 행 집합의 크기입니다. 이 수식의 정확도 특정 공급자에 따라 달라 집니다. 자세한 내용은 참조 하세요 [irowsetscroll::](/previous-versions/windows/desktop/ms709602)합니다.

이 메서드에 필요한 선택적 인터페이스 `IRowsetScroll`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetScroll` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

## <a name="releaserows"></a> Crowset:: Releaserows

호출 [irowset:: Releaserows](/previous-versions/windows/desktop/ms719771) 현재 행 핸들을 릴리스해야 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

## <a name="setdata"></a> Crowset:: Setdata

행의 하나 이상의 열에 데이터 값을 설정 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT SetData() const throw(); 

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>매개 변수

*nAccessor*<br/>
[in] 데이터에 액세스 하는 데 접근자의 수입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

에 대 한는 `SetData` 형식 인수 없이, 모든 접근자를 허용 하는 업데이트에 사용 됩니다. 일반적으로 호출 `SetData` 행의 열에 있는 데이터 값을 설정 하려면 호출 [업데이트](../../data/oledb/crowset-update.md) 해당 변경 내용을 전송할 수 있습니다.

이 메서드에 필요한 선택적 인터페이스 `IRowsetChange`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetChange` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

설정 작업을 하나 이상의 열에 쓸 수 없는 경우에 실패할 수 있습니다. 이 문제를 해결하려면 커서 맵을 수정합니다.

## <a name="undo"></a> Crowset:: Undo

마지막 fetch를 이후 행에 대 한 모든 변경 내용을 실행 취소 하거나 [업데이트](../../data/oledb/crowset-update.md)합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL, 
   HROW* phRow = NULL, 
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>매개 변수

*pcRows*<br/>
[out] 위치에 대 한 포인터는 `Undo` 필요한 경우 실행 취소 하려고 시도 했습니다. 행의 수를 반환 합니다.

*phRow*<br/>
[out] 위치에 대 한 포인터는 `Undo` 필요한 경우 실행 취소 하려고 시도 했습니다. 모든 행 핸들의 배열을 반환 합니다.

*pStatus*<br/>
[out] 위치에 대 한 포인터는 `Undo` 행 상태 값을 반환 합니다. 상태가 반환 됩니다 *pStatus* null입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

이 메서드에 필요한 선택적 인터페이스 `IRowsetUpdate`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetUpdate` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

## <a name="update"></a> Crowset:: Update

보류 중인 변경 내용이 마지막 fetch를 이후 현재 행에 대 한 전송 또는 `Update` 를 호출 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL, 
   HROW* phRow = NULL, 
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>매개 변수

*pcRows*<br/>
[out] 위치에 대 한 포인터는 `Update` 필요한 경우 업데이트를 시도 하는 행 수를 반환 합니다.

*phRow*<br/>
[out] 위치에 대 한 포인터는 `Update` 업데이트 하려고 할 행의 핸들을 반환 합니다. 핸들이 없는 경우 반환 됩니다 *phRow* null입니다.

*pStatus*<br/>
[out] 위치에 대 한 포인터는 `Update` 행 상태 값을 반환 합니다. 상태가 반환 됩니다 *pStatus* null입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>설명

보류 중인 변경 내용이 행 마지막 인출 되거나 업데이트 이후 현재 행에 대해 전송 (사용 하 여 `Update` 나 [UpdateAll](../../data/oledb/crowset-updateall.md)). 일반적으로 호출 [SetData](../../data/oledb/crowset-setdata.md) 행의 열에 있는 데이터 값을 설정 하 여 호출 `Update` 해당 변경 내용을 전송할 수 있습니다.

이 메서드에 필요한 선택적 인터페이스 `IRowsetUpdate`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetUpdate` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

## <a name="updateall"></a> Crowset:: Updateall

보류 중인 변경 내용이 마지막 fetch를 이후 모든 행에 대 한 전송 또는 `Update` 를 호출 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL, 
   HROW** pphRow = NULL, 
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>매개 변수

*pcRows*<br/>
[out] 위치에 대 한 포인터는 `UpdateAll` 필요한 경우 업데이트를 시도 하는 행 수를 반환 합니다.

*pphRow*<br/>
[out] 메모리에 대 한 포인터 `UpdateAll` 업데이트 하려고 할 행의 핸들을 반환 합니다. 핸들이 없는 경우 반환 됩니다 *pphRow* null입니다.

*ppStatus*<br/>
[out] 위치에 대 한 포인터는 `Update` 행 상태 값을 반환 합니다. 상태가 반환 됩니다 *ppStatus* null입니다.

### <a name="remarks"></a>설명

보류 중인 변경 내용이 행 인출 된 마지막 또는 사용 하 여 업데이트 하므로 모든 행에 대해 전송 [업데이트](../../data/oledb/crowset-update.md) 또는 `UpdateAll`합니다. `UpdateAll` 수정 된, 여전히 있는지 핸들에 관계 없이 모든 행을 업데이트 합니다 (참조 *pphRow*) 여부.

예를 들어, 사용 하는 경우 `Insert` 행 집합에 5 개의 행을 삽입할 할 수 있습니다. 호출 `Update` 5 시간 또는 통화 `UpdateAll` 모든 업데이트를 한 번입니다.

이 메서드에 필요한 선택적 인터페이스 `IRowsetUpdate`는 지원 되지 않는 모든 공급자입니다;이 경우, 메서드가 E_NOINTERFACE가 반환 됩니다. 설정 해야 `DBPROP_IRowsetUpdate` 를 호출 하기 전에 variant_true로 `Open` 테이블이 나 행 집합을 포함 하는 명령입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

## <a name="see-also"></a>참고 항목

[DBViewer 샘플](../../visual-cpp-samples.md)<br/>
[MultiRead 샘플](../../visual-cpp-samples.md)<br/>
[MultiRead 특성 샘플](../../visual-cpp-samples.md)<br/>
[OLE DB 소비자 템플릿](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[OLE DB 소비자 템플릿 참조](../../data/oledb/ole-db-consumer-templates-reference.md)